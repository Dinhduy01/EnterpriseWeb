/*! For license information please see main.c467c69a.js.LICENSE.txt */
(()=>{var e={43:(e,t,n)=>{"use strict";e.exports=n(202)},153:(e,t,n)=>{"use strict";var i=n(43),r=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var i,o={},l=null,u=null;for(i in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,i)&&!c.hasOwnProperty(i)&&(o[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===o[i]&&(o[i]=t[i]);return{$$typeof:r,type:e,key:l,ref:u,props:o,_owner:s.current}}t.jsx=l,t.jsxs=l},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var k=b.prototype=new y;k.constructor=b,m(k,v.prototype),k.isPureReactComponent=!0;var S=Array.isArray,w=Object.prototype.hasOwnProperty,C={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,i){var r,o={},a=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)w.call(t,r)&&!T.hasOwnProperty(r)&&(o[r]=t[r]);var c=arguments.length-2;if(1===c)o.children=i;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===o[r]&&(o[r]=c[r]);return{$$typeof:n,type:e,key:a,ref:s,props:o,_owner:C.current}}function P(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var x=/\/+/g;function R(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,r,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case i:c=!0}}if(c)return a=a(c=e),e=""===o?"."+R(c,0):o,S(a)?(r="",null!=e&&(r=e.replace(x,"$&/")+"/"),N(a,t,r,"",(function(e){return e}))):null!=a&&(P(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,r+(!a.key||c&&c.key===a.key?"":(""+a.key).replace(x,"$&/")+"/")+e)),t.push(a)),1;if(c=0,o=""===o?".":o+":",S(e))for(var l=0;l<e.length;l++){var u=o+R(s=e[l],l);c+=N(s,t,r,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(s=e.next()).done;)c+=N(s=s.value,t,r,u=o+R(s,l++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function O(e,t,n){if(null==e)return e;var i=[],r=0;return N(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function _(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},D={transition:null},M={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:D,ReactCurrentOwner:C};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:O,forEach:function(e,t,n){O(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!P(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=a,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.act=L,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=m({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=C.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)w.call(t,l)&&!T.hasOwnProperty(l)&&(r[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)r.children=i;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}return{$$typeof:n,type:e.type,key:o,ref:a,props:r,_owner:s}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=P,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:_}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<o(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,a=r>>>1;i<a;){var s=2*(i+1)-1,c=e[s],l=s+1,u=e[l];if(0>o(c,n))l<r&&0>o(u,c)?(e[i]=u,e[l]=n,i=l):(e[i]=c,e[s]=n,i=s);else{if(!(l<r&&0>o(u,n)))break e;e[i]=u,e[l]=n,i=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}var l=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function k(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(l,t)}t=i(u)}}function S(e){if(g=!1,k(e),!m)if(null!==i(l))m=!0,D(w);else{var t=i(u);null!==t&&M(S,t.startTime-e)}}function w(e,n){m=!1,g&&(g=!1,y(P),P=-1),f=!0;var o=p;try{for(k(n),h=i(l);null!==h&&(!(h.expirationTime>n)||e&&!N());){var a=h.callback;if("function"===typeof a){h.callback=null,p=h.priorityLevel;var s=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===i(l)&&r(l),k(n)}else r(l);h=i(l)}if(null!==h)var c=!0;else{var d=i(u);null!==d&&M(S,d.startTime-n),c=!1}return c}finally{h=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,T=!1,E=null,P=-1,x=5,R=-1;function N(){return!(t.unstable_now()-R<x)}function O(){if(null!==E){var e=t.unstable_now();R=e;var n=!0;try{n=E(!0,e)}finally{n?C():(T=!1,E=null)}}else T=!1}if("function"===typeof b)C=function(){b(O)};else if("undefined"!==typeof MessageChannel){var _=new MessageChannel,I=_.port2;_.port1.onmessage=O,C=function(){I.postMessage(null)}}else C=function(){v(O,0)};function D(e){E=e,T||(T=!0,C())}function M(e,n){P=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,D(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(l)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(u,e),null===i(l)&&e===i(u)&&(g?(y(P),P=-1):g=!0,M(S,o-a))):(e.sortIndex=s,n(l,e),m||f||(m=!0,D(w))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},318:function(e,t,n){var i,r;!function(){"use strict";i=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function r(e,t){var n=e[t];if("function"===typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(i){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?o:void 0!==console[i]?r(console,i):void 0!==console.log?r(console,"log"):e)}function s(t,n){for(var r=0;r<i.length;r++){var o=i[r];this[o]=r<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function c(e,n,i){return function(){typeof console!==t&&(s.call(this,n,i),this[e].apply(this,arguments))}}function l(e,t,n){return a(e)||c.apply(this,arguments)}function u(e,n,r){var o,a=this;n=null==n?"WARN":n;var c="loglevel";function u(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=n)}catch(r){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(r){}}}function d(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(r){}if(typeof e===t)try{var n=window.document.cookie,i=n.indexOf(encodeURIComponent(c)+"=");-1!==i&&(e=/^([^;]+)/.exec(n.slice(i))[1])}catch(r){}return void 0===a.levels[e]&&(e=void 0),e}}function h(){if(typeof window!==t&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}"string"===typeof e?c+=":"+e:"symbol"===typeof e&&(c=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=r||l,a.getLevel=function(){return o},a.setLevel=function(n,i){if("string"===typeof n&&void 0!==a.levels[n.toUpperCase()]&&(n=a.levels[n.toUpperCase()]),!("number"===typeof n&&n>=0&&n<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==i&&u(n),s.call(a,n,e),typeof console===t&&n<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){n=e,d()||a.setLevel(e,!1)},a.resetLevel=function(){a.setLevel(n,!1),h()},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var p=d();null==p&&(p=n),a.setLevel(p,!1)}var d=new u,h={};d.getLogger=function(e){if("symbol"!==typeof e&&"string"!==typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=h[e];return t||(t=h[e]=new u(e,d.getLevel(),d.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return d.noConflict=function(){return typeof window!==t&&window.log===d&&(window.log=p),d},d.getLoggers=function(){return h},d.default=d,d},void 0===(r="function"===typeof i?i.call(t,n,t,e):i)||(e.exports=r)}()},373:()=>{window.process={env:{NODE_ENV:"production"}}},391:(e,t,n)=>{"use strict";var i=n(950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},579:(e,t,n)=>{"use strict";e.exports=n(153)},730:(e,t,n)=>{"use strict";var i=n(43),r=n(853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,i,r,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,i){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var k=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),w=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),x=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var A,U=Object.assign;function F(e){if(void 0===A)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);A=t&&t[1]||""}return"\n"+A+e}var j=!1;function B(e,t){if(!e||j)return"";j=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var i=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){i=l}e.call(t.prototype)}else{try{throw Error()}catch(l){i=l}e()}}catch(l){if(l&&i&&"string"===typeof l.stack){for(var r=l.stack.split("\n"),o=i.stack.split("\n"),a=r.length-1,s=o.length-1;1<=a&&0<=s&&r[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(r[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||r[a]!==o[s]){var c="\n"+r[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=a&&0<=s);break}}}finally{j=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function V(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case C:return"Fragment";case w:return"Portal";case E:return"Profiler";case T:return"StrictMode";case N:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case x:return(e.displayName||"Context")+".Consumer";case P:return(e._context.displayName||"Context")+".Provider";case R:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case _:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return z(e(t))}catch(n){}}return null}function J(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=W(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=q(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function oe(e,t){var n=q(t.value),i=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=me(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ke=null;function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ce=null,Te=null;function Ee(e){if(e=br(e)){if("function"!==typeof we)throw Error(o(280));var t=e.stateNode;t&&(t=Sr(t),we(e.stateNode,e.type,t))}}function Pe(e){Ce?Te?Te.push(e):Te=[e]:Ce=e}function xe(){if(Ce){var e=Ce,t=Te;if(Te=Ce=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Re(e,t){return e(t)}function Ne(){}var Oe=!1;function _e(e,t,n){if(Oe)return e(t,n);Oe=!0;try{return Re(e,t,n)}finally{Oe=!1,(null!==Ce||null!==Te)&&(Ne(),xe())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var i=Sr(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var De=!1;if(u)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){De=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(ue){De=!1}function Le(e,t,n,i,r,o,a,s,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var Ae=!1,Ue=null,Fe=!1,je=null,Be={onError:function(e){Ae=!0,Ue=e}};function Ve(e,t,n,i,r,o,a,s,c){Ae=!1,Ue=null,Le.apply(Be,arguments)}function ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(ze(e)!==e)throw Error(o(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(i=r.return)){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return qe(r),e;if(a===i)return qe(r),t;a=a.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=a;else{for(var s=!1,c=r.child;c;){if(c===n){s=!0,n=r,i=a;break}if(c===i){s=!0,i=r,n=a;break}c=c.sibling}if(!s){for(c=a.child;c;){if(c===n){s=!0,n=a,i=r;break}if(c===i){s=!0,i=a,n=r;break}c=c.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ke=r.unstable_scheduleCallback,Ge=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,$e=r.unstable_requestPaint,Ye=r.unstable_now,Xe=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,ot=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ct|0)|0},st=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,o=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~r;0!==s?i=dt(s):0!==(o&=a)&&(i=dt(o))}else 0!==(a=n&~r)?i=dt(a):0!==o&&(i=dt(o));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(o=t&-t)||16===r&&0!==(4194240&o)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-at(t)),i|=e[n],t&=~r;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-at(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var bt=0;function kt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var St,wt,Ct,Tt,Et,Pt=!1,xt=[],Rt=null,Nt=null,Ot=null,_t=new Map,It=new Map,Dt=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Rt=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":_t.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function At(e,t,n,i,r,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},null!==t&&(null!==(t=br(t))&&wt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ut(e){var t=yr(e.target);if(null!==t){var n=ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Je(n)))return e.blockedOn=t,void Et(e.priority,(function(){Ct(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=br(n))&&wt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);ke=i,n.target.dispatchEvent(i),ke=null,t.shift()}return!0}function jt(e,t,n){Ft(e)&&n.delete(t)}function Bt(){Pt=!1,null!==Rt&&Ft(Rt)&&(Rt=null),null!==Nt&&Ft(Nt)&&(Nt=null),null!==Ot&&Ft(Ot)&&(Ot=null),_t.forEach(jt),It.forEach(jt)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Pt||(Pt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Bt)))}function zt(e){function t(t){return Vt(t,e)}if(0<xt.length){Vt(xt[0],e);for(var n=1;n<xt.length;n++){var i=xt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Rt&&Vt(Rt,e),null!==Nt&&Vt(Nt,e),null!==Ot&&Vt(Ot,e),_t.forEach(t),It.forEach(t),n=0;n<Dt.length;n++)(i=Dt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ut(n),null===n.blockedOn&&Dt.shift()}var Jt=k.ReactCurrentBatchConfig,qt=!0;function Wt(e,t,n,i){var r=bt,o=Jt.transition;Jt.transition=null;try{bt=1,Kt(e,t,n,i)}finally{bt=r,Jt.transition=o}}function Ht(e,t,n,i){var r=bt,o=Jt.transition;Jt.transition=null;try{bt=4,Kt(e,t,n,i)}finally{bt=r,Jt.transition=o}}function Kt(e,t,n,i){if(qt){var r=Qt(e,t,n,i);if(null===r)qi(e,t,i,Gt,n),Lt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Rt=At(Rt,e,t,n,i,r),!0;case"dragenter":return Nt=At(Nt,e,t,n,i,r),!0;case"mouseover":return Ot=At(Ot,e,t,n,i,r),!0;case"pointerover":var o=r.pointerId;return _t.set(o,At(_t.get(o)||null,e,t,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,It.set(o,At(It.get(o)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Lt(e,i),4&t&&-1<Mt.indexOf(e)){for(;null!==r;){var o=br(r);if(null!==o&&St(o),null===(o=Qt(e,t,n,i))&&qi(e,t,i,Gt,n),o===r)break;r=o}null!==r&&i.stopPropagation()}else qi(e,t,i,null,n)}}var Gt=null;function Qt(e,t,n,i){if(Gt=null,null!==(e=yr(e=Se(i))))if(null===(t=ze(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Je(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,i=n.length,r="value"in Yt?Yt.value:Yt.textContent,o=r.length;for(e=0;e<i&&n[e]===r[e];e++);var a=i-e;for(t=1;t<=a&&n[i-t]===r[o-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,i,r,o){for(var a in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,cn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(ln),dn=U({},ln,{view:0,detail:0}),hn=on(dn),pn=U({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(an=e.screenX-cn.screenX,sn=e.screenY-cn.screenY):sn=an=0,cn=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),fn=on(pn),mn=on(U({},pn,{dataTransfer:0})),gn=on(U({},dn,{relatedTarget:0})),vn=on(U({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=U({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(yn),kn=on(U({},ln,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cn[e])&&!!t[e]}function En(){return Tn}var Pn=U({},dn,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),xn=on(Pn),Rn=on(U({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=on(U({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),On=on(U({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),_n=U({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),In=on(_n),Dn=[9,13,27,32],Mn=u&&"CompositionEvent"in window,Ln=null;u&&"documentMode"in document&&(Ln=document.documentMode);var An=u&&"TextEvent"in window&&!Ln,Un=u&&(!Mn||Ln&&8<Ln&&11>=Ln),Fn=String.fromCharCode(32),jn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1;var Jn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Jn[e.type]:"textarea"===t}function Wn(e,t,n,i){Pe(i),0<(t=Hi(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Hn=null,Kn=null;function Gn(e){Fi(e,0)}function Qn(e){if(K(kr(e)))return e}function $n(e,t){if("change"===e)return t}var Yn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Zn="function"===typeof ei.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function ti(){Hn&&(Hn.detachEvent("onpropertychange",ni),Kn=Hn=null)}function ni(e){if("value"===e.propertyName&&Qn(Kn)){var t=[];Wn(t,Kn,e,Se(e)),_e(Gn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Kn=n,(Hn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Kn)}function oi(e,t){if("click"===e)return Qn(t)}function ai(e,t){if("input"===e||"change"===e)return Qn(t)}var si="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ci(e,t){if(si(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!d.call(t,r)||!si(e[r],t[r]))return!1}return!0}function li(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=li(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=li(i)}}function di(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?di(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hi(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fi(e){var t=hi(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&di(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,o=Math.min(i.start,r);i=void 0===i.end?o:Math.min(i.end,r),!e.extend&&o>i&&(r=i,i=o,o=r),r=ui(n,o);var a=ui(n,i);r&&a&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),o>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,gi=null,vi=null,yi=null,bi=!1;function ki(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bi||null==gi||gi!==G(i)||("selectionStart"in(i=gi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&ci(yi,i)||(yi=i,0<(i=Hi(vi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=gi)))}function Si(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wi={animationend:Si("Animation","AnimationEnd"),animationiteration:Si("Animation","AnimationIteration"),animationstart:Si("Animation","AnimationStart"),transitionend:Si("Transition","TransitionEnd")},Ci={},Ti={};function Ei(e){if(Ci[e])return Ci[e];if(!wi[e])return e;var t,n=wi[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ti)return Ci[e]=n[t];return e}u&&(Ti=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);var Pi=Ei("animationend"),xi=Ei("animationiteration"),Ri=Ei("animationstart"),Ni=Ei("transitionend"),Oi=new Map,_i="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ii(e,t){Oi.set(e,t),c(t,[e])}for(var Di=0;Di<_i.length;Di++){var Mi=_i[Di];Ii(Mi.toLowerCase(),"on"+(Mi[0].toUpperCase()+Mi.slice(1)))}Ii(Pi,"onAnimationEnd"),Ii(xi,"onAnimationIteration"),Ii(Ri,"onAnimationStart"),Ii("dblclick","onDoubleClick"),Ii("focusin","onFocus"),Ii("focusout","onBlur"),Ii(Ni,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Li="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ai=new Set("cancel close invalid load scroll toggle".split(" ").concat(Li));function Ui(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,a,s,c,l){if(Ve.apply(this,arguments),Ae){if(!Ae)throw Error(o(198));var u=Ue;Ae=!1,Ue=null,Fe||(Fe=!0,je=u)}}(i,t,void 0,e),e.currentTarget=null}function Fi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var o=void 0;if(t)for(var a=i.length-1;0<=a;a--){var s=i[a],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==o&&r.isPropagationStopped())break e;Ui(r,s,l),o=c}else for(a=0;a<i.length;a++){if(c=(s=i[a]).instance,l=s.currentTarget,s=s.listener,c!==o&&r.isPropagationStopped())break e;Ui(r,s,l),o=c}}}if(Fe)throw e=je,Fe=!1,je=null,e}function ji(e,t){var n=t[mr];void 0===n&&(n=t[mr]=new Set);var i=e+"__bubble";n.has(i)||(Ji(t,e,2,!1),n.add(i))}function Bi(e,t,n){var i=0;t&&(i|=4),Ji(n,e,i,t)}var Vi="_reactListening"+Math.random().toString(36).slice(2);function zi(e){if(!e[Vi]){e[Vi]=!0,a.forEach((function(t){"selectionchange"!==t&&(Ai.has(t)||Bi(t,!1,e),Bi(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vi]||(t[Vi]=!0,Bi("selectionchange",!1,t))}}function Ji(e,t,n,i){switch($t(t)){case 1:var r=Wt;break;case 4:r=Ht;break;default:r=Kt}n=r.bind(null,t,n,e),r=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function qi(e,t,n,i,r){var o=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var s=i.stateNode.containerInfo;if(s===r||8===s.nodeType&&s.parentNode===r)break;if(4===a)for(a=i.return;null!==a;){var c=a.tag;if((3===c||4===c)&&((c=a.stateNode.containerInfo)===r||8===c.nodeType&&c.parentNode===r))return;a=a.return}for(;null!==s;){if(null===(a=yr(s)))return;if(5===(c=a.tag)||6===c){i=o=a;continue e}s=s.parentNode}}i=i.return}_e((function(){var i=o,r=Se(n),a=[];e:{var s=Oi.get(e);if(void 0!==s){var c=un,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":c=xn;break;case"focusin":l="focus",c=gn;break;case"focusout":l="blur",c=gn;break;case"beforeblur":case"afterblur":c=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Nn;break;case Pi:case xi:case Ri:c=vn;break;case Ni:c=On;break;case"scroll":c=hn;break;case"wheel":c=In;break;case"copy":case"cut":case"paste":c=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Rn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==s?s+"Capture":null:s;u=[];for(var p,f=i;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Ie(f,h))&&u.push(Wi(f,m,p)))),d)break;f=f.return}0<u.length&&(s=new c(s,l,null,n,r),a.push({event:s,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===ke||!(l=n.relatedTarget||n.fromElement)||!yr(l)&&!l[fr])&&(c||s)&&(s=r.window===r?r:(s=r.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=i,null!==(l=(l=n.relatedTarget||n.toElement)?yr(l):null)&&(l!==(d=ze(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=i),c!==l)){if(u=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Rn,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==c?s:kr(c),p=null==l?s:kr(l),(s=new u(m,f+"leave",c,n,r)).target=d,s.relatedTarget=p,m=null,yr(r)===i&&((u=new u(h,f+"enter",l,n,r)).target=p,u.relatedTarget=d,m=u),d=m,c&&l)e:{for(h=l,f=0,p=u=c;p;p=Ki(p))f++;for(p=0,m=h;m;m=Ki(m))p++;for(;0<f-p;)u=Ki(u),f--;for(;0<p-f;)h=Ki(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Ki(u),h=Ki(h)}u=null}else u=null;null!==c&&Gi(a,s,c,u,!1),null!==l&&null!==d&&Gi(a,d,l,u,!0)}if("select"===(c=(s=i?kr(i):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var g=$n;else if(qn(s))if(Yn)g=ai;else{g=ri;var v=ii}else(c=s.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=oi);switch(g&&(g=g(e,i))?Wn(a,g,n,r):(v&&v(e,s,i),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=i?kr(i):window,e){case"focusin":(qn(v)||"true"===v.contentEditable)&&(gi=v,vi=i,yi=null);break;case"focusout":yi=vi=gi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,ki(a,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":ki(a,n,r)}var y;if(Mn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else zn?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Un&&"ko"!==n.locale&&(zn||"onCompositionStart"!==b?"onCompositionEnd"===b&&zn&&(y=en()):(Xt="value"in(Yt=r)?Yt.value:Yt.textContent,zn=!0)),0<(v=Hi(i,b)).length&&(b=new kn(b,e,null,n,r),a.push({event:b,listeners:v}),y?b.data=y:null!==(y=Vn(n))&&(b.data=y))),(y=An?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(jn=!0,Fn);case"textInput":return(e=t.data)===Fn&&jn?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!Mn&&Bn(e,t)?(e=en(),Zt=Xt=Yt=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Hi(i,"onBeforeInput")).length&&(r=new kn("onBeforeInput","beforeinput",null,n,r),a.push({event:r,listeners:i}),r.data=y))}Fi(a,t)}))}function Wi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=Ie(e,n))&&i.unshift(Wi(e,o,r)),null!=(o=Ie(e,t))&&i.push(Wi(e,o,r))),e=e.return}return i}function Ki(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gi(e,t,n,i,r){for(var o=t._reactName,a=[];null!==n&&n!==i;){var s=n,c=s.alternate,l=s.stateNode;if(null!==c&&c===i)break;5===s.tag&&null!==l&&(s=l,r?null!=(c=Ie(n,o))&&a.unshift(Wi(n,c,s)):r||null!=(c=Ie(n,o))&&a.push(Wi(n,c,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Qi=/\r\n?/g,$i=/\u0000|\uFFFD/g;function Yi(e){return("string"===typeof e?e:""+e).replace(Qi,"\n").replace($i,"")}function Xi(e,t,n){if(t=Yi(t),Yi(e)!==t&&n)throw Error(o(425))}function Zi(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,or="function"===typeof Promise?Promise:void 0,ar="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof or?function(e){return or.resolve(null).then(e).catch(sr)}:ir;function sr(e){setTimeout((function(){throw e}))}function cr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void zt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);zt(t)}function lr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var dr=Math.random().toString(36).slice(2),hr="__reactFiber$"+dr,pr="__reactProps$"+dr,fr="__reactContainer$"+dr,mr="__reactEvents$"+dr,gr="__reactListeners$"+dr,vr="__reactHandles$"+dr;function yr(e){var t=e[hr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fr]||n[hr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[hr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function br(e){return!(e=e[hr]||e[fr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function kr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function Sr(e){return e[pr]||null}var wr=[],Cr=-1;function Tr(e){return{current:e}}function Er(e){0>Cr||(e.current=wr[Cr],wr[Cr]=null,Cr--)}function Pr(e,t){Cr++,wr[Cr]=e.current,e.current=t}var xr={},Rr=Tr(xr),Nr=Tr(!1),Or=xr;function _r(e,t){var n=e.type.contextTypes;if(!n)return xr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ir(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Dr(){Er(Nr),Er(Rr)}function Mr(e,t,n){if(Rr.current!==xr)throw Error(o(168));Pr(Rr,t),Pr(Nr,n)}function Lr(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(o(108,J(e)||"Unknown",r));return U({},n,i)}function Ar(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xr,Or=Rr.current,Pr(Rr,e),Pr(Nr,Nr.current),!0}function Ur(e,t,n){var i=e.stateNode;if(!i)throw Error(o(169));n?(e=Lr(e,t,Or),i.__reactInternalMemoizedMergedChildContext=e,Er(Nr),Er(Rr),Pr(Rr,e)):Er(Nr),Pr(Nr,n)}var Fr=null,jr=!1,Br=!1;function Vr(e){null===Fr?Fr=[e]:Fr.push(e)}function zr(){if(!Br&&null!==Fr){Br=!0;var e=0,t=bt;try{var n=Fr;for(bt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Fr=null,jr=!1}catch(r){throw null!==Fr&&(Fr=Fr.slice(e+1)),Ke(Ze,zr),r}finally{bt=t,Br=!1}}return null}var Jr=[],qr=0,Wr=null,Hr=0,Kr=[],Gr=0,Qr=null,$r=1,Yr="";function Xr(e,t){Jr[qr++]=Hr,Jr[qr++]=Wr,Wr=e,Hr=t}function Zr(e,t,n){Kr[Gr++]=$r,Kr[Gr++]=Yr,Kr[Gr++]=Qr,Qr=e;var i=$r;e=Yr;var r=32-at(i)-1;i&=~(1<<r),n+=1;var o=32-at(t)+r;if(30<o){var a=r-r%5;o=(i&(1<<a)-1).toString(32),i>>=a,r-=a,$r=1<<32-at(t)+r|n<<r|i,Yr=o+e}else $r=1<<o|n<<r|i,Yr=e}function eo(e){null!==e.return&&(Xr(e,1),Zr(e,1,0))}function to(e){for(;e===Wr;)Wr=Jr[--qr],Jr[qr]=null,Hr=Jr[--qr],Jr[qr]=null;for(;e===Qr;)Qr=Kr[--Gr],Kr[Gr]=null,Yr=Kr[--Gr],Kr[Gr]=null,$r=Kr[--Gr],Kr[Gr]=null}var no=null,io=null,ro=!1,oo=null;function ao(e,t){var n=_l(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function so(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,io=lr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,io=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qr?{id:$r,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=_l(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,io=null,!0);default:return!1}}function co(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function lo(e){if(ro){var t=io;if(t){var n=t;if(!so(e,t)){if(co(e))throw Error(o(418));t=lr(n.nextSibling);var i=no;t&&so(e,t)?ao(i,n):(e.flags=-4097&e.flags|2,ro=!1,no=e)}}else{if(co(e))throw Error(o(418));e.flags=-4097&e.flags|2,ro=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!ro)return uo(e),ro=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=io)){if(co(e))throw po(),Error(o(418));for(;t;)ao(e,t),t=lr(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){io=lr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}io=null}}else io=no?lr(e.stateNode.nextSibling):null;return!0}function po(){for(var e=io;e;)e=lr(e.nextSibling)}function fo(){io=no=null,ro=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=k.ReactCurrentBatchConfig;function vo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var i=n.stateNode}if(!i)throw Error(o(147,e));var r=i,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=r.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function yo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bo(e){return(0,e._init)(e._payload)}function ko(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Dl(e,t)).index=0,e.sibling=null,e}function a(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,i){return null===t||6!==t.tag?((t=Ul(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function l(e,t,n,i){var o=n.type;return o===C?d(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===I&&bo(o)===t.type)?((i=r(t,n.props)).ref=vo(e,t,n),i.return=e,i):((i=Ml(n.type,n.key,n.props,null,e.mode,i)).ref=vo(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fl(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,i,o){return null===t||7!==t.tag?((t=Ll(n,e.mode,i,o)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Ul(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case S:return(n=Ml(t.type,t.key,t.props,null,e.mode,n)).ref=vo(e,null,t),n.return=e,n;case w:return(t=Fl(t,e.mode,n)).return=e,t;case I:return h(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Ll(t,e.mode,n,null)).return=e,t;yo(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:c(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case S:return n.key===r?l(e,t,n,i):null;case w:return n.key===r?u(e,t,n,i):null;case I:return p(e,t,(r=n._init)(n._payload),i)}if(te(n)||L(n))return null!==r?null:d(e,t,n,i,null);yo(e,n)}return null}function f(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return c(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case S:return l(t,e=e.get(null===i.key?n:i.key)||null,i,r);case w:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case I:return f(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||L(i))return d(t,e=e.get(n)||null,i,r,null);yo(t,i)}return null}function m(r,o,s,c){for(var l=null,u=null,d=o,m=o=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=p(r,d,s[m],c);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(r,d),o=a(v,o,m),null===u?l=v:u.sibling=v,u=v,d=g}if(m===s.length)return n(r,d),ro&&Xr(r,m),l;if(null===d){for(;m<s.length;m++)null!==(d=h(r,s[m],c))&&(o=a(d,o,m),null===u?l=d:u.sibling=d,u=d);return ro&&Xr(r,m),l}for(d=i(r,d);m<s.length;m++)null!==(g=f(d,r,m,s[m],c))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),o=a(g,o,m),null===u?l=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(r,e)})),ro&&Xr(r,m),l}function g(r,s,c,l){var u=L(c);if("function"!==typeof u)throw Error(o(150));if(null==(c=u.call(c)))throw Error(o(151));for(var d=u=null,m=s,g=s=0,v=null,y=c.next();null!==m&&!y.done;g++,y=c.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(r,m,y.value,l);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(r,m),s=a(b,s,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(r,m),ro&&Xr(r,g),u;if(null===m){for(;!y.done;g++,y=c.next())null!==(y=h(r,y.value,l))&&(s=a(y,s,g),null===d?u=y:d.sibling=y,d=y);return ro&&Xr(r,g),u}for(m=i(r,m);!y.done;g++,y=c.next())null!==(y=f(m,r,g,y.value,l))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=a(y,s,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach((function(e){return t(r,e)})),ro&&Xr(r,g),u}return function e(i,o,a,c){if("object"===typeof a&&null!==a&&a.type===C&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case S:e:{for(var l=a.key,u=o;null!==u;){if(u.key===l){if((l=a.type)===C){if(7===u.tag){n(i,u.sibling),(o=r(u,a.props.children)).return=i,i=o;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===I&&bo(l)===u.type){n(i,u.sibling),(o=r(u,a.props)).ref=vo(i,u,a),o.return=i,i=o;break e}n(i,u);break}t(i,u),u=u.sibling}a.type===C?((o=Ll(a.props.children,i.mode,c,a.key)).return=i,i=o):((c=Ml(a.type,a.key,a.props,null,i.mode,c)).ref=vo(i,o,a),c.return=i,i=c)}return s(i);case w:e:{for(u=a.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(i,o.sibling),(o=r(o,a.children||[])).return=i,i=o;break e}n(i,o);break}t(i,o),o=o.sibling}(o=Fl(a,i.mode,c)).return=i,i=o}return s(i);case I:return e(i,o,(u=a._init)(a._payload),c)}if(te(a))return m(i,o,a,c);if(L(a))return g(i,o,a,c);yo(i,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(n(i,o.sibling),(o=r(o,a)).return=i,i=o):(n(i,o),(o=Ul(a,i.mode,c)).return=i,i=o),s(i)):n(i,o)}}var So=ko(!0),wo=ko(!1),Co=Tr(null),To=null,Eo=null,Po=null;function xo(){Po=Eo=To=null}function Ro(e){var t=Co.current;Er(Co),e._currentValue=t}function No(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Oo(e,t){To=e,Po=Eo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function _o(e){var t=e._currentValue;if(Po!==e)if(e={context:e,memoizedValue:t,next:null},null===Eo){if(null===To)throw Error(o(308));Eo=e,To.dependencies={lanes:0,firstContext:e}}else Eo=Eo.next=e;return t}var Io=null;function Do(e){null===Io?Io=[e]:Io.push(e)}function Mo(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Do(t)):(n.next=r.next,r.next=n),t.interleaved=n,Lo(e,i)}function Lo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ao=!1;function Uo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function jo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bo(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Rc)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Lo(e,n)}return null===(r=i.interleaved)?(t.next=t,Do(i)):(t.next=r.next,r.next=t),i.interleaved=t,Lo(e,n)}function Vo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}function zo(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?r=o=t:o=o.next=t}else r=o=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Jo(e,t,n,i){var r=e.updateQueue;Ao=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var c=s,l=c.next;c.next=null,null===a?o=l:a.next=l,a=c;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(null!==o){var d=r.baseState;for(a=0,u=l=c=null,s=o;;){var h=s.lane,p=s.eventTime;if((i&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=U({},d,h);break e;case 2:Ao=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[s]:h.push(s))}else p={eventTime:p,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(l=u=p,c=d):u=u.next=p,a|=h;if(null===(s=s.next)){if(null===(s=r.shared.pending))break;s=(h=s).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===u&&(c=d),r.baseState=c,r.firstBaseUpdate=l,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{a|=r.lane,r=r.next}while(r!==t)}else null===o&&(r.shared.lanes=0);Ac|=a,e.lanes=a,e.memoizedState=d}}function qo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(o(191,r));r.call(i)}}}var Wo={},Ho=Tr(Wo),Ko=Tr(Wo),Go=Tr(Wo);function Qo(e){if(e===Wo)throw Error(o(174));return e}function $o(e,t){switch(Pr(Go,t),Pr(Ko,e),Pr(Ho,Wo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Er(Ho),Pr(Ho,t)}function Yo(){Er(Ho),Er(Ko),Er(Go)}function Xo(e){Qo(Go.current);var t=Qo(Ho.current),n=ce(t,e.type);t!==n&&(Pr(Ko,e),Pr(Ho,n))}function Zo(e){Ko.current===e&&(Er(Ho),Er(Ko))}var ea=Tr(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var na=[];function ia(){for(var e=0;e<na.length;e++)na[e]._workInProgressVersionPrimary=null;na.length=0}var ra=k.ReactCurrentDispatcher,oa=k.ReactCurrentBatchConfig,aa=0,sa=null,ca=null,la=null,ua=!1,da=!1,ha=0,pa=0;function fa(){throw Error(o(321))}function ma(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!si(e[n],t[n]))return!1;return!0}function ga(e,t,n,i,r,a){if(aa=a,sa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ra.current=null===e||null===e.memoizedState?Za:es,e=n(i,r),da){a=0;do{if(da=!1,ha=0,25<=a)throw Error(o(301));a+=1,la=ca=null,t.updateQueue=null,ra.current=ts,e=n(i,r)}while(da)}if(ra.current=Xa,t=null!==ca&&null!==ca.next,aa=0,la=ca=sa=null,ua=!1,t)throw Error(o(300));return e}function va(){var e=0!==ha;return ha=0,e}function ya(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?sa.memoizedState=la=e:la=la.next=e,la}function ba(){if(null===ca){var e=sa.alternate;e=null!==e?e.memoizedState:null}else e=ca.next;var t=null===la?sa.memoizedState:la.next;if(null!==t)la=t,ca=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ca=e).memoizedState,baseState:ca.baseState,baseQueue:ca.baseQueue,queue:ca.queue,next:null},null===la?sa.memoizedState=la=e:la=la.next=e}return la}function ka(e,t){return"function"===typeof t?t(e):t}function Sa(e){var t=ba(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var i=ca,r=i.baseQueue,a=n.pending;if(null!==a){if(null!==r){var s=r.next;r.next=a.next,a.next=s}i.baseQueue=r=a,n.pending=null}if(null!==r){a=r.next,i=i.baseState;var c=s=null,l=null,u=a;do{var d=u.lane;if((aa&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=h,s=i):l=l.next=h,sa.lanes|=d,Ac|=d}u=u.next}while(null!==u&&u!==a);null===l?s=i:l.next=c,si(i,t.memoizedState)||(bs=!0),t.memoizedState=i,t.baseState=s,t.baseQueue=l,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{a=r.lane,sa.lanes|=a,Ac|=a,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wa(e){var t=ba(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,a=t.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{a=e(a,s.action),s=s.next}while(s!==r);si(a,t.memoizedState)||(bs=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,i]}function Ca(){}function Ta(e,t){var n=sa,i=ba(),r=t(),a=!si(i.memoizedState,r);if(a&&(i.memoizedState=r,bs=!0),i=i.queue,Aa(xa.bind(null,n,i,e),[e]),i.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,_a(9,Pa.bind(null,n,i,r,t),void 0,null),null===Nc)throw Error(o(349));0!==(30&aa)||Ea(n,t,r)}return r}function Ea(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Pa(e,t,n,i){t.value=n,t.getSnapshot=i,Ra(t)&&Na(e)}function xa(e,t,n){return n((function(){Ra(t)&&Na(e)}))}function Ra(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!si(e,n)}catch(i){return!0}}function Na(e){var t=Lo(e,1);null!==t&&nl(t,e,1,-1)}function Oa(e){var t=ya();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:e},t.queue=e,e=e.dispatch=Ga.bind(null,sa,e),[t.memoizedState,e]}function _a(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Ia(){return ba().memoizedState}function Da(e,t,n,i){var r=ya();sa.flags|=e,r.memoizedState=_a(1|t,n,void 0,void 0===i?null:i)}function Ma(e,t,n,i){var r=ba();i=void 0===i?null:i;var o=void 0;if(null!==ca){var a=ca.memoizedState;if(o=a.destroy,null!==i&&ma(i,a.deps))return void(r.memoizedState=_a(t,n,o,i))}sa.flags|=e,r.memoizedState=_a(1|t,n,o,i)}function La(e,t){return Da(8390656,8,e,t)}function Aa(e,t){return Ma(2048,8,e,t)}function Ua(e,t){return Ma(4,2,e,t)}function Fa(e,t){return Ma(4,4,e,t)}function ja(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ba(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ma(4,4,ja.bind(null,t,e),n)}function Va(){}function za(e,t){var n=ba();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&ma(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Ja(e,t){var n=ba();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&ma(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function qa(e,t,n){return 0===(21&aa)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n):(si(n,t)||(n=mt(),sa.lanes|=n,Ac|=n,e.baseState=!0),t)}function Wa(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var i=oa.transition;oa.transition={};try{e(!1),t()}finally{bt=n,oa.transition=i}}function Ha(){return ba().memoizedState}function Ka(e,t,n){var i=tl(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Qa(e))$a(t,n);else if(null!==(n=Mo(e,t,n,i))){nl(n,e,i,el()),Ya(n,t,i)}}function Ga(e,t,n){var i=tl(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qa(e))$a(t,r);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(r.hasEagerState=!0,r.eagerState=s,si(s,a)){var c=t.interleaved;return null===c?(r.next=r,Do(t)):(r.next=c.next,c.next=r),void(t.interleaved=r)}}catch(l){}null!==(n=Mo(e,t,r,i))&&(nl(n,e,i,r=el()),Ya(n,t,i))}}function Qa(e){var t=e.alternate;return e===sa||null!==t&&t===sa}function $a(e,t){da=ua=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ya(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Xa={readContext:_o,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},Za={readContext:_o,useCallback:function(e,t){return ya().memoizedState=[e,void 0===t?null:t],e},useContext:_o,useEffect:La,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Da(4194308,4,ja.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Da(4194308,4,e,t)},useInsertionEffect:function(e,t){return Da(4,2,e,t)},useMemo:function(e,t){var n=ya();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=ya();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Ka.bind(null,sa,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},ya().memoizedState=e},useState:Oa,useDebugValue:Va,useDeferredValue:function(e){return ya().memoizedState=e},useTransition:function(){var e=Oa(!1),t=e[0];return e=Wa.bind(null,e[1]),ya().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=sa,r=ya();if(ro){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Nc)throw Error(o(349));0!==(30&aa)||Ea(i,t,n)}r.memoizedState=n;var a={value:n,getSnapshot:t};return r.queue=a,La(xa.bind(null,i,a,e),[e]),i.flags|=2048,_a(9,Pa.bind(null,i,a,n,t),void 0,null),n},useId:function(){var e=ya(),t=Nc.identifierPrefix;if(ro){var n=Yr;t=":"+t+"R"+(n=($r&~(1<<32-at($r)-1)).toString(32)+n),0<(n=ha++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=pa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:_o,useCallback:za,useContext:_o,useEffect:Aa,useImperativeHandle:Ba,useInsertionEffect:Ua,useLayoutEffect:Fa,useMemo:Ja,useReducer:Sa,useRef:Ia,useState:function(){return Sa(ka)},useDebugValue:Va,useDeferredValue:function(e){return qa(ba(),ca.memoizedState,e)},useTransition:function(){return[Sa(ka)[0],ba().memoizedState]},useMutableSource:Ca,useSyncExternalStore:Ta,useId:Ha,unstable_isNewReconciler:!1},ts={readContext:_o,useCallback:za,useContext:_o,useEffect:Aa,useImperativeHandle:Ba,useInsertionEffect:Ua,useLayoutEffect:Fa,useMemo:Ja,useReducer:wa,useRef:Ia,useState:function(){return wa(ka)},useDebugValue:Va,useDeferredValue:function(e){var t=ba();return null===ca?t.memoizedState=e:qa(t,ca.memoizedState,e)},useTransition:function(){return[wa(ka)[0],ba().memoizedState]},useMutableSource:Ca,useSyncExternalStore:Ta,useId:Ha,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function is(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var rs={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=el(),r=tl(e),o=jo(i,r);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Bo(e,o,r))&&(nl(t,e,r,i),Vo(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=el(),r=tl(e),o=jo(i,r);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Bo(e,o,r))&&(nl(t,e,r,i),Vo(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=el(),i=tl(e),r=jo(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Bo(e,r,i))&&(nl(t,e,i,n),Vo(t,e,i))}};function os(e,t,n,i,r,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!ci(n,i)||!ci(r,o))}function as(e,t,n){var i=!1,r=xr,o=t.contextType;return"object"===typeof o&&null!==o?o=_o(o):(r=Ir(t)?Or:Rr.current,o=(i=null!==(i=t.contextTypes)&&void 0!==i)?_r(e,r):xr),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=rs,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=o),t}function ss(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&rs.enqueueReplaceState(t,t.state,null)}function cs(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Uo(e);var o=t.contextType;"object"===typeof o&&null!==o?r.context=_o(o):(o=Ir(t)?Or:Rr.current,r.context=_r(e,o)),r.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(is(e,t,o,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&rs.enqueueReplaceState(r,r.state,null),Jo(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function ls(e,t){try{var n="",i=t;do{n+=V(i),i=i.return}while(i);var r=n}catch(o){r="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:r,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ds(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var hs="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=jo(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){qc||(qc=!0,Wc=i),ds(0,t)},n}function fs(e,t,n){(n=jo(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){ds(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){ds(0,t),"function"!==typeof i&&(null===Hc?Hc=new Set([this]):Hc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new hs;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=El.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=jo(-1,1)).tag=2,Bo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var ys=k.ReactCurrentOwner,bs=!1;function ks(e,t,n,i){t.child=null===e?wo(t,null,n,i):So(t,e.child,n,i)}function Ss(e,t,n,i,r){n=n.render;var o=t.ref;return Oo(t,r),i=ga(e,t,n,i,o,r),n=va(),null===e||bs?(ro&&n&&eo(t),t.flags|=1,ks(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,qs(e,t,r))}function ws(e,t,n,i,r){if(null===e){var o=n.type;return"function"!==typeof o||Il(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ml(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Cs(e,t,o,i,r))}if(o=e.child,0===(e.lanes&r)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:ci)(a,i)&&e.ref===t.ref)return qs(e,t,r)}return t.flags|=1,(e=Dl(o,i)).ref=t.ref,e.return=t,t.child=e}function Cs(e,t,n,i,r){if(null!==e){var o=e.memoizedProps;if(ci(o,i)&&e.ref===t.ref){if(bs=!1,t.pendingProps=i=o,0===(e.lanes&r))return t.lanes=e.lanes,qs(e,t,r);0!==(131072&e.flags)&&(bs=!0)}}return Ps(e,t,n,i,r)}function Ts(e,t,n){var i=t.pendingProps,r=i.children,o=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pr(Dc,Ic),Ic|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Pr(Dc,Ic),Ic|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==o?o.baseLanes:n,Pr(Dc,Ic),Ic|=i}else null!==o?(i=o.baseLanes|n,t.memoizedState=null):i=n,Pr(Dc,Ic),Ic|=i;return ks(e,t,r,n),t.child}function Es(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ps(e,t,n,i,r){var o=Ir(n)?Or:Rr.current;return o=_r(t,o),Oo(t,r),n=ga(e,t,n,i,o,r),i=va(),null===e||bs?(ro&&i&&eo(t),t.flags|=1,ks(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,qs(e,t,r))}function xs(e,t,n,i,r){if(Ir(n)){var o=!0;Ar(t)}else o=!1;if(Oo(t,r),null===t.stateNode)Js(e,t),as(t,n,i),cs(t,n,i,r),i=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var c=a.context,l=n.contextType;"object"===typeof l&&null!==l?l=_o(l):l=_r(t,l=Ir(n)?Or:Rr.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==i||c!==l)&&ss(t,a,i,l),Ao=!1;var h=t.memoizedState;a.state=h,Jo(t,i,a,r),c=t.memoizedState,s!==i||h!==c||Nr.current||Ao?("function"===typeof u&&(is(t,n,u,i),c=t.memoizedState),(s=Ao||os(t,n,s,i,h,c,l))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),a.props=i,a.state=c,a.context=l,i=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,Fo(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:ns(t.type,s),a.props=l,d=t.pendingProps,h=a.context,"object"===typeof(c=n.contextType)&&null!==c?c=_o(c):c=_r(t,c=Ir(n)?Or:Rr.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==d||h!==c)&&ss(t,a,i,c),Ao=!1,h=t.memoizedState,a.state=h,Jo(t,i,a,r);var f=t.memoizedState;s!==d||h!==f||Nr.current||Ao?("function"===typeof p&&(is(t,n,p,i),f=t.memoizedState),(l=Ao||os(t,n,l,i,h,f,c)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,f,c),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,f,c)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),a.props=i,a.state=f,a.context=c,i=l):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return Rs(e,t,n,i,o,r)}function Rs(e,t,n,i,r,o){Es(e,t);var a=0!==(128&t.flags);if(!i&&!a)return r&&Ur(t,n,!1),qs(e,t,o);i=t.stateNode,ys.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&a?(t.child=So(t,e.child,null,o),t.child=So(t,null,s,o)):ks(e,t,s,o),t.memoizedState=i.state,r&&Ur(t,n,!0),t.child}function Ns(e){var t=e.stateNode;t.pendingContext?Mr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Mr(0,t.context,!1),$o(e,t.containerInfo)}function Os(e,t,n,i,r){return fo(),mo(r),t.flags|=256,ks(e,t,n,i),t.child}var _s,Is,Ds,Ms,Ls={dehydrated:null,treeContext:null,retryLane:0};function As(e){return{baseLanes:e,cachePool:null,transitions:null}}function Us(e,t,n){var i,r=t.pendingProps,a=ea.current,s=!1,c=0!==(128&t.flags);if((i=c)||(i=(null===e||null!==e.memoizedState)&&0!==(2&a)),i?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Pr(ea,1&a),null===e)return lo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=r.children,e=r.fallback,s?(r=t.mode,s=t.child,c={mode:"hidden",children:c},0===(1&r)&&null!==s?(s.childLanes=0,s.pendingProps=c):s=Al(c,r,0,null),e=Ll(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=As(n),t.memoizedState=Ls,e):Fs(t,c));if(null!==(a=e.memoizedState)&&null!==(i=a.dehydrated))return function(e,t,n,i,r,a,s){if(n)return 256&t.flags?(t.flags&=-257,js(e,t,s,i=us(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=i.fallback,r=t.mode,i=Al({mode:"visible",children:i.children},r,0,null),(a=Ll(a,r,s,null)).flags|=2,i.return=t,a.return=t,i.sibling=a,t.child=i,0!==(1&t.mode)&&So(t,e.child,null,s),t.child.memoizedState=As(s),t.memoizedState=Ls,a);if(0===(1&t.mode))return js(e,t,s,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var c=i.dgst;return i=c,js(e,t,s,i=us(a=Error(o(419)),i,void 0))}if(c=0!==(s&e.childLanes),bs||c){if(null!==(i=Nc)){switch(s&-s){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|s))?0:r)&&r!==a.retryLane&&(a.retryLane=r,Lo(e,r),nl(i,e,r,-1))}return ml(),js(e,t,s,i=us(Error(o(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=xl.bind(null,e),r._reactRetry=t,null):(e=a.treeContext,io=lr(r.nextSibling),no=t,ro=!0,oo=null,null!==e&&(Kr[Gr++]=$r,Kr[Gr++]=Yr,Kr[Gr++]=Qr,$r=e.id,Yr=e.overflow,Qr=t),t=Fs(t,i.children),t.flags|=4096,t)}(e,t,c,r,i,a,n);if(s){s=r.fallback,c=t.mode,i=(a=e.child).sibling;var l={mode:"hidden",children:r.children};return 0===(1&c)&&t.child!==a?((r=t.child).childLanes=0,r.pendingProps=l,t.deletions=null):(r=Dl(a,l)).subtreeFlags=14680064&a.subtreeFlags,null!==i?s=Dl(i,s):(s=Ll(s,c,n,null)).flags|=2,s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,c=null===(c=e.child.memoizedState)?As(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=e.childLanes&~n,t.memoizedState=Ls,r}return e=(s=e.child).sibling,r=Dl(s,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Fs(e,t){return(t=Al({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function js(e,t,n,i){return null!==i&&mo(i),So(t,e.child,null,n),(e=Fs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bs(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),No(e.return,t,n)}function Vs(e,t,n,i,r){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r)}function zs(e,t,n){var i=t.pendingProps,r=i.revealOrder,o=i.tail;if(ks(e,t,i.children,n),0!==(2&(i=ea.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bs(e,n,t);else if(19===e.tag)Bs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Pr(ea,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ta(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Vs(t,!1,r,n,o);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ta(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Vs(t,!0,n,null,o);break;case"together":Vs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Js(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ac|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Dl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ws(e,t){if(!ro)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Hs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Ks(e,t,n){var i=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hs(t),null;case 1:case 17:return Ir(t.type)&&Dr(),Hs(t),null;case 3:return i=t.stateNode,Yo(),Er(Nr),Er(Rr),ia(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(al(oo),oo=null))),Is(e,t),Hs(t),null;case 5:Zo(t);var r=Qo(Go.current);if(n=t.type,null!==e&&null!=t.stateNode)Ds(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(o(166));return Hs(t),null}if(e=Qo(Ho.current),ho(t)){i=t.stateNode,n=t.type;var a=t.memoizedProps;switch(i[hr]=t,i[pr]=a,e=0!==(1&t.mode),n){case"dialog":ji("cancel",i),ji("close",i);break;case"iframe":case"object":case"embed":ji("load",i);break;case"video":case"audio":for(r=0;r<Li.length;r++)ji(Li[r],i);break;case"source":ji("error",i);break;case"img":case"image":case"link":ji("error",i),ji("load",i);break;case"details":ji("toggle",i);break;case"input":$(i,a),ji("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},ji("invalid",i);break;case"textarea":re(i,a),ji("invalid",i)}for(var c in ye(n,a),r=null,a)if(a.hasOwnProperty(c)){var l=a[c];"children"===c?"string"===typeof l?i.textContent!==l&&(!0!==a.suppressHydrationWarning&&Xi(i.textContent,l,e),r=["children",l]):"number"===typeof l&&i.textContent!==""+l&&(!0!==a.suppressHydrationWarning&&Xi(i.textContent,l,e),r=["children",""+l]):s.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&ji("scroll",i)}switch(n){case"input":H(i),Z(i,a,!0);break;case"textarea":H(i),ae(i);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(i.onclick=Zi)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{c=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=c.createElement(n,{is:i.is}):(e=c.createElement(n),"select"===n&&(c=e,i.multiple?c.multiple=!0:i.size&&(c.size=i.size))):e=c.createElementNS(e,n),e[hr]=t,e[pr]=i,_s(e,t,!1,!1),t.stateNode=e;e:{switch(c=be(n,i),n){case"dialog":ji("cancel",e),ji("close",e),r=i;break;case"iframe":case"object":case"embed":ji("load",e),r=i;break;case"video":case"audio":for(r=0;r<Li.length;r++)ji(Li[r],e);r=i;break;case"source":ji("error",e),r=i;break;case"img":case"image":case"link":ji("error",e),ji("load",e),r=i;break;case"details":ji("toggle",e),r=i;break;case"input":$(e,i),r=Q(e,i),ji("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=U({},i,{value:void 0}),ji("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),ji("invalid",e)}for(a in ye(n,r),l=r)if(l.hasOwnProperty(a)){var u=l[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=u&&"onScroll"===a&&ji("scroll",e):null!=u&&b(e,a,u,c))}switch(n){case"input":H(e),Z(e,i,!1);break;case"textarea":H(e),ae(e);break;case"option":null!=i.value&&e.setAttribute("value",""+q(i.value));break;case"select":e.multiple=!!i.multiple,null!=(a=i.value)?ne(e,!!i.multiple,a,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Zi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Hs(t),null;case 6:if(e&&null!=t.stateNode)Ms(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(o(166));if(n=Qo(Go.current),Qo(Ho.current),ho(t)){if(i=t.stateNode,n=t.memoizedProps,i[hr]=t,(a=i.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Xi(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xi(i.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[hr]=t,t.stateNode=i}return Hs(t),null;case 13:if(Er(ea),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ro&&null!==io&&0!==(1&t.mode)&&0===(128&t.flags))po(),fo(),t.flags|=98560,a=!1;else if(a=ho(t),null!==i&&null!==i.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[hr]=t}else fo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Hs(t),a=!1}else null!==oo&&(al(oo),oo=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ea.current)?0===Mc&&(Mc=3):ml())),null!==t.updateQueue&&(t.flags|=4),Hs(t),null);case 4:return Yo(),Is(e,t),null===e&&zi(t.stateNode.containerInfo),Hs(t),null;case 10:return Ro(t.type._context),Hs(t),null;case 19:if(Er(ea),null===(a=t.memoizedState))return Hs(t),null;if(i=0!==(128&t.flags),null===(c=a.rendering))if(i)Ws(a,!1);else{if(0!==Mc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=ta(e))){for(t.flags|=128,Ws(a,!1),null!==(i=c.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(a=n).flags&=14680066,null===(c=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,e=c.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Pr(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&Ye()>zc&&(t.flags|=128,i=!0,Ws(a,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=ta(c))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ws(a,!0),null===a.tail&&"hidden"===a.tailMode&&!c.alternate&&!ro)return Hs(t),null}else 2*Ye()-a.renderingStartTime>zc&&1073741824!==n&&(t.flags|=128,i=!0,Ws(a,!1),t.lanes=4194304);a.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=a.last)?n.sibling=c:t.child=c,a.last=c)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ye(),t.sibling=null,n=ea.current,Pr(ea,i?1&n|2:1&n),t):(Hs(t),null);case 22:case 23:return dl(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Ic)&&(Hs(t),6&t.subtreeFlags&&(t.flags|=8192)):Hs(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Gs(e,t){switch(to(t),t.tag){case 1:return Ir(t.type)&&Dr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Yo(),Er(Nr),Er(Rr),ia(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zo(t),null;case 13:if(Er(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Er(ea),null;case 4:return Yo(),null;case 10:return Ro(t.type._context),null;case 22:case 23:return dl(),null;default:return null}}_s=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Is=function(){},Ds=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,Qo(Ho.current);var o,a=null;switch(n){case"input":r=Q(e,r),i=Q(e,i),a=[];break;case"select":r=U({},r,{value:void 0}),i=U({},i,{value:void 0}),a=[];break;case"textarea":r=ie(e,r),i=ie(e,i),a=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=Zi)}for(u in ye(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var c=r[u];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in i){var l=i[u];if(c=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(o in c)!c.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&c[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(a||(a=[]),a.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(a=a||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(a=a||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&ji("scroll",e),a||c===l||(a=[])):(a=a||[]).push(u,l))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Ms=function(e,t,n,i){n!==i&&(t.flags|=4)};var Qs=!1,$s=!1,Ys="function"===typeof WeakSet?WeakSet:Set,Xs=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Tl(e,t,i)}else n.current=null}function ec(e,t,n){try{n()}catch(i){Tl(e,t,i)}}var tc=!1;function nc(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var o=r.destroy;r.destroy=void 0,void 0!==o&&ec(t,n,o)}r=r.next}while(r!==i)}}function ic(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function rc(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function oc(e){var t=e.alternate;null!==t&&(e.alternate=null,oc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hr],delete t[pr],delete t[mr],delete t[gr],delete t[vr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ac(e){return 5===e.tag||3===e.tag||4===e.tag}function sc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ac(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cc(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zi));else if(4!==i&&null!==(e=e.child))for(cc(e,t,n),e=e.sibling;null!==e;)cc(e,t,n),e=e.sibling}function lc(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}var uc=null,dc=!1;function hc(e,t,n){for(n=n.child;null!==n;)pc(e,t,n),n=n.sibling}function pc(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(rt,n)}catch(s){}switch(n.tag){case 5:$s||Zs(n,t);case 6:var i=uc,r=dc;uc=null,hc(e,t,n),dc=r,null!==(uc=i)&&(dc?(e=uc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):uc.removeChild(n.stateNode));break;case 18:null!==uc&&(dc?(e=uc,n=n.stateNode,8===e.nodeType?cr(e.parentNode,n):1===e.nodeType&&cr(e,n),zt(e)):cr(uc,n.stateNode));break;case 4:i=uc,r=dc,uc=n.stateNode.containerInfo,dc=!0,hc(e,t,n),uc=i,dc=r;break;case 0:case 11:case 14:case 15:if(!$s&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var o=r,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&ec(n,t,a),r=r.next}while(r!==i)}hc(e,t,n);break;case 1:if(!$s&&(Zs(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(s){Tl(n,t,s)}hc(e,t,n);break;case 21:hc(e,t,n);break;case 22:1&n.mode?($s=(i=$s)||null!==n.memoizedState,hc(e,t,n),$s=i):hc(e,t,n);break;default:hc(e,t,n)}}function fc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ys),t.forEach((function(t){var i=Rl.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function mc(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var a=e,s=t,c=s;e:for(;null!==c;){switch(c.tag){case 5:uc=c.stateNode,dc=!1;break e;case 3:case 4:uc=c.stateNode.containerInfo,dc=!0;break e}c=c.return}if(null===uc)throw Error(o(160));pc(a,s,r),uc=null,dc=!1;var l=r.alternate;null!==l&&(l.return=null),r.return=null}catch(u){Tl(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gc(t,e),t=t.sibling}function gc(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mc(t,e),vc(e),4&i){try{nc(3,e,e.return),ic(3,e)}catch(g){Tl(e,e.return,g)}try{nc(5,e,e.return)}catch(g){Tl(e,e.return,g)}}break;case 1:mc(t,e),vc(e),512&i&&null!==n&&Zs(n,n.return);break;case 5:if(mc(t,e),vc(e),512&i&&null!==n&&Zs(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(g){Tl(e,e.return,g)}}if(4&i&&null!=(r=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===a.type&&null!=a.name&&Y(r,a),be(c,s);var u=be(c,a);for(s=0;s<l.length;s+=2){var d=l[s],h=l[s+1];"style"===d?ge(r,h):"dangerouslySetInnerHTML"===d?de(r,h):"children"===d?he(r,h):b(r,d,h,u)}switch(c){case"input":X(r,a);break;case"textarea":oe(r,a);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?ne(r,!!a.multiple,f,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(r,!!a.multiple,a.defaultValue,!0):ne(r,!!a.multiple,a.multiple?[]:"",!1))}r[pr]=a}catch(g){Tl(e,e.return,g)}}break;case 6:if(mc(t,e),vc(e),4&i){if(null===e.stateNode)throw Error(o(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(g){Tl(e,e.return,g)}}break;case 3:if(mc(t,e),vc(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(g){Tl(e,e.return,g)}break;case 4:default:mc(t,e),vc(e);break;case 13:mc(t,e),vc(e),8192&(r=e.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||(Vc=Ye())),4&i&&fc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?($s=(u=$s)||d,mc(t,e),$s=u):mc(t,e),vc(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Xs=e,d=e.child;null!==d;){for(h=Xs=d;null!==Xs;){switch(f=(p=Xs).child,p.tag){case 0:case 11:case 14:case 15:nc(4,p,p.return);break;case 1:Zs(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){i=p,n=p.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Tl(i,n,g)}}break;case 5:Zs(p,p.return);break;case 22:if(null!==p.memoizedState){Sc(h);continue}}null!==f?(f.return=p,Xs=f):Sc(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{r=h.stateNode,u?"function"===typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(c=h.stateNode,s=void 0!==(l=h.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=me("display",s))}catch(g){Tl(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Tl(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:mc(t,e),vc(e),4&i&&fc(e);case 21:}}function vc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ac(n)){var i=n;break e}n=n.return}throw Error(o(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(he(r,""),i.flags&=-33),lc(e,sc(e),r);break;case 3:case 4:var a=i.stateNode.containerInfo;cc(e,sc(e),a);break;default:throw Error(o(161))}}catch(s){Tl(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yc(e,t,n){Xs=e,bc(e,t,n)}function bc(e,t,n){for(var i=0!==(1&e.mode);null!==Xs;){var r=Xs,o=r.child;if(22===r.tag&&i){var a=null!==r.memoizedState||Qs;if(!a){var s=r.alternate,c=null!==s&&null!==s.memoizedState||$s;s=Qs;var l=$s;if(Qs=a,($s=c)&&!l)for(Xs=r;null!==Xs;)c=(a=Xs).child,22===a.tag&&null!==a.memoizedState?wc(r):null!==c?(c.return=a,Xs=c):wc(r);for(;null!==o;)Xs=o,bc(o,t,n),o=o.sibling;Xs=r,Qs=s,$s=l}kc(e)}else 0!==(8772&r.subtreeFlags)&&null!==o?(o.return=r,Xs=o):kc(e)}}function kc(e){for(;null!==Xs;){var t=Xs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$s||ic(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!$s)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&qo(t,a,i);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}qo(t,s,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&zt(h)}}}break;default:throw Error(o(163))}$s||512&t.flags&&rc(t)}catch(p){Tl(t,t.return,p)}}if(t===e){Xs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xs=n;break}Xs=t.return}}function Sc(e){for(;null!==Xs;){var t=Xs;if(t===e){Xs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xs=n;break}Xs=t.return}}function wc(e){for(;null!==Xs;){var t=Xs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ic(4,t)}catch(c){Tl(t,n,c)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(c){Tl(t,r,c)}}var o=t.return;try{rc(t)}catch(c){Tl(t,o,c)}break;case 5:var a=t.return;try{rc(t)}catch(c){Tl(t,a,c)}}}catch(c){Tl(t,t.return,c)}if(t===e){Xs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Xs=s;break}Xs=t.return}}var Cc,Tc=Math.ceil,Ec=k.ReactCurrentDispatcher,Pc=k.ReactCurrentOwner,xc=k.ReactCurrentBatchConfig,Rc=0,Nc=null,Oc=null,_c=0,Ic=0,Dc=Tr(0),Mc=0,Lc=null,Ac=0,Uc=0,Fc=0,jc=null,Bc=null,Vc=0,zc=1/0,Jc=null,qc=!1,Wc=null,Hc=null,Kc=!1,Gc=null,Qc=0,$c=0,Yc=null,Xc=-1,Zc=0;function el(){return 0!==(6&Rc)?Ye():-1!==Xc?Xc:Xc=Ye()}function tl(e){return 0===(1&e.mode)?1:0!==(2&Rc)&&0!==_c?_c&-_c:null!==go.transition?(0===Zc&&(Zc=mt()),Zc):0!==(e=bt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function nl(e,t,n,i){if(50<$c)throw $c=0,Yc=null,Error(o(185));vt(e,n,i),0!==(2&Rc)&&e===Nc||(e===Nc&&(0===(2&Rc)&&(Uc|=n),4===Mc&&sl(e,_c)),il(e,i),1===n&&0===Rc&&0===(1&t.mode)&&(zc=Ye()+500,jr&&zr()))}function il(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-at(o),s=1<<a,c=r[a];-1===c?0!==(s&n)&&0===(s&i)||(r[a]=pt(s,t)):c<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var i=ht(e,e===Nc?_c:0);if(0===i)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){jr=!0,Vr(e)}(cl.bind(null,e)):Vr(cl.bind(null,e)),ar((function(){0===(6&Rc)&&zr()})),n=null;else{switch(kt(i)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Nl(n,rl.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rl(e,t){if(Xc=-1,Zc=0,0!==(6&Rc))throw Error(o(327));var n=e.callbackNode;if(wl()&&e.callbackNode!==n)return null;var i=ht(e,e===Nc?_c:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=gl(e,i);else{t=i;var r=Rc;Rc|=2;var a=fl();for(Nc===e&&_c===t||(Jc=null,zc=Ye()+500,hl(e,t));;)try{yl();break}catch(c){pl(e,c)}xo(),Ec.current=a,Rc=r,null!==Oc?t=0:(Nc=null,_c=0,t=Mc)}if(0!==t){if(2===t&&(0!==(r=ft(e))&&(i=r,t=ol(e,r))),1===t)throw n=Lc,hl(e,0),sl(e,i),il(e,Ye()),n;if(6===t)sl(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!si(o(),r))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gl(e,i))&&(0!==(a=ft(e))&&(i=a,t=ol(e,a))),1===t))throw n=Lc,hl(e,0),sl(e,i),il(e,Ye()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(o(345));case 2:case 5:Sl(e,Bc,Jc);break;case 3:if(sl(e,i),(130023424&i)===i&&10<(t=Vc+500-Ye())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&i)!==i){el(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(Sl.bind(null,e,Bc,Jc),t);break}Sl(e,Bc,Jc);break;case 4:if(sl(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var s=31-at(i);a=1<<s,(s=t[s])>r&&(r=s),i&=~a}if(i=r,10<(i=(120>(i=Ye()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Tc(i/1960))-i)){e.timeoutHandle=ir(Sl.bind(null,e,Bc,Jc),i);break}Sl(e,Bc,Jc);break;default:throw Error(o(329))}}}return il(e,Ye()),e.callbackNode===n?rl.bind(null,e):null}function ol(e,t){var n=jc;return e.current.memoizedState.isDehydrated&&(hl(e,t).flags|=256),2!==(e=gl(e,t))&&(t=Bc,Bc=n,null!==t&&al(t)),e}function al(e){null===Bc?Bc=e:Bc.push.apply(Bc,e)}function sl(e,t){for(t&=~Fc,t&=~Uc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),i=1<<n;e[n]=-1,t&=~i}}function cl(e){if(0!==(6&Rc))throw Error(o(327));wl();var t=ht(e,0);if(0===(1&t))return il(e,Ye()),null;var n=gl(e,t);if(0!==e.tag&&2===n){var i=ft(e);0!==i&&(t=i,n=ol(e,i))}if(1===n)throw n=Lc,hl(e,0),sl(e,t),il(e,Ye()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sl(e,Bc,Jc),il(e,Ye()),null}function ll(e,t){var n=Rc;Rc|=1;try{return e(t)}finally{0===(Rc=n)&&(zc=Ye()+500,jr&&zr())}}function ul(e){null!==Gc&&0===Gc.tag&&0===(6&Rc)&&wl();var t=Rc;Rc|=1;var n=xc.transition,i=bt;try{if(xc.transition=null,bt=1,e)return e()}finally{bt=i,xc.transition=n,0===(6&(Rc=t))&&zr()}}function dl(){Ic=Dc.current,Er(Dc)}function hl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Oc)for(n=Oc.return;null!==n;){var i=n;switch(to(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Dr();break;case 3:Yo(),Er(Nr),Er(Rr),ia();break;case 5:Zo(i);break;case 4:Yo();break;case 13:case 19:Er(ea);break;case 10:Ro(i.type._context);break;case 22:case 23:dl()}n=n.return}if(Nc=e,Oc=e=Dl(e.current,null),_c=Ic=t,Mc=0,Lc=null,Fc=Uc=Ac=0,Bc=jc=null,null!==Io){for(t=0;t<Io.length;t++)if(null!==(i=(n=Io[t]).interleaved)){n.interleaved=null;var r=i.next,o=n.pending;if(null!==o){var a=o.next;o.next=r,i.next=a}n.pending=i}Io=null}return e}function pl(e,t){for(;;){var n=Oc;try{if(xo(),ra.current=Xa,ua){for(var i=sa.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}ua=!1}if(aa=0,la=ca=sa=null,da=!1,ha=0,Pc.current=null,null===n||null===n.return){Mc=1,Lc=t,Oc=null;break}e:{var a=e,s=n.return,c=n,l=t;if(t=_c,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,d=c,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,vs(f,s,c,0,t),1&f.mode&&ms(a,u,t),l=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}if(0===(1&t)){ms(a,u,t),ml();break e}l=Error(o(426))}else if(ro&&1&c.mode){var v=gs(s);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vs(v,s,c,0,t),mo(ls(l,c));break e}}a=l=ls(l,c),4!==Mc&&(Mc=2),null===jc?jc=[a]:jc.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,zo(a,ps(0,l,t));break e;case 1:c=l;var y=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Hc||!Hc.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,zo(a,fs(a,c,t));break e}}a=a.return}while(null!==a)}kl(n)}catch(k){t=k,Oc===n&&null!==n&&(Oc=n=n.return);continue}break}}function fl(){var e=Ec.current;return Ec.current=Xa,null===e?Xa:e}function ml(){0!==Mc&&3!==Mc&&2!==Mc||(Mc=4),null===Nc||0===(268435455&Ac)&&0===(268435455&Uc)||sl(Nc,_c)}function gl(e,t){var n=Rc;Rc|=2;var i=fl();for(Nc===e&&_c===t||(Jc=null,hl(e,t));;)try{vl();break}catch(r){pl(e,r)}if(xo(),Rc=n,Ec.current=i,null!==Oc)throw Error(o(261));return Nc=null,_c=0,Mc}function vl(){for(;null!==Oc;)bl(Oc)}function yl(){for(;null!==Oc&&!Qe();)bl(Oc)}function bl(e){var t=Cc(e.alternate,e,Ic);e.memoizedProps=e.pendingProps,null===t?kl(e):Oc=t,Pc.current=null}function kl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ks(n,t,Ic)))return void(Oc=n)}else{if(null!==(n=Gs(n,t)))return n.flags&=32767,void(Oc=n);if(null===e)return Mc=6,void(Oc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Oc=t);Oc=t=e}while(null!==t);0===Mc&&(Mc=5)}function Sl(e,t,n){var i=bt,r=xc.transition;try{xc.transition=null,bt=1,function(e,t,n,i){do{wl()}while(null!==Gc);if(0!==(6&Rc))throw Error(o(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-at(n),o=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~o}}(e,a),e===Nc&&(Oc=Nc=null,_c=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kc||(Kc=!0,Nl(tt,(function(){return wl(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=xc.transition,xc.transition=null;var s=bt;bt=1;var c=Rc;Rc|=4,Pc.current=null,function(e,t){if(er=qt,pi(e=hi())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch(S){n=null;break e}var s=0,c=-1,l=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==r&&3!==h.nodeType||(c=s+r),h!==a||0!==i&&3!==h.nodeType||(l=s+i),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===r&&(c=s),p===a&&++d===i&&(l=s),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},qt=!1,Xs=t;null!==Xs;)if(e=(t=Xs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xs=e;else for(;null!==Xs;){t=Xs;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var k=t.stateNode.containerInfo;1===k.nodeType?k.textContent="":9===k.nodeType&&k.documentElement&&k.removeChild(k.documentElement);break;default:throw Error(o(163))}}catch(S){Tl(t,t.return,S)}if(null!==(e=t.sibling)){e.return=t.return,Xs=e;break}Xs=t.return}m=tc,tc=!1}(e,n),gc(n,e),fi(tr),qt=!!er,tr=er=null,e.current=n,yc(n,e,r),$e(),Rc=c,bt=s,xc.transition=a}else e.current=n;if(Kc&&(Kc=!1,Gc=e,Qc=r),a=e.pendingLanes,0===a&&(Hc=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),il(e,Ye()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(qc)throw qc=!1,e=Wc,Wc=null,e;0!==(1&Qc)&&0!==e.tag&&wl(),a=e.pendingLanes,0!==(1&a)?e===Yc?$c++:($c=0,Yc=e):$c=0,zr()}(e,t,n,i)}finally{xc.transition=r,bt=i}return null}function wl(){if(null!==Gc){var e=kt(Qc),t=xc.transition,n=bt;try{if(xc.transition=null,bt=16>e?16:e,null===Gc)var i=!1;else{if(e=Gc,Gc=null,Qc=0,0!==(6&Rc))throw Error(o(331));var r=Rc;for(Rc|=4,Xs=e.current;null!==Xs;){var a=Xs,s=a.child;if(0!==(16&Xs.flags)){var c=a.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Xs=u;null!==Xs;){var d=Xs;switch(d.tag){case 0:case 11:case 15:nc(8,d,a)}var h=d.child;if(null!==h)h.return=d,Xs=h;else for(;null!==Xs;){var p=(d=Xs).sibling,f=d.return;if(oc(d),d===u){Xs=null;break}if(null!==p){p.return=f,Xs=p;break}Xs=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Xs=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Xs=s;else e:for(;null!==Xs;){if(0!==(2048&(a=Xs).flags))switch(a.tag){case 0:case 11:case 15:nc(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Xs=y;break e}Xs=a.return}}var b=e.current;for(Xs=b;null!==Xs;){var k=(s=Xs).child;if(0!==(2064&s.subtreeFlags)&&null!==k)k.return=s,Xs=k;else e:for(s=b;null!==Xs;){if(0!==(2048&(c=Xs).flags))try{switch(c.tag){case 0:case 11:case 15:ic(9,c)}}catch(w){Tl(c,c.return,w)}if(c===s){Xs=null;break e}var S=c.sibling;if(null!==S){S.return=c.return,Xs=S;break e}Xs=c.return}}if(Rc=r,zr(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(rt,e)}catch(w){}i=!0}return i}finally{bt=n,xc.transition=t}}return!1}function Cl(e,t,n){e=Bo(e,t=ps(0,t=ls(n,t),1),1),t=el(),null!==e&&(vt(e,1,t),il(e,t))}function Tl(e,t,n){if(3===e.tag)Cl(e,e,n);else for(;null!==t;){if(3===t.tag){Cl(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Hc||!Hc.has(i))){t=Bo(t,e=fs(t,e=ls(n,e),1),1),e=el(),null!==t&&(vt(t,1,e),il(t,e));break}}t=t.return}}function El(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&n,Nc===e&&(_c&n)===n&&(4===Mc||3===Mc&&(130023424&_c)===_c&&500>Ye()-Vc?hl(e,0):Fc|=n),il(e,t)}function Pl(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=el();null!==(e=Lo(e,t))&&(vt(e,t,n),il(e,n))}function xl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Pl(e,n)}function Rl(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(o(314))}null!==i&&i.delete(t),Pl(e,n)}function Nl(e,t){return Ke(e,t)}function Ol(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _l(e,t,n,i){return new Ol(e,t,n,i)}function Il(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dl(e,t){var n=e.alternate;return null===n?((n=_l(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ml(e,t,n,i,r,a){var s=2;if(i=e,"function"===typeof e)Il(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case C:return Ll(n.children,r,a,t);case T:s=8,r|=8;break;case E:return(e=_l(12,n,t,2|r)).elementType=E,e.lanes=a,e;case N:return(e=_l(13,n,t,r)).elementType=N,e.lanes=a,e;case O:return(e=_l(19,n,t,r)).elementType=O,e.lanes=a,e;case D:return Al(n,r,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case P:s=10;break e;case x:s=9;break e;case R:s=11;break e;case _:s=14;break e;case I:s=16,i=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=_l(s,n,t,r)).elementType=e,t.type=i,t.lanes=a,t}function Ll(e,t,n,i){return(e=_l(7,e,i,t)).lanes=n,e}function Al(e,t,n,i){return(e=_l(22,e,i,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Ul(e,t,n){return(e=_l(6,e,null,t)).lanes=n,e}function Fl(e,t,n){return(t=_l(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jl(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Bl(e,t,n,i,r,o,a,s,c){return e=new jl(e,t,n,s,c),1===t?(t=1,!0===o&&(t|=8)):t=0,o=_l(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uo(o),e}function Vl(e){if(!e)return xr;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ir(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Ir(n))return Lr(e,n,t)}return t}function zl(e,t,n,i,r,o,a,s,c){return(e=Bl(n,i,!0,e,0,o,0,s,c)).context=Vl(null),n=e.current,(o=jo(i=el(),r=tl(n))).callback=void 0!==t&&null!==t?t:null,Bo(n,o,r),e.current.lanes=r,vt(e,r,i),il(e,i),e}function Jl(e,t,n,i){var r=t.current,o=el(),a=tl(r);return n=Vl(n),null===t.context?t.context=n:t.pendingContext=n,(t=jo(o,a)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Bo(r,t,a))&&(nl(e,r,a,o),Vo(e,r,a)),a}function ql(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hl(e,t){Wl(e,t),(e=e.alternate)&&Wl(e,t)}Cc=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Nr.current)bs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:Ns(t),fo();break;case 5:Xo(t);break;case 1:Ir(t.type)&&Ar(t);break;case 4:$o(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Pr(Co,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Pr(ea,1&ea.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Us(e,t,n):(Pr(ea,1&ea.current),null!==(e=qs(e,t,n))?e.sibling:null);Pr(ea,1&ea.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return zs(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Pr(ea,ea.current),i)break;return null;case 22:case 23:return t.lanes=0,Ts(e,t,n)}return qs(e,t,n)}(e,t,n);bs=0!==(131072&e.flags)}else bs=!1,ro&&0!==(1048576&t.flags)&&Zr(t,Hr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Js(e,t),e=t.pendingProps;var r=_r(t,Rr.current);Oo(t,n),r=ga(null,t,i,e,r,n);var a=va();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ir(i)?(a=!0,Ar(t)):a=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Uo(t),r.updater=rs,t.stateNode=r,r._reactInternals=t,cs(t,i,e,n),t=Rs(null,t,i,!0,a,n)):(t.tag=0,ro&&a&&eo(t),ks(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Js(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Il(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===R)return 11;if(e===_)return 14}return 2}(i),e=ns(i,e),r){case 0:t=Ps(null,t,i,e,n);break e;case 1:t=xs(null,t,i,e,n);break e;case 11:t=Ss(null,t,i,e,n);break e;case 14:t=ws(null,t,i,ns(i.type,e),n);break e}throw Error(o(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Ps(e,t,i,r=t.elementType===i?r:ns(i,r),n);case 1:return i=t.type,r=t.pendingProps,xs(e,t,i,r=t.elementType===i?r:ns(i,r),n);case 3:e:{if(Ns(t),null===e)throw Error(o(387));i=t.pendingProps,r=(a=t.memoizedState).element,Fo(e,t),Jo(t,i,null,n);var s=t.memoizedState;if(i=s.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Os(e,t,i,n,r=ls(Error(o(423)),t));break e}if(i!==r){t=Os(e,t,i,n,r=ls(Error(o(424)),t));break e}for(io=lr(t.stateNode.containerInfo.firstChild),no=t,ro=!0,oo=null,n=wo(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fo(),i===r){t=qs(e,t,n);break e}ks(e,t,i,n)}t=t.child}return t;case 5:return Xo(t),null===e&&lo(t),i=t.type,r=t.pendingProps,a=null!==e?e.memoizedProps:null,s=r.children,nr(i,r)?s=null:null!==a&&nr(i,a)&&(t.flags|=32),Es(e,t),ks(e,t,s,n),t.child;case 6:return null===e&&lo(t),null;case 13:return Us(e,t,n);case 4:return $o(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=So(t,null,i,n):ks(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,Ss(e,t,i,r=t.elementType===i?r:ns(i,r),n);case 7:return ks(e,t,t.pendingProps,n),t.child;case 8:case 12:return ks(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,a=t.memoizedProps,s=r.value,Pr(Co,i._currentValue),i._currentValue=s,null!==a)if(si(a.value,s)){if(a.children===r.children&&!Nr.current){t=qs(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var c=a.dependencies;if(null!==c){s=a.child;for(var l=c.firstContext;null!==l;){if(l.context===i){if(1===a.tag){(l=jo(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),No(a.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),No(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}ks(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Oo(t,n),i=i(r=_o(r)),t.flags|=1,ks(e,t,i,n),t.child;case 14:return r=ns(i=t.type,t.pendingProps),ws(e,t,i,r=ns(i.type,r),n);case 15:return Cs(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:ns(i,r),Js(e,t),t.tag=1,Ir(i)?(e=!0,Ar(t)):e=!1,Oo(t,n),as(t,i,r),cs(t,i,r,n),Rs(null,t,i,!0,e,n);case 19:return zs(e,t,n);case 22:return Ts(e,t,n)}throw Error(o(156,t.tag))};var Kl="function"===typeof reportError?reportError:function(e){console.error(e)};function Gl(e){this._internalRoot=e}function Ql(e){this._internalRoot=e}function $l(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xl(){}function Zl(e,t,n,i,r){var o=n._reactRootContainer;if(o){var a=o;if("function"===typeof r){var s=r;r=function(){var e=ql(a);s.call(e)}}Jl(t,a,e,r)}else a=function(e,t,n,i,r){if(r){if("function"===typeof i){var o=i;i=function(){var e=ql(a);o.call(e)}}var a=zl(t,i,e,0,null,!1,0,"",Xl);return e._reactRootContainer=a,e[fr]=a.current,zi(8===e.nodeType?e.parentNode:e),ul(),a}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var s=i;i=function(){var e=ql(c);s.call(e)}}var c=Bl(e,0,!1,null,0,!1,0,"",Xl);return e._reactRootContainer=c,e[fr]=c.current,zi(8===e.nodeType?e.parentNode:e),ul((function(){Jl(t,c,n,i)})),c}(n,t,e,r,i);return ql(a)}Ql.prototype.render=Gl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Jl(e,t,null,null)},Ql.prototype.unmount=Gl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ul((function(){Jl(null,e,null,null)})),t[fr]=null}},Ql.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ut(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),il(t,Ye()),0===(6&Rc)&&(zc=Ye()+500,zr()))}break;case 13:ul((function(){var t=Lo(e,1);if(null!==t){var n=el();nl(t,e,1,n)}})),Hl(e,1)}},wt=function(e){if(13===e.tag){var t=Lo(e,134217728);if(null!==t)nl(t,e,134217728,el());Hl(e,134217728)}},Ct=function(e){if(13===e.tag){var t=tl(e),n=Lo(e,t);if(null!==n)nl(n,e,t,el());Hl(e,t)}},Tt=function(){return bt},Et=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=Sr(i);if(!r)throw Error(o(90));K(i),X(i,r)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Re=ll,Ne=ul;var eu={usingClientEntryPoint:!1,Events:[br,kr,Sr,Pe,xe,ll]},tu={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{rt=iu.inject(nu),ot=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$l(t))throw Error(o(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$l(e))throw Error(o(299));var n=!1,i="",r=Kl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Bl(e,1,!1,null,0,n,0,i,r),e[fr]=t.current,zi(8===e.nodeType?e.parentNode:e),new Gl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return ul(e)},t.hydrate=function(e,t,n){if(!Yl(t))throw Error(o(200));return Zl(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$l(e))throw Error(o(405));var i=null!=n&&n.hydratedSources||null,r=!1,a="",s=Kl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=zl(t,null,e,1,null!=n?n:null,r,0,a,s),e[fr]=t.current,zi(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Ql(t)},t.render=function(e,t,n){if(!Yl(t))throw Error(o(200));return Zl(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yl(e))throw Error(o(40));return!!e._reactRootContainer&&(ul((function(){Zl(null,null,e,!1,(function(){e._reactRootContainer=null,e[fr]=null}))})),!0)},t.unstable_batchedUpdates=ll,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Yl(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return Zl(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{"use strict";e.exports=n(234)},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.m=e,n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,i)=>(n.f[i](e,t),t)),[])),n.u=e=>"static/js/"+e+".9eadd14b.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="livekit-video-chat-frontend:";n.l=(i,r,o,a)=>{if(e[i])e[i].push(r);else{var s,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==t+o){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+o),s.src=i),e[i]=[r];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(p);var r=e[i];if(delete e[i],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((e=>e(n))),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),c&&document.head.appendChild(s)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var o=new Promise(((n,i)=>r=e[t]=[n,i]));i.push(r[2]=o);var a=n.p+n.u(t),s=new Error;n.l(a,(i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,r[1](s)}}),"chunk-"+t,t)}};var t=(t,i)=>{var r,o,a=i[0],s=i[1],c=i[2],l=0;if(a.some((t=>0!==e[t]))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(c)c(n)}for(t&&t(i);l<a.length;l++)o=a[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},i=self.webpackChunklivekit_video_chat_frontend=self.webpackChunklivekit_video_chat_frontend||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";n(373);var e=n(43),t=n(391),i=n(579);const r=t=>{let{onJoinRoom:n}=t;const[r,o]=(0,e.useState)(""),[a,s]=(0,e.useState)(""),[c,l]=(0,e.useState)(!1),[u,d]=(0,e.useState)("");return(0,i.jsx)("div",{className:"join-form",children:(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),r&&a){l(!0),d("");try{console.log(`Requesting token for room: ${r}, participant: ${a}`);let e="/api/get-token";console.log(`Sending request to: ${e}`);const t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomName:r,participantName:a})}),i=await t.json();if(!t.ok)throw console.error("Error response from token API:",i),new Error(i.error||"Failed to get token");if(console.log("Token received successfully"),console.log("LiveKit URL:",i.url),!i.token||!i.url)throw console.error("Invalid response from token API:",i),new Error("Invalid token response from server");n({token:i.token,url:i.url,roomName:r,participantName:a})}catch(t){if(console.error("Error joining room:",t),"Failed to fetch"===t.message){d("Cannot connect to server. Make sure the backend is running."),console.log("Trying fallback to direct URL...");try{const e="http://localhost:5000/api/get-token";console.log(`Sending fallback request to: ${e}`);const t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomName:r,participantName:a})}),i=await t.json();if(!t.ok)throw new Error(i.error||"Failed to get token");return console.log("Token received from fallback request"),n({token:i.token,url:i.url,roomName:r,participantName:a}),void d("")}catch(i){console.error("Fallback request also failed:",i),d("Cannot connect to backend server. Please check that it is running at http://localhost:5000")}}else d(t.message||"Failed to join room")}finally{l(!1)}}else d("Room name and participant name are required")},children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"room-name",children:"Room Name"}),(0,i.jsx)("input",{id:"room-name",type:"text",placeholder:"Enter room name",value:r,onChange:e=>o(e.target.value),disabled:c,required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"participant-name",children:"Your Name"}),(0,i.jsx)("input",{id:"participant-name",type:"text",placeholder:"Enter your name",value:a,onChange:e=>s(e.target.value),disabled:c,required:!0})]}),u&&(0,i.jsx)("div",{className:"error",children:u}),(0,i.jsx)("button",{type:"submit",disabled:c||!r||!a,children:c?"Joining...":"Join Room"})]})})},o=t=>{const n=e.useRef(t);return e.useEffect((()=>{n.current=t})),n};function a(e,t){return t.forEach((function(t){t&&"string"!==typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}var s="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};function c(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var l,u={exports:{}};l=u,function(e,t){l.exports?l.exports=t():e.log=t()}(s,(function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function r(e,t){var n=e[t];if("function"===typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(i){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(t,n){for(var r=0;r<i.length;r++){var o=i[r];this[o]=r<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function s(e,n,i){return function(){typeof console!==t&&(a.call(this,n,i),this[e].apply(this,arguments))}}function c(i,a,c){return function(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?o:void 0!==console[i]?r(console,i):void 0!==console.log?r(console,"log"):e)}(i)||s.apply(this,arguments)}function l(e,n,r){var o,s=this;n=null==n?"WARN":n;var l="loglevel";function u(){var e;if(typeof window!==t&&l){try{e=window.localStorage[l]}catch(r){}if(typeof e===t)try{var n=window.document.cookie,i=n.indexOf(encodeURIComponent(l)+"=");-1!==i&&(e=/^([^;]+)/.exec(n.slice(i))[1])}catch(r){}return void 0===s.levels[e]&&(e=void 0),e}}"string"===typeof e?l+=":"+e:"symbol"===typeof e&&(l=void 0),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=r||c,s.getLevel=function(){return o},s.setLevel=function(n,r){if("string"===typeof n&&void 0!==s.levels[n.toUpperCase()]&&(n=s.levels[n.toUpperCase()]),!("number"===typeof n&&n>=0&&n<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==r&&function(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&l){try{return void(window.localStorage[l]=n)}catch(r){}try{window.document.cookie=encodeURIComponent(l)+"="+n+";"}catch(r){}}}(n),a.call(s,n,e),typeof console===t&&n<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){n=e,u()||s.setLevel(e,!1)},s.resetLevel=function(){s.setLevel(n,!1),function(){if(typeof window!==t&&l){try{return void window.localStorage.removeItem(l)}catch(e){}try{window.document.cookie=encodeURIComponent(l)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var d=u();null==d&&(d=n),s.setLevel(d,!1)}var u=new l,d={};u.getLogger=function(e){if("symbol"!==typeof e&&"string"!==typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new l(e,u.getLevel(),u.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return u.noConflict=function(){return typeof window!==t&&window.log===u&&(window.log=h),u},u.getLoggers=function(){return d},u.default=u,u}));var d,h,p=u.exports;!function(e){e[e.trace=0]="trace",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.silent=5]="silent"}(d||(d={})),function(e){e.Default="livekit",e.Room="livekit-room",e.Participant="livekit-participant",e.Track="livekit-track",e.Publication="livekit-track-publication",e.Engine="livekit-engine",e.Signal="livekit-signal",e.PCManager="livekit-pc-manager",e.PCTransport="livekit-pc-transport",e.E2EE="lk-e2ee"}(h||(h={}));let f=p.getLogger("livekit");function m(e){const t=p.getLogger(e);return t.setDefaultLevel(f.getLevel()),t}function g(e,t){if(!e)throw new Error(t)}f.setDefaultLevel(d.info),p.getLogger("lk-e2ee");function v(e){if("number"!==typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function y(e){if("number"!==typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function b(e){if("number"!==typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}const k=Symbol("@bufbuild/protobuf/enum-type");function S(e){const t=e[k];return g(t,"missing enum type on enum object"),t}function w(e,t,n,i){e[k]=C(t,n.map((t=>({no:t.no,name:t.name,localName:e[t.no]}))))}function C(e,t,n){const i=Object.create(null),r=Object.create(null),o=[];for(const a of t){const e=E(a);o.push(e),i[a.name]=e,r[a.no]=e}return{typeName:e,values:o,findName:e=>i[e],findNumber:e=>r[e]}}function T(e,t,n){const i={};for(const r of t){const e=E(r);i[e.localName]=e.no,i[e.no]=e.localName}return w(i,e,t),i}function E(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class P{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const n=this.getType().runtime.bin,i=n.makeReadOptions(t);return n.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,t){const n=this.getType(),i=n.runtime.json,r=i.makeReadOptions(t);return i.readMessage(n,e,r,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(n,t)}toBinary(e){const t=this.getType().runtime.bin,n=t.makeWriteOptions(e),i=n.writerFactory();return t.writeMessage(this,i,n),i.finish()}toJson(e){const t=this.getType().runtime.json,n=t.makeWriteOptions(e);return t.writeMessage(this,n)}toJsonString(e){var t;const n=this.toJson(e);return JSON.stringify(n,null,null!==(t=null===e||void 0===e?void 0:e.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}var x,R;function N(){let e=0,t=0;for(let i=0;i<28;i+=7){let n=this.buf[this.pos++];if(e|=(127&n)<<i,0==(128&n))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,0==(128&n))return this.assertBounds(),[e,t];for(let i=3;i<=31;i+=7){let n=this.buf[this.pos++];if(t|=(127&n)<<i,0==(128&n))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function O(e,t,n){for(let o=0;o<28;o+=7){const i=e>>>o,r=!(i>>>7==0&&0==t),a=255&(r?128|i:i);if(n.push(a),!r)return}const i=e>>>28&15|(7&t)<<4,r=!(t>>3==0);if(n.push(255&(r?128|i:i)),r){for(let e=3;e<31;e+=7){const i=t>>>e,r=!(i>>>7==0),o=255&(r?128|i:i);if(n.push(o),!r)return}n.push(t>>>31&1)}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(x||(x={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING"}(R||(R={}));const _=4294967296;function I(e){const t="-"===e[0];t&&(e=e.slice(1));const n=1e6;let i=0,r=0;function o(t,o){const a=Number(e.slice(t,o));r*=n,i=i*n+a,i>=_&&(r+=i/_|0,i%=_)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),t?L(i,r):M(i,r)}function D(e,t){if(({lo:e,hi:t}=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t)),t<=2097151)return String(_*t+e);const n=16777215&(e>>>24|t<<8),i=t>>16&65535;let r=(16777215&e)+6777216*n+6710656*i,o=n+8147497*i,a=2*i;const s=1e7;return r>=s&&(o+=Math.floor(r/s),r%=s),o>=s&&(a+=Math.floor(o/s),o%=s),a.toString()+A(o)+A(r)}function M(e,t){return{lo:0|e,hi:0|t}}function L(e,t){return t=~t,e?e=1+~e:t+=1,M(e,t)}const A=e=>{const t=String(e);return"0000000".slice(t.length)+t};function U(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function F(){let e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,0==(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let n=5;0!==(128&e)&&n<10;n++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}const j=function(){const e=new DataView(new ArrayBuffer(8));if("function"===typeof BigInt&&"function"===typeof e.getBigInt64&&"function"===typeof e.getBigUint64&&"function"===typeof e.setBigInt64&&"function"===typeof e.setBigUint64&&("object"!=typeof process||"1"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.BUF_BIGINT_DISABLE)){const t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),i=BigInt("0"),r=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){const i="bigint"==typeof e?e:BigInt(e);if(i>n||i<t)throw new Error("int64 invalid: ".concat(e));return i},uParse(e){const t="bigint"==typeof e?e:BigInt(e);if(t>r||t<i)throw new Error("uint64 invalid: ".concat(e));return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}const t=e=>g(/^-?[0-9]+$/.test(e),"int64 invalid: ".concat(e)),n=e=>g(/^[0-9]+$/.test(e),"uint64 invalid: ".concat(e));return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),t(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),n(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),t(e),I(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),n(e),I(e)),dec:(e,t)=>function(e,t){let n=M(e,t);const i=2147483648&n.hi;i&&(n=L(n.lo,n.hi));const r=D(n.lo,n.hi);return i?"-"+r:r}(e,t),uDec:(e,t)=>D(e,t)}}();var B;!function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(B||(B={}));class V{constructor(e){this.stack=[],this.textEncoder=null!==e&&void 0!==e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let t=new Uint8Array(e),n=0;for(let i=0;i<this.chunks.length;i++)t.set(this.chunks[i],n),n+=this.chunks[i].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(y(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return v(e),U(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){b(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){y(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){v(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return v(e),U(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=j.enc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=j.uEnc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=j.enc(e);return O(t.lo,t.hi,this.buf),this}sint64(e){let t=j.enc(e),n=t.hi>>31;return O(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=j.uEnc(e);return O(t.lo,t.hi,this.buf),this}}class z{constructor(e,t){this.varint64=N,this.uint32=F,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!==t&&void 0!==t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e){let t=this.pos;switch(e){case B.Varint:for(;128&this.buf[this.pos++];);break;case B.Bit64:this.pos+=4;case B.Bit32:this.pos+=4;break;case B.LengthDelimited:let t=this.uint32();this.pos+=t;break;case B.StartGroup:let n;for(;(n=this.tag()[1])!==B.EndGroup;)this.skip(n);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return j.dec(...this.varint64())}uint64(){return j.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,j.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return j.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return j.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function J(e,t){return t instanceof P||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}function q(e,t,n){if(t===n)return!0;if(e==x.BYTES){if(!(t instanceof Uint8Array)||!(n instanceof Uint8Array))return!1;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}switch(e){case x.UINT64:case x.FIXED64:case x.INT64:case x.SFIXED64:case x.SINT64:return t==n}return!1}function W(e,t){switch(e){case x.BOOL:return!1;case x.UINT64:case x.FIXED64:case x.INT64:case x.SFIXED64:case x.SINT64:return 0==t?j.zero:"0";case x.DOUBLE:case x.FLOAT:return 0;case x.BYTES:return new Uint8Array(0);case x.STRING:return"";default:return 0}}function H(e,t){const n=void 0===t;let i=B.Varint,r=0===t;switch(e){case x.STRING:r=n||!t.length,i=B.LengthDelimited;break;case x.BOOL:r=!1===t;break;case x.DOUBLE:i=B.Bit64;break;case x.FLOAT:i=B.Bit32;break;case x.INT64:case x.UINT64:r=n||0==t;break;case x.FIXED64:r=n||0==t,i=B.Bit64;break;case x.BYTES:r=n||!t.byteLength,i=B.LengthDelimited;break;case x.FIXED32:case x.SFIXED32:i=B.Bit32;break;case x.SFIXED64:r=n||0==t,i=B.Bit64;break;case x.SINT64:r=n||0==t}return[i,x[e].toLowerCase(),n||r]}x.DOUBLE,x.FLOAT,x.INT64,x.UINT64,x.INT32,x.UINT32,x.BOOL,x.STRING,x.BYTES;const K=Symbol("@bufbuild/protobuf/unknown-fields"),G={readUnknownFields:!0,readerFactory:e=>new z(e)},Q={writeUnknownFields:!0,writerFactory:()=>new V};function $(e){return e?Object.assign(Object.assign({},G),e):G}function Y(e){return e?Object.assign(Object.assign({},Q),e):Q}function X(e,t,n){return t.getType().runtime.bin.readMessage(t,e,e.uint32(),n),t}function Z(e,t,n){const i=t.uint32(),r=t.pos+i;let o,a;for(;t.pos<r;){let[i]=t.tag();switch(i){case 1:o=te(t,e.K);break;case 2:switch(e.V.kind){case"scalar":a=te(t,e.V.T);break;case"enum":a=t.int32();break;case"message":a=X(t,new e.V.T,n)}}}if(void 0===o){let t=W(e.K,R.BIGINT);o=e.K==x.BOOL?t.toString():t}if("string"!=typeof o&&"number"!=typeof o&&(o=o.toString()),void 0===a)switch(e.V.kind){case"scalar":a=W(e.V.T,R.BIGINT);break;case"enum":a=0;break;case"message":a=new e.V.T}return[o,a]}function ee(e,t){const n=te(e,t);return"bigint"==typeof n?n.toString():n}function te(e,t){switch(t){case x.STRING:return e.string();case x.BOOL:return e.bool();case x.DOUBLE:return e.double();case x.FLOAT:return e.float();case x.INT32:return e.int32();case x.INT64:return e.int64();case x.UINT64:return e.uint64();case x.FIXED64:return e.fixed64();case x.BYTES:return e.bytes();case x.FIXED32:return e.fixed32();case x.SFIXED32:return e.sfixed32();case x.SFIXED64:return e.sfixed64();case x.SINT64:return e.sint64();case x.UINT32:return e.uint32();case x.SINT32:return e.sint32()}}function ne(e,t,n,i,r){e.tag(n.no,B.LengthDelimited),e.fork();let o=i;switch(n.K){case x.INT32:case x.FIXED32:case x.UINT32:case x.SFIXED32:case x.SINT32:o=Number.parseInt(i);break;case x.BOOL:g("true"==i||"false"==i),o="true"==i}switch(re(e,n.K,1,o,!0),n.V.kind){case"scalar":re(e,n.V.T,2,r,!0);break;case"enum":re(e,x.INT32,2,r,!0);break;case"message":ie(e,t,n.V.T,2,r)}e.join()}function ie(e,t,n,i,r){if(void 0!==r){const o=J(n,r);e.tag(i,B.LengthDelimited).bytes(o.toBinary(t))}}function re(e,t,n,i,r){let[o,a,s]=H(t,i);s&&!r||e.tag(n,o)[a](i)}function oe(e,t,n,i){if(!i.length)return;e.tag(n,B.LengthDelimited).fork();let[,r]=H(t);for(let o=0;o<i.length;o++)e[r](i[o]);e.join()}let ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),se=[];for(let n=0;n<ae.length;n++)se[ae[n].charCodeAt(0)]=n;se["-".charCodeAt(0)]=ae.indexOf("+"),se["_".charCodeAt(0)]=ae.indexOf("/");const ce={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n,i=new Uint8Array(t),r=0,o=0,a=0;for(let s=0;s<e.length;s++){if(n=se[e.charCodeAt(s)],void 0===n)switch(e[s]){case"=":o=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:a=n,o=1;break;case 1:i[r++]=a<<2|(48&n)>>4,a=n,o=2;break;case 2:i[r++]=(15&a)<<4|(60&n)>>2,a=n,o=3;break;case 3:i[r++]=(3&a)<<6|n,o=0}}if(1==o)throw Error("invalid base64 string.");return i.subarray(0,r)},enc(e){let t,n="",i=0,r=0;for(let o=0;o<e.length;o++)switch(t=e[o],i){case 0:n+=ae[t>>2],r=(3&t)<<4,i=1;break;case 1:n+=ae[r|t>>4],r=(15&t)<<2,i=2;break;case 2:n+=ae[r|t>>6],n+=ae[63&t],i=0}return i&&(n+=ae[r],n+="=",1==i&&(n+="=")),n}},le={ignoreUnknownFields:!1},ue={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function de(e){return e?Object.assign(Object.assign({},le),e):le}function he(e){return e?Object.assign(Object.assign({},ue),e):ue}function pe(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":'"'.concat(e.split('"').join('\\"'),'"');default:return String(e)}}function fe(e,t,n){switch(e){case x.DOUBLE:case x.FLOAT:if(null===t)return 0;if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t)break;if("string"==typeof t&&t.trim().length!==t.length)break;if("string"!=typeof t&&"number"!=typeof t)break;const r=Number(t);if(Number.isNaN(r))break;if(!Number.isFinite(r))break;return e==x.FLOAT&&b(r),r;case x.INT32:case x.FIXED32:case x.SFIXED32:case x.SINT32:case x.UINT32:if(null===t)return 0;let o;if("number"==typeof t?o=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(o=Number(t)),void 0===o)break;return e==x.UINT32?y(o):v(o),o;case x.INT64:case x.SFIXED64:case x.SINT64:if(null===t)return j.zero;if("number"!=typeof t&&"string"!=typeof t)break;const a=j.parse(t);return n?a.toString():a;case x.FIXED64:case x.UINT64:if(null===t)return j.zero;if("number"!=typeof t&&"string"!=typeof t)break;const s=j.uParse(t);return n?s.toString():s;case x.BOOL:if(null===t)return!1;if("boolean"!==typeof t)break;return t;case x.STRING:if(null===t)return"";if("string"!==typeof t)break;try{encodeURIComponent(t)}catch(i){throw new Error("invalid UTF8")}return t;case x.BYTES:if(null===t||""===t)return new Uint8Array(0);if("string"!==typeof t)break;return ce.dec(t)}throw new Error}function me(e,t,n){if(null===t)return 0;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const i=e.findName(t);if(i||n)return null===i||void 0===i?void 0:i.no}throw new Error("cannot decode enum ".concat(e.typeName," from JSON: ").concat(pe(t)))}function ge(e,t,n,i){var r;if(void 0===t)return t;if(0===t&&!n)return;if(i)return t;if("google.protobuf.NullValue"==e.typeName)return null;const o=e.findNumber(t);return null!==(r=null===o||void 0===o?void 0:o.name)&&void 0!==r?r:t}function ve(e,t,n){if(void 0!==t)switch(e){case x.INT32:case x.SFIXED32:case x.SINT32:case x.FIXED32:case x.UINT32:return g("number"==typeof t),0!=t||n?t:void 0;case x.FLOAT:case x.DOUBLE:return g("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":0!==t||n?t:void 0;case x.STRING:return g("string"==typeof t),t.length>0||n?t:void 0;case x.BOOL:return g("boolean"==typeof t),t||n?t:void 0;case x.UINT64:case x.FIXED64:case x.INT64:case x.SFIXED64:case x.SINT64:return g("bigint"==typeof t||"string"==typeof t||"number"==typeof t),n||0!=t?t.toString(10):void 0;case x.BYTES:return g(t instanceof Uint8Array),n||t.byteLength>0?ce.enc(t):void 0}}function ye(e){if(void 0===e)return e;if(e instanceof P)return e.clone();if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function be(e){return e instanceof Uint8Array?e:new Uint8Array(e)}class ke{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const e={};for(const t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){const e={};for(const t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort(((e,t)=>e.no-t.no))),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const n of this.list())n.oneof?n.oneof!==t&&(t=n.oneof,e.push(t)):e.push(n)}return this.members}}function Se(e,t){const n=Ce(e);return t?n:Re(xe(n))}const we=Ce;function Ce(e){let t=!1;const n=[];for(let i=0;i<e.length;i++){let r=e.charAt(i);switch(r){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(r),t=!1;break;default:t&&(t=!1,r=r.toUpperCase()),n.push(r)}}return n.join("")}const Te=new Set(["constructor","toString","toJSON","valueOf"]),Ee=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Pe=e=>"".concat(e,"$"),xe=e=>Ee.has(e)?Pe(e):e,Re=e=>Te.has(e)?Pe(e):e;class Ne{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=Se(e,!1)}addField(e){g(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}}const Oe=(_e="proto3",Ie=function(e){const t=e(ge,ve);return{makeReadOptions:de,makeWriteOptions:he,readMessage(e,t,n,i){if(null==t||Array.isArray(t)||"object"!=typeof t)throw new Error("cannot decode message ".concat(e.typeName," from JSON: ").concat(this.debug(t)));i=null!==i&&void 0!==i?i:new e;const r={};for(const[a,s]of Object.entries(t)){const t=e.fields.findJsonName(a);if(!t){if(!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let c=t.localName,l=i;if(t.oneof){if(null===s&&"scalar"==t.kind)continue;const n=r[t.oneof.localName];if(n)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: multiple keys for oneof "').concat(t.oneof.name,'" present: "').concat(n,'", "').concat(a,'"'));r[t.oneof.localName]=a,l=l[t.oneof.localName]={case:c},c="value"}if(t.repeated){if(null===s)continue;if(!Array.isArray(s))throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(s)));const i=l[c];for(const r of s){if(null===r)throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(r)));let a;switch(t.kind){case"message":a=t.T.fromJson(r,n);break;case"enum":if(a=me(t.T,r,n.ignoreUnknownFields),void 0===a)continue;break;case"scalar":try{a=fe(t.T,r,t.L)}catch(o){let n="cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(r));throw o instanceof Error&&o.message.length>0&&(n+=": ".concat(o.message)),new Error(n)}}i.push(a)}}else if("map"==t.kind){if(null===s)continue;if(Array.isArray(s)||"object"!=typeof s)throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(s)));const i=l[c];for(const[r,a]of Object.entries(s)){if(null===a)throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: map value null"));let c;switch(t.V.kind){case"message":c=t.V.T.fromJson(a,n);break;case"enum":if(c=me(t.V.T,a,n.ignoreUnknownFields),void 0===c)continue;break;case"scalar":try{c=fe(t.V.T,a,R.BIGINT)}catch(o){let n="cannot decode map value for field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(s));throw o instanceof Error&&o.message.length>0&&(n+=": ".concat(o.message)),new Error(n)}}try{i[fe(t.K,t.K==x.BOOL?"true"==r||"false"!=r&&r:r,R.BIGINT).toString()]=c}catch(o){let n="cannot decode map key for field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(s));throw o instanceof Error&&o.message.length>0&&(n+=": ".concat(o.message)),new Error(n)}}}else switch(t.kind){case"message":const i=t.T;if(null===s&&"google.protobuf.Value"!=i.typeName){if(t.oneof)throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}l[c]instanceof P?l[c].fromJson(s,n):(l[c]=i.fromJson(s,n),i.fieldWrapper&&!t.oneof&&(l[c]=i.fieldWrapper.unwrapField(l[c])));break;case"enum":const r=me(t.T,s,n.ignoreUnknownFields);void 0!==r&&(l[c]=r);break;case"scalar":try{l[c]=fe(t.T,s,t.L)}catch(o){let n="cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(s));throw o instanceof Error&&o.message.length>0&&(n+=": ".concat(o.message)),new Error(n)}}}return i},writeMessage(e,n){const i=e.getType(),r={};let o;try{for(const a of i.fields.byMember()){let i;if("oneof"==a.kind){const r=e[a.localName];if(void 0===r.value)continue;if(o=a.findField(r.case),!o)throw"oneof case not found: "+r.case;i=t(o,r.value,n)}else o=a,i=t(o,e[o.localName],n);void 0!==i&&(r[n.useProtoFieldName?o.name:o.jsonName]=i)}}catch(a){const e=o?"cannot encode field ".concat(i.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),t=a instanceof Error?a.message:String(a);throw new Error(e+(t.length>0?": ".concat(t):""))}return r},readScalar:fe,writeScalar:ve,debug:pe}}(((e,t)=>function(n,i,r){if("map"==n.kind){const o={};switch(n.V.kind){case"scalar":for(const[e,r]of Object.entries(i)){const i=t(n.V.T,r,!0);g(void 0!==i),o[e.toString()]=i}break;case"message":for(const[e,t]of Object.entries(i))o[e.toString()]=t.toJson(r);break;case"enum":const a=n.V.T;for(const[t,n]of Object.entries(i)){g(void 0===n||"number"==typeof n);const i=e(a,n,!0,r.enumAsInteger);g(void 0!==i),o[t.toString()]=i}}return r.emitDefaultValues||Object.keys(o).length>0?o:void 0}if(n.repeated){const o=[];switch(n.kind){case"scalar":for(let e=0;e<i.length;e++)o.push(t(n.T,i[e],!0));break;case"enum":for(let t=0;t<i.length;t++)o.push(e(n.T,i[t],!0,r.enumAsInteger));break;case"message":for(let e=0;e<i.length;e++)o.push(J(n.T,i[e]).toJson(r))}return r.emitDefaultValues||o.length>0?o:void 0}switch(n.kind){case"scalar":return t(n.T,i,!!n.oneof||n.opt||r.emitDefaultValues);case"enum":return e(n.T,i,!!n.oneof||n.opt||r.emitDefaultValues,r.enumAsInteger);case"message":return void 0!==i?J(n.T,i).toJson(r):void 0}})),De=Object.assign(Object.assign({},{makeReadOptions:$,makeWriteOptions:Y,listUnknownFields(e){var t;return null!==(t=e[K])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[K]},writeUnknownFields(e,t){const n=e[K];if(n)for(const i of n)t.tag(i.no,i.wireType).raw(i.data)},onUnknownField(e,t,n,i){const r=e;Array.isArray(r[K])||(r[K]=[]),r[K].push({no:t,wireType:n,data:i})},readMessage(e,t,n,i){const r=e.getType(),o=void 0===n?t.len:t.pos+n;for(;t.pos<o;){const[n,o]=t.tag(),a=r.fields.find(n);if(!a){const r=t.skip(o);i.readUnknownFields&&this.onUnknownField(e,n,o,r);continue}let s=e,c=a.repeated,l=a.localName;switch(a.oneof&&(s=s[a.oneof.localName],s.case!=l&&delete s.value,s.case=l,l="value"),a.kind){case"scalar":case"enum":const e="enum"==a.kind?x.INT32:a.T;let n=te;if("scalar"==a.kind&&a.L>0&&(n=ee),c){let i=s[l];if(o==B.LengthDelimited&&e!=x.STRING&&e!=x.BYTES){let r=t.uint32()+t.pos;for(;t.pos<r;)i.push(n(t,e))}else i.push(n(t,e))}else s[l]=n(t,e);break;case"message":const r=a.T;c?s[l].push(X(t,new r,i)):s[l]instanceof P?X(t,s[l],i):(s[l]=X(t,new r,i),!r.fieldWrapper||a.oneof||a.repeated||(s[l]=r.fieldWrapper.unwrapField(s[l])));break;case"map":let[u,d]=Z(a,t,i);s[l][u]=d}}}}),{writeMessage(e,t,n){const i=e.getType();for(const r of i.fields.byNumber()){let i,o=r.repeated,a=r.localName;if(r.oneof){const t=e[r.oneof.localName];if(t.case!==a)continue;i=t.value}else i=e[a];switch(r.kind){case"scalar":case"enum":let e="enum"==r.kind?x.INT32:r.T;if(o)if(r.packed)oe(t,e,r.no,i);else for(const n of i)re(t,e,r.no,n,!0);else void 0!==i&&re(t,e,r.no,i,!!r.oneof||r.opt);break;case"message":if(o)for(const o of i)ie(t,n,r.T,r.no,o);else ie(t,n,r.T,r.no,i);break;case"map":for(const[o,a]of Object.entries(i))ne(t,n,r,o,a)}}return n.writeUnknownFields&&this.writeUnknownFields(e,t),t}}),Me=Object.assign(Object.assign({},{setEnumType:w,initPartial(e,t){if(void 0===e)return;const n=t.getType();for(const i of n.fields.byMember()){const n=i.localName,r=t,o=e;if(void 0!==o[n])switch(i.kind){case"oneof":const e=o[n].case;if(void 0===e)continue;const t=i.findField(e);let a=o[n].value;!t||"message"!=t.kind||a instanceof t.T?t&&"scalar"===t.kind&&t.T===x.BYTES&&(a=be(a)):a=new t.T(a),r[n]={case:e,value:a};break;case"scalar":case"enum":let s=o[n];i.T===x.BYTES&&(s=i.repeated?s.map(be):be(s)),r[n]=s;break;case"map":switch(i.V.kind){case"scalar":case"enum":if(i.V.T===x.BYTES)for(const[t,i]of Object.entries(o[n]))r[n][t]=be(i);else Object.assign(r[n],o[n]);break;case"message":const e=i.V.T;for(const t of Object.keys(o[n])){let i=o[n][t];e.fieldWrapper||(i=new e(i)),r[n][t]=i}}break;case"message":const c=i.T;if(i.repeated)r[n]=o[n].map((e=>e instanceof c?e:new c(e)));else if(void 0!==o[n]){const e=o[n];c.fieldWrapper?"google.protobuf.BytesValue"===c.typeName?r[n]=be(e):r[n]=e:r[n]=e instanceof c?e:new c(e)}}}},equals:(e,t,n)=>t===n||!(!t||!n)&&e.fields.byMember().every((e=>{const i=t[e.localName],r=n[e.localName];if(e.repeated){if(i.length!==r.length)return!1;switch(e.kind){case"message":return i.every(((t,n)=>e.T.equals(t,r[n])));case"scalar":return i.every(((t,n)=>q(e.T,t,r[n])));case"enum":return i.every(((e,t)=>q(x.INT32,e,r[t])))}throw new Error("repeated cannot contain ".concat(e.kind))}switch(e.kind){case"message":return e.T.equals(i,r);case"enum":return q(x.INT32,i,r);case"scalar":return q(e.T,i,r);case"oneof":if(i.case!==r.case)return!1;const t=e.findField(i.case);if(void 0===t)return!0;switch(t.kind){case"message":return t.T.equals(i.value,r.value);case"enum":return q(x.INT32,i.value,r.value);case"scalar":return q(t.T,i.value,r.value)}throw new Error("oneof cannot contain ".concat(t.kind));case"map":const n=Object.keys(i).concat(Object.keys(r));switch(e.V.kind){case"message":const t=e.V.T;return n.every((e=>t.equals(i[e],r[e])));case"enum":return n.every((e=>q(x.INT32,i[e],r[e])));case"scalar":const o=e.V.T;return n.every((e=>q(o,i[e],r[e])))}}})),clone(e){const t=e.getType(),n=new t,i=n;for(const r of t.fields.byMember()){const t=e[r.localName];let n;if(r.repeated)n=t.map(ye);else if("map"==r.kind){n=i[r.localName];for(const[e,i]of Object.entries(t))n[e]=ye(i)}else n="oneof"==r.kind?r.findField(t.case)?{case:t.case,value:ye(t.value)}:{case:void 0}:ye(t);i[r.localName]=n}return n}}),{newFieldList:e=>new ke(e,He),initFields(e){for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,i=e;if(t.repeated)i[n]=[];else switch(t.kind){case"oneof":i[n]={case:void 0};break;case"enum":i[n]=0;break;case"map":i[n]={};break;case"scalar":i[n]=W(t.T,t.L)}}}}),{syntax:_e,json:Ie,bin:De,util:Me,makeMessageType(e,t,n){return function(e,t,n,i){var r;const o=null!==(r=null===i||void 0===i?void 0:i.localName)&&void 0!==r?r:t.substring(t.lastIndexOf(".")+1),a={[o]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[o];return Object.setPrototypeOf(a.prototype,new P),Object.assign(a,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary:(e,t)=>(new a).fromBinary(e,t),fromJson:(e,t)=>(new a).fromJson(e,t),fromJsonString:(e,t)=>(new a).fromJsonString(e,t),equals:(t,n)=>e.util.equals(a,t,n)}),a}(this,e,t,n)},makeEnum:T,makeEnumType:C,getEnumType:S});var _e,Ie,De,Me,Le,Ae,Ue,Fe,je,Be,Ve,ze,Je,qe,We;function He(e){var t,n,i,r;const o=[];let a;for(const s of"function"==typeof e?e():e){const e=s;if(e.localName=Se(s.name,void 0!==s.oneof),e.jsonName=null!==(t=s.jsonName)&&void 0!==t?t:we(s.name),e.repeated=null!==(n=s.repeated)&&void 0!==n&&n,"scalar"==s.kind&&(e.L=null!==(i=s.L)&&void 0!==i?i:R.BIGINT),e.packed=null!==(r=s.packed)&&void 0!==r?r:"enum"==s.kind||"scalar"==s.kind&&s.T!=x.BYTES&&s.T!=x.STRING,void 0!==s.oneof){const t="string"==typeof s.oneof?s.oneof:s.oneof.name;a&&a.name==t||(a=new Ne(t)),e.oneof=a,a.addField(e)}o.push(e)}return o}class Ke extends P{constructor(e){super(),this.seconds=j.zero,this.nanos=0,Oe.util.initPartial(e,this)}fromJson(e,t){if("string"!==typeof e)throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(Oe.json.debug(e)));const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=j.parse(i/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(e){const t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const e=(this.nanos+1e9).toString().substring(1);n="000000"===e.substring(3)?"."+e.substring(0,3)+"Z":"000"===e.substring(6)?"."+e.substring(0,6)+"Z":"."+e+"Z"}return new Date(t).toISOString().replace(".000Z",n)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return Ke.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new Ke({seconds:j.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return(new Ke).fromBinary(e,t)}static fromJson(e,t){return(new Ke).fromJson(e,t)}static fromJsonString(e,t){return(new Ke).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Ke,e,t)}}Ke.runtime=Oe,Ke.typeName="google.protobuf.Timestamp",Ke.fields=Oe.util.newFieldList((()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}])),function(e){e[e.DEFAULT_AC=0]="DEFAULT_AC",e[e.OPUS=1]="OPUS",e[e.AAC=2]="AAC"}(Le||(Le={})),Oe.util.setEnumType(Le,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]),function(e){e[e.DEFAULT_VC=0]="DEFAULT_VC",e[e.H264_BASELINE=1]="H264_BASELINE",e[e.H264_MAIN=2]="H264_MAIN",e[e.H264_HIGH=3]="H264_HIGH",e[e.VP8=4]="VP8"}(Ae||(Ae={})),Oe.util.setEnumType(Ae,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]),function(e){e[e.IC_DEFAULT=0]="IC_DEFAULT",e[e.IC_JPEG=1]="IC_JPEG"}(Ue||(Ue={})),Oe.util.setEnumType(Ue,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]),function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO",e[e.DATA=2]="DATA"}(Fe||(Fe={})),Oe.util.setEnumType(Fe,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CAMERA=1]="CAMERA",e[e.MICROPHONE=2]="MICROPHONE",e[e.SCREEN_SHARE=3]="SCREEN_SHARE",e[e.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"}(je||(je={})),Oe.util.setEnumType(je,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e[e.OFF=3]="OFF"}(Be||(Be={})),Oe.util.setEnumType(Be,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),function(e){e[e.POOR=0]="POOR",e[e.GOOD=1]="GOOD",e[e.EXCELLENT=2]="EXCELLENT",e[e.LOST=3]="LOST"}(Ve||(Ve={})),Oe.util.setEnumType(Ve,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),function(e){e[e.UNSET=0]="UNSET",e[e.DISABLED=1]="DISABLED",e[e.ENABLED=2]="ENABLED"}(ze||(ze={})),Oe.util.setEnumType(ze,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),function(e){e[e.UNKNOWN_REASON=0]="UNKNOWN_REASON",e[e.CLIENT_INITIATED=1]="CLIENT_INITIATED",e[e.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",e[e.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",e[e.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",e[e.ROOM_DELETED=5]="ROOM_DELETED",e[e.STATE_MISMATCH=6]="STATE_MISMATCH",e[e.JOIN_FAILURE=7]="JOIN_FAILURE"}(Je||(Je={})),Oe.util.setEnumType(Je,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]),function(e){e[e.RR_UNKNOWN=0]="RR_UNKNOWN",e[e.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",e[e.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",e[e.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",e[e.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"}(qe||(qe={})),Oe.util.setEnumType(qe,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),function(e){e[e.SE_UNKNOWN=0]="SE_UNKNOWN",e[e.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",e[e.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"}(We||(We={})),Oe.util.setEnumType(We,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let Ge=class e extends P{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=j.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,Oe.util.initPartial(e,this)}static fromBinary(t,n){return(new e).fromBinary(t,n)}static fromJson(t,n){return(new e).fromJson(t,n)}static fromJsonString(t,n){return(new e).fromJsonString(t,n)}static equals(t,n){return Oe.util.equals(e,t,n)}};Ge.runtime=Oe,Ge.typeName="livekit.Room",Ge.fields=Oe.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Qe,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]));class Qe extends P{constructor(e){super(),this.mime="",this.fmtpLine="",Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Qe).fromBinary(e,t)}static fromJson(e,t){return(new Qe).fromJson(e,t)}static fromJsonString(e,t){return(new Qe).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Qe,e,t)}}Qe.runtime=Oe,Qe.typeName="livekit.Codec",Qe.fields=Oe.util.newFieldList((()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]));class $e extends P{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new $e).fromBinary(e,t)}static fromJson(e,t){return(new $e).fromJson(e,t)}static fromJsonString(e,t){return(new $e).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals($e,e,t)}}$e.runtime=Oe,$e.typeName="livekit.PlayoutDelay",$e.fields=Oe.util.newFieldList((()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]));class Ye extends P{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Ye).fromBinary(e,t)}static fromJson(e,t){return(new Ye).fromJson(e,t)}static fromJsonString(e,t){return(new Ye).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Ye,e,t)}}Ye.runtime=Oe,Ye.typeName="livekit.ParticipantPermission",Ye.fields=Oe.util.newFieldList((()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:Oe.getEnumType(je),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]));class Xe extends P{constructor(e){super(),this.sid="",this.identity="",this.state=Ze.JOINING,this.tracks=[],this.metadata="",this.joinedAt=j.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Xe).fromBinary(e,t)}static fromJson(e,t){return(new Xe).fromJson(e,t)}static fromJsonString(e,t){return(new Xe).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Xe,e,t)}}var Ze,et,tt,nt,it;Xe.runtime=Oe,Xe.typeName="livekit.ParticipantInfo",Xe.fields=Oe.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:Oe.getEnumType(Ze)},{no:4,name:"tracks",kind:"message",T:at,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:Ye},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}])),function(e){e[e.JOINING=0]="JOINING",e[e.JOINED=1]="JOINED",e[e.ACTIVE=2]="ACTIVE",e[e.DISCONNECTED=3]="DISCONNECTED"}(Ze||(Ze={})),Oe.util.setEnumType(Ze,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class rt extends P{constructor(e){super(),Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new rt).fromBinary(e,t)}static fromJson(e,t){return(new rt).fromJson(e,t)}static fromJsonString(e,t){return(new rt).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(rt,e,t)}}rt.runtime=Oe,rt.typeName="livekit.Encryption",rt.fields=Oe.util.newFieldList((()=>[])),function(e){e[e.NONE=0]="NONE",e[e.GCM=1]="GCM",e[e.CUSTOM=2]="CUSTOM"}(et||(et={})),Oe.util.setEnumType(et,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class ot extends P{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new ot).fromBinary(e,t)}static fromJson(e,t){return(new ot).fromJson(e,t)}static fromJsonString(e,t){return(new ot).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(ot,e,t)}}ot.runtime=Oe,ot.typeName="livekit.SimulcastCodecInfo",ot.fields=Oe.util.newFieldList((()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:st,repeated:!0}]));class at extends P{constructor(e){super(),this.sid="",this.type=Fe.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=je.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=et.NONE,this.stream="",Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new at).fromBinary(e,t)}static fromJson(e,t){return(new at).fromJson(e,t)}static fromJsonString(e,t){return(new at).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(at,e,t)}}at.runtime=Oe,at.typeName="livekit.TrackInfo",at.fields=Oe.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:Oe.getEnumType(Fe)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:Oe.getEnumType(je)},{no:10,name:"layers",kind:"message",T:st,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:ot,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:Oe.getEnumType(et)},{no:17,name:"stream",kind:"scalar",T:9}]));class st extends P{constructor(e){super(),this.quality=Be.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new st).fromBinary(e,t)}static fromJson(e,t){return(new st).fromJson(e,t)}static fromJsonString(e,t){return(new st).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(st,e,t)}}st.runtime=Oe,st.typeName="livekit.VideoLayer",st.fields=Oe.util.newFieldList((()=>[{no:1,name:"quality",kind:"enum",T:Oe.getEnumType(Be)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]));class ct extends P{constructor(e){super(),this.kind=tt.RELIABLE,this.value={case:void 0},Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new ct).fromBinary(e,t)}static fromJson(e,t){return(new ct).fromJson(e,t)}static fromJsonString(e,t){return(new ct).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(ct,e,t)}}ct.runtime=Oe,ct.typeName="livekit.DataPacket",ct.fields=Oe.util.newFieldList((()=>[{no:1,name:"kind",kind:"enum",T:Oe.getEnumType(tt)},{no:2,name:"user",kind:"message",T:dt,oneof:"value"},{no:3,name:"speaker",kind:"message",T:lt,oneof:"value"}])),function(e){e[e.RELIABLE=0]="RELIABLE",e[e.LOSSY=1]="LOSSY"}(tt||(tt={})),Oe.util.setEnumType(tt,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class lt extends P{constructor(e){super(),this.speakers=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new lt).fromBinary(e,t)}static fromJson(e,t){return(new lt).fromJson(e,t)}static fromJsonString(e,t){return(new lt).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(lt,e,t)}}lt.runtime=Oe,lt.typeName="livekit.ActiveSpeakerUpdate",lt.fields=Oe.util.newFieldList((()=>[{no:1,name:"speakers",kind:"message",T:ut,repeated:!0}]));class ut extends P{constructor(e){super(),this.sid="",this.level=0,this.active=!1,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new ut).fromBinary(e,t)}static fromJson(e,t){return(new ut).fromJson(e,t)}static fromJsonString(e,t){return(new ut).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(ut,e,t)}}ut.runtime=Oe,ut.typeName="livekit.SpeakerInfo",ut.fields=Oe.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]));class dt extends P{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new dt).fromBinary(e,t)}static fromJson(e,t){return(new dt).fromJson(e,t)}static fromJsonString(e,t){return(new dt).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(dt,e,t)}}dt.runtime=Oe,dt.typeName="livekit.UserPacket",dt.fields=Oe.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]));class ht extends P{constructor(e){super(),this.participantSid="",this.trackSids=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new ht).fromBinary(e,t)}static fromJson(e,t){return(new ht).fromJson(e,t)}static fromJsonString(e,t){return(new ht).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(ht,e,t)}}ht.runtime=Oe,ht.typeName="livekit.ParticipantTracks",ht.fields=Oe.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]));class pt extends P{constructor(e){super(),this.edition=nt.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new pt).fromBinary(e,t)}static fromJson(e,t){return(new pt).fromJson(e,t)}static fromJsonString(e,t){return(new pt).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(pt,e,t)}}pt.runtime=Oe,pt.typeName="livekit.ServerInfo",pt.fields=Oe.util.newFieldList((()=>[{no:1,name:"edition",kind:"enum",T:Oe.getEnumType(nt)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}])),function(e){e[e.Standard=0]="Standard",e[e.Cloud=1]="Cloud"}(nt||(nt={})),Oe.util.setEnumType(nt,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class ft extends P{constructor(e){super(),this.sdk=it.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new ft).fromBinary(e,t)}static fromJson(e,t){return(new ft).fromJson(e,t)}static fromJsonString(e,t){return(new ft).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(ft,e,t)}}ft.runtime=Oe,ft.typeName="livekit.ClientInfo",ft.fields=Oe.util.newFieldList((()=>[{no:1,name:"sdk",kind:"enum",T:Oe.getEnumType(it)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}])),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JS=1]="JS",e[e.SWIFT=2]="SWIFT",e[e.ANDROID=3]="ANDROID",e[e.FLUTTER=4]="FLUTTER",e[e.GO=5]="GO",e[e.UNITY=6]="UNITY",e[e.REACT_NATIVE=7]="REACT_NATIVE",e[e.RUST=8]="RUST",e[e.PYTHON=9]="PYTHON",e[e.CPP=10]="CPP"}(it||(it={})),Oe.util.setEnumType(it,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class mt extends P{constructor(e){super(),this.resumeConnection=ze.UNSET,this.forceRelay=ze.UNSET,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new mt).fromBinary(e,t)}static fromJson(e,t){return(new mt).fromJson(e,t)}static fromJsonString(e,t){return(new mt).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(mt,e,t)}}mt.runtime=Oe,mt.typeName="livekit.ClientConfiguration",mt.fields=Oe.util.newFieldList((()=>[{no:1,name:"video",kind:"message",T:gt},{no:2,name:"screen",kind:"message",T:gt},{no:3,name:"resume_connection",kind:"enum",T:Oe.getEnumType(ze)},{no:4,name:"disabled_codecs",kind:"message",T:vt},{no:5,name:"force_relay",kind:"enum",T:Oe.getEnumType(ze)}]));class gt extends P{constructor(e){super(),this.hardwareEncoder=ze.UNSET,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new gt).fromBinary(e,t)}static fromJson(e,t){return(new gt).fromJson(e,t)}static fromJsonString(e,t){return(new gt).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(gt,e,t)}}gt.runtime=Oe,gt.typeName="livekit.VideoConfiguration",gt.fields=Oe.util.newFieldList((()=>[{no:1,name:"hardware_encoder",kind:"enum",T:Oe.getEnumType(ze)}]));class vt extends P{constructor(e){super(),this.codecs=[],this.publish=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new vt).fromBinary(e,t)}static fromJson(e,t){return(new vt).fromJson(e,t)}static fromJsonString(e,t){return(new vt).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(vt,e,t)}}vt.runtime=Oe,vt.typeName="livekit.DisabledCodecs",vt.fields=Oe.util.newFieldList((()=>[{no:1,name:"codecs",kind:"message",T:Qe,repeated:!0},{no:2,name:"publish",kind:"message",T:Qe,repeated:!0}]));class yt extends P{constructor(e){super(),this.duration=0,this.startTimestamp=j.zero,this.endTimestamp=j.zero,this.rtpClockTicks=j.zero,this.driftSamples=j.zero,this.driftMs=0,this.clockRate=0,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new yt).fromBinary(e,t)}static fromJson(e,t){return(new yt).fromJson(e,t)}static fromJsonString(e,t){return(new yt).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(yt,e,t)}}yt.runtime=Oe,yt.typeName="livekit.RTPDrift",yt.fields=Oe.util.newFieldList((()=>[{no:1,name:"start_time",kind:"message",T:Ke},{no:2,name:"end_time",kind:"message",T:Ke},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]));class bt extends P{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=j.zero,this.headerBytes=j.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=j.zero,this.headerBytesDuplicate=j.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=j.zero,this.headerBytesPadding=j.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new bt).fromBinary(e,t)}static fromJson(e,t){return(new bt).fromJson(e,t)}static fromJsonString(e,t){return(new bt).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(bt,e,t)}}bt.runtime=Oe,bt.typeName="livekit.RTPStats",bt.fields=Oe.util.newFieldList((()=>[{no:1,name:"start_time",kind:"message",T:Ke},{no:2,name:"end_time",kind:"message",T:Ke},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:Ke},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:Ke},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:Ke},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:Ke},{no:44,name:"packet_drift",kind:"message",T:yt},{no:45,name:"report_drift",kind:"message",T:yt}]));class kt extends P{constructor(e){super(),this.unixMicro=j.zero,this.ticks=0,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new kt).fromBinary(e,t)}static fromJson(e,t){return(new kt).fromJson(e,t)}static fromJsonString(e,t){return(new kt).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(kt,e,t)}}kt.runtime=Oe,kt.typeName="livekit.TimedVersion",kt.fields=Oe.util.newFieldList((()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]));const St=7e3,wt=[0,300,1200,2700,4800,St,St,St,St,St];function Ct(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(t){o(t)}}function s(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))}function Tt(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Et(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Tt(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){(function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)})(i,r,(t=e[n](t)).done,t.value)}))}}}"function"===typeof SuppressedError&&SuppressedError;var Pt,xt={exports:{}},Rt="object"===typeof Reflect?Reflect:null,Nt=Rt&&"function"===typeof Rt.apply?Rt.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};Pt=Rt&&"function"===typeof Rt.ownKeys?Rt.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var Ot=Number.isNaN||function(e){return e!==e};function _t(){_t.init.call(this)}xt.exports=_t,xt.exports.once=function(e,t){return new Promise((function(n,i){function r(n){e.removeListener(t,o),i(n)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}Vt(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&Vt(e,"error",t,n)}(e,r,{once:!0})}))},_t.EventEmitter=_t,_t.prototype._events=void 0,_t.prototype._eventsCount=0,_t.prototype._maxListeners=void 0;var It=10;function Dt(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function Mt(e){return void 0===e._maxListeners?_t.defaultMaxListeners:e._maxListeners}function Lt(e,t,n,i){var r,o,a,s;if(Dt(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"===typeof a?a=o[t]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),(r=Mt(e))>0&&a.length>r&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return e}function At(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ut(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=At.bind(i);return r.listener=n,i.wrapFn=r,r}function Ft(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"===typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):Bt(r,r.length)}function jt(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function Bt(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function Vt(e,t,n,i){if("function"===typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(o){i.once&&e.removeEventListener(t,r),n(o)}))}}Object.defineProperty(_t,"defaultMaxListeners",{enumerable:!0,get:function(){return It},set:function(e){if("number"!==typeof e||e<0||Ot(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");It=e}}),_t.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},_t.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||Ot(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},_t.prototype.getMaxListeners=function(){return Mt(this)},_t.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var s=r[e];if(void 0===s)return!1;if("function"===typeof s)Nt(s,this,t);else{var c=s.length,l=Bt(s,c);for(n=0;n<c;++n)Nt(l[n],this,t)}return!0},_t.prototype.addListener=function(e,t){return Lt(this,e,t,!1)},_t.prototype.on=_t.prototype.addListener,_t.prototype.prependListener=function(e,t){return Lt(this,e,t,!0)},_t.prototype.once=function(e,t){return Dt(t),this.on(e,Ut(this,e,t)),this},_t.prototype.prependOnceListener=function(e,t){return Dt(t),this.prependListener(e,Ut(this,e,t)),this},_t.prototype.removeListener=function(e,t){var n,i,r,o,a;if(Dt(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,a||t)}return this},_t.prototype.off=_t.prototype.removeListener,_t.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},_t.prototype.listeners=function(e){return Ft(this,e,!0)},_t.prototype.rawListeners=function(e){return Ft(this,e,!1)},_t.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):jt.call(e,t)},_t.prototype.listenerCount=jt,_t.prototype.eventNames=function(){return this._eventsCount>0?Pt(this._events):[]};var zt=xt.exports;let Jt=!0,qt=!0;function Wt(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function Ht(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return r.apply(this,arguments);const o=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,o),r.apply(this,[e,o])};const o=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function Kt(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Jt=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Gt(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(qt=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Qt(){if("object"===typeof window){if(Jt)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function $t(e,t){qt&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Yt(e){return"[object Object]"===Object.prototype.toString.call(e)}function Xt(e){return Yt(e)?Object.keys(e).reduce((function(t,n){const i=Yt(e[n]),r=i?Xt(e[n]):e[n],o=i&&!Object.keys(r).length;return void 0===r||o?t:Object.assign(t,{[n]:r})}),{}):e}function Zt(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((i=>{i.endsWith("Id")?Zt(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((t=>{Zt(e,e.get(t),n)}))})))}function en(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((n=>{n.type===i&&n.trackId===t.id&&Zt(e,n,r)}))})),r}const tn=Qt;function nn(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(e){if("object"!==typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"===typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"===typeof i.exact&&(i.min=i.max=i.exact);const r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"===typeof i.ideal?(e[r("min",n)]=i.ideal,t.optional.push(e),e={},e[r("max",n)]=i.ideal,t.optional.push(e)):(e[r("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!==typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach((e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},r=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"===typeof e.video){let o=e.video.facingMode;o=o&&("object"===typeof o?o:{ideal:o});const a=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||a)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let a=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!a&&n.length&&t.includes("back")&&(a=n[n.length-1]),a&&(e.video.deviceId=o.exact?{exact:a.deviceId}:{ideal:a.deviceId}),e.video=i(e.video),tn("chrome: "+JSON.stringify(e)),r(e)}))}e.video=i(e.video)}return tn("chrome: "+JSON.stringify(e)),r(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){r(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{i&&i(o(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return r(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(o(e))))))}}}function rn(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function on(e){if("object"===typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const r=new Event("track");r.track=n.track,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)})),t.stream.getTracks().forEach((n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const r=new Event("track");r.track=n,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Ht(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function an(e){if("object"===typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let r=n.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"===typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function sn(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,i]=arguments;if(arguments.length>0&&"function"===typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!==typeof e))return t.apply(this,[]);const r=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const i=function(e){n(o(r(e)))};return t.apply(this,[i,e])}return new Promise(((e,n)=>{t.apply(this,[function(t){e(o(r(t)))},n])})).then(n,i)}}function cn(e){if(!("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>en(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Ht(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>en(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach((n=>{n.track===e&&(t?i=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?i=!0:n=t),t.track===e))),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function ln(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),r.apply(this,arguments)}}function un(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return ln(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const r=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const r=this._streams[n.id];if(r)r.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"===typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>o(this,e)))}};e.RTCPeerConnection.prototype[t]=i[t]}));const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function dn(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}))}function hn(e,t){Ht(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var pn=Object.freeze({__proto__:null,fixNegotiationNeeded:hn,shimAddTrackRemoveTrack:un,shimAddTrackRemoveTrackWithNative:ln,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"===typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const i=n.video&&n.video.width,r=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},i&&(n.video.mandatory.maxWidth=i),r&&(n.video.mandatory.maxHeight=r),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:an,shimGetStats:sn,shimGetUserMedia:nn,shimMediaStream:rn,shimOnTrack:on,shimPeerConnection:dn,shimSenderReceiverGetStats:cn});function fn(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){$t("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"===typeof n&&"object"===typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"===typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function mn(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function gn(e,t){if("object"!==typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,o]=arguments;return i.apply(this,[e||null]).then((e=>{if(t.version<53&&!r)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(i){if("TypeError"!==i.name)throw i;e.forEach(((t,i)=>{e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(r,o)}}function vn(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function yn(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Ht(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function bn(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){$t("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function kn(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Sn(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach((e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return i})}function wn(e){if("object"!==typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function Cn(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function Tn(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}var En=Object.freeze({__proto__:null,shimAddTransceiver:Sn,shimCreateAnswer:Tn,shimCreateOffer:Cn,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:wn,shimGetUserMedia:fn,shimOnTrack:mn,shimPeerConnection:gn,shimRTCDataChannel:kn,shimReceiverGetStats:yn,shimRemoveStream:bn,shimSenderGetStats:vn});function Pn(e){if("object"===typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i&&i.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function xn(e){if("object"===typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function Rn(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,r=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return t?(r.then(e,t),Promise.resolve()):r},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r};let s=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=s,s=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=s,s=function(e,t,n){const i=a.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=s}function Nn(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(On(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function On(e){return e&&void 0!==e.video?Object.assign({},e,{video:Xt(e.video)}):e}function _n(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];void 0===i.urls&&i.url?($t("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function In(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Dn(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Mn(e){"object"!==typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Ln=Object.freeze({__proto__:null,shimAudioContext:Mn,shimCallbacksAPI:Rn,shimConstraints:On,shimCreateOfferLegacy:Dn,shimGetUserMedia:Nn,shimLocalStreamsAPI:Pn,shimRTCIceServerUrls:_n,shimRemoteStreamsAPI:xn,shimTrackEventTransceiver:In}),An={exports:{}};!function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((e=>0===e.indexOf(n)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:void 0===n[t[i]]&&(n[t[i]]=t[i+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const i=e.substring(e.indexOf(" ")+1).split(";");for(let r=0;r<i.length;r++)n=i[r].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const i=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substring(t+1,i),n.value=e.substring(i+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],r=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&r?{usernameFragment:i.substring(12),password:r.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" ");n.profile=i[2];for(let o=3;o<i.length;o++){const r=i[o],a=t.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(a){const i=t.parseRtpMap(a),o=t.matchPrefix(e,"a=fmtp:"+r+" ");switch(i.parameters=o.length?t.parseFmtp(o[0]):{},i.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(t.parseRtcpFb),n.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(i.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{n.headerExtensions.push(t.parseExtmap(e))}));const r=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach((e=>{r.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),n},t.writeRtpDescription=function(e,n){let i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((e=>{i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)}));let r=0;return n.codecs.forEach((e=>{e.maxptime>r&&(r=e.maxptime)})),r>0&&(i+="a=maxptime:"+r+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((e=>{i+=t.writeExtmap(e)})),i},t.parseRtpEncodingParameters=function(e){const n=[],i=t.parseRtpParameters(e),r=-1!==i.fecMechanisms.indexOf("RED"),o=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),s=a.length>0&&a[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));l.length>0&&l[0].length>1&&l[0][0]===s&&(c=l[0][1]),i.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&c&&(t.rtx={ssrc:c}),n.push(t),r&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:s,mechanism:o?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&s&&n.push({ssrc:s});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach((e=>{e.maxBitrate=u}))),n},t.parseRtcpParameters=function(e){const n={},i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);const r=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=r.length>0,n.compound=0===r.length;const o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const i=t.matchPrefix(e,"a=msid:");if(1===i.length)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};const r=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return r.length>0?(n=r[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");let r;i.length>0&&(r=parseInt(i[0].substring(19),10)),isNaN(r)&&(r=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:n.fmt,maxMessageSize:r};const a=t.matchPrefix(e,"a=sctpmap:");if(a.length>0){const e=a[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,i){let r;const o=void 0!==n?n:2;r=e||t.generateSessionId();return"v=0\r\no="+(i||"thisisadapterortc")+" "+r+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const i=t.splitLines(e);for(let t=0;t<i.length;t++)switch(i[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[t].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let t=0;t<n.length;t++)if(n[t].length<2||"="!==n[t].charAt(1))return!1;return!0},e.exports=t}(An);var Un=An.exports,Fn=c(Un),jn=a({__proto__:null,default:Fn},[Un]);function Bn(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),i=Fn.parseCandidate(e.candidate);for(const e in i)e in n||Object.defineProperty(n,e,{value:i[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Ht(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function Vn(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Ht(e,"icecandidate",(e=>{if(e.candidate){const t=Fn.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))}function zn(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=Fn.splitSections(e.sdp);return t.shift(),t.some((e=>{const t=Fn.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!==n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),i=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const r=Fn.matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?i=parseInt(r[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],e);let r;r=0===n&&0===i?Number.POSITIVE_INFINITY:0===n||0===i?Math.max(n,i):Math.min(n,i);const o={};Object.defineProperty(o,"maxMessageSize",{get:()=>r}),this._sctp=o}return n.apply(this,arguments)}}function Jn(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],r=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},Ht(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function qn(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function Wn(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function Hn(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Kn(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!==typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}if(e.sdp||"offer"!==e.type&&"answer"!==e.type)return n.apply(this,[e]);return("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>n.apply(this,[e])))})}var Gn=Object.freeze({__proto__:null,removeExtmapAllowMixed:Wn,shimAddIceCandidateNullOrEmpty:Hn,shimConnectionState:qn,shimMaxMessageSize:zn,shimParameterlessSetLocalDescription:Kn,shimRTCIceCandidate:Bn,shimRTCIceCandidateRelayProtocol:Vn,shimSendThrowTypeError:Jn});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Qt,i=function(e){const t={browser:null,version:null};if("undefined"===typeof e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=Wt(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=Wt(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=Wt(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),r={browserDetails:i,commonShim:Gn,extractVersion:Wt,disableLog:Kt,disableWarnings:Gt,sdp:jn};switch(i.browser){case"chrome":if(!pn||!dn||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(null===i.version)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=pn,Hn(e,i),Kn(e),nn(e,i),rn(e),dn(e,i),on(e),un(e,i),an(e),sn(e),cn(e),hn(e,i),Bn(e),Vn(e),qn(e),zn(e,i),Jn(e),Wn(e,i);break;case"firefox":if(!En||!gn||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=En,Hn(e,i),Kn(e),fn(e,i),gn(e,i),mn(e),bn(e),vn(e),yn(e),kn(e),Sn(e),wn(e),Cn(e),Tn(e),Bn(e),qn(e),zn(e,i),Jn(e);break;case"safari":if(!Ln||!t.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=Ln,Hn(e,i),Kn(e),_n(e),Dn(e),Rn(e),Pn(e),xn(e),In(e),Nn(e),Mn(e),Bn(e),Vn(e),zn(e,i),Jn(e),Wn(e,i);break;default:n("Unsupported browser!")}}({window:"undefined"===typeof window?void 0:window});const Qn="lk_e2ee";var $n,Yn,Xn,Zn;function ei(){return"undefined"!==typeof window.RTCRtpSender&&"undefined"!==typeof window.RTCRtpSender.prototype.createEncodedStreams||ti()}function ti(){return"undefined"!==typeof window.RTCRtpScriptTransform}!function(e){e.SetKey="setKey",e.RatchetRequest="ratchetRequest",e.KeyRatcheted="keyRatcheted"}($n||($n={})),function(e){e.KeyRatcheted="keyRatcheted"}(Yn||(Yn={})),function(e){e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError"}(Xn||(Xn={})),function(e){e.Error="cryptorError"}(Zn||(Zn={}));zt.EventEmitter;class ni extends Error{constructor(e,t){super(t||"an error has occured"),this.code=e}}class ii extends ni{constructor(e,t,n){super(1,e),this.status=n,this.reason=t}}class ri extends ni{constructor(e){super(21,null!==e&&void 0!==e?e:"device is unsupported")}}class oi extends ni{constructor(e){super(20,null!==e&&void 0!==e?e:"track is invalid")}}class ai extends ni{constructor(e){super(10,null!==e&&void 0!==e?e:"unsupported server")}}class si extends ni{constructor(e){super(12,null!==e&&void 0!==e?e:"unexpected connection state")}}class ci extends ni{constructor(e){super(13,null!==e&&void 0!==e?e:"unable to negotiate")}}var li,ui,di,hi,pi;function fi(e,t,n){var i,r,o;void 0===t&&(t=50),void 0===n&&(n={});var a=null!=(i=n.isImmediate)&&i,s=null!=(r=n.callback)&&r,c=n.maxWait,l=Date.now(),u=[];function d(){if(void 0!==c){var e=Date.now()-l;if(e+t>=c)return c-e}return t}var h=function(){var t=[].slice.call(arguments),n=this;return new Promise((function(i,r){var c=a&&void 0===o;if(void 0!==o&&clearTimeout(o),o=setTimeout((function(){if(o=void 0,l=Date.now(),!a){var i=e.apply(n,t);s&&s(i),u.forEach((function(e){return(0,e.resolve)(i)})),u=[]}}),d()),c){var h=e.apply(n,t);return s&&s(h),i(h)}u.push({resolve:i,reject:r})}))};return h.cancel=function(e){void 0!==o&&clearTimeout(o),u.forEach((function(t){return(0,t.reject)(e)})),u=[]},h}!function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"}(li||(li={})),function(e){e.getFailure=function(t){if(t&&"name"in t)return"NotFoundError"===t.name||"DevicesNotFoundError"===t.name?e.NotFound:"NotAllowedError"===t.name||"PermissionDeniedError"===t.name?e.PermissionDenied:"NotReadableError"===t.name||"TrackStartError"===t.name?e.DeviceInUse:e.Other}}(li||(li={})),function(e){e.Connected="connected",e.Reconnecting="reconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.ConnectionStateChanged="connectionStateChanged",e.StateChanged="connectionStateChanged",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalAudioSilenceDetected="localAudioSilenceDetected",e.ActiveSpeakersChanged="activeSpeakersChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.VideoPlaybackStatusChanged="videoPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.SignalConnected="signalConnected",e.RecordingStatusChanged="recordingStatusChanged",e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ActiveDeviceChanged="activeDeviceChanged"}(ui||(ui={})),function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.DataReceived="dataReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.MediaDevicesError="mediaDevicesError",e.AudioStreamAcquired="audioStreamAcquired",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.PCTrackAdded="pcTrackAdded"}(di||(di={})),function(e){e.TransportsCreated="transportsCreated",e.Connected="connected",e.Disconnected="disconnected",e.Resuming="resuming",e.Resumed="resumed",e.Restarting="restarting",e.Restarted="restarted",e.SignalResumed="signalResumed",e.SignalRestarted="signalRestarted",e.Closing="closing",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived",e.RTPVideoMapUpdate="rtpVideoMapUpdate",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ParticipantUpdate="participantUpdate",e.RoomUpdate="roomUpdate",e.SpeakersChanged="speakersChanged",e.StreamStateChanged="streamStateChanged",e.ConnectionQualityUpdate="connectionQualityUpdate",e.SubscriptionError="subscriptionError",e.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",e.RemoteMute="remoteMute",e.SubscribedQualityUpdate="subscribedQualityUpdate",e.LocalTrackUnpublished="localTrackUnpublished"}(hi||(hi={})),function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Restarted="restarted",e.Ended="ended",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.AudioSilenceDetected="audioSilenceDetected",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged",e.VideoPlaybackStarted="videoPlaybackStarted",e.VideoPlaybackFailed="videoPlaybackFailed",e.ElementAttached="elementAttached",e.ElementDetached="elementDetached",e.UpstreamPaused="upstreamPaused",e.UpstreamResumed="upstreamResumed",e.SubscriptionPermissionChanged="subscriptionPermissionChanged",e.SubscriptionStatusChanged="subscriptionStatusChanged",e.SubscriptionFailed="subscriptionFailed"}(pi||(pi={}));const mi=/version\/(\d+(\.?_?\d+)+)/i;let gi;function vi(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("undefined"===typeof e&&"undefined"===typeof navigator)return;const n=(null!==e&&void 0!==e?e:navigator.userAgent).toLowerCase();if(void 0===gi||t){const e=yi.find((e=>{let{test:t}=e;return t.test(n)}));gi=null===e||void 0===e?void 0:e.describe(n)}return gi}const yi=[{test:/firefox|iceweasel|fxios/i,describe:e=>({name:"Firefox",version:bi(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("fxios")?"iOS":void 0})},{test:/chrom|crios|crmo/i,describe:e=>({name:"Chrome",version:bi(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("crios")?"iOS":void 0})},{test:/safari|applewebkit/i,describe:e=>({name:"Safari",version:bi(mi,e),os:e.includes("mobile/")?"iOS":"macOS"})}];function bi(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=t.match(e);return i&&i.length>=n&&i[n]||""}class ki{}ki.setTimeout=function(){return setTimeout(...arguments)},ki.setInterval=function(){return setInterval(...arguments)},ki.clearTimeout=function(){return clearTimeout(...arguments)},ki.clearInterval=function(){return clearInterval(...arguments)};class Si{constructor(e,t,n,i,r){this.width=e,this.height=t,this.encoding={maxBitrate:n,maxFramerate:i,priority:r}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const wi=["vp8","h264"],Ci=["vp8","h264","vp9","av1"];function Ti(e){return!!wi.find((t=>t===e))}var Ei;!function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:2e4},e.music={maxBitrate:32e3},e.musicStereo={maxBitrate:48e3},e.musicHighQuality={maxBitrate:64e3},e.musicHighQualityStereo={maxBitrate:96e3}}(Ei||(Ei={}));const Pi={h90:new Si(160,90,9e4,20),h180:new Si(320,180,16e4,20),h216:new Si(384,216,18e4,20),h360:new Si(640,360,45e4,20),h540:new Si(960,540,8e5,25),h720:new Si(1280,720,17e5,30),h1080:new Si(1920,1080,3e6,30),h1440:new Si(2560,1440,5e6,30),h2160:new Si(3840,2160,8e6,30)},xi={h120:new Si(160,120,7e4,20),h180:new Si(240,180,125e3,20),h240:new Si(320,240,14e4,20),h360:new Si(480,360,33e4,20),h480:new Si(640,480,5e5,20),h540:new Si(720,540,6e5,25),h720:new Si(960,720,13e5,30),h1080:new Si(1440,1080,23e5,30),h1440:new Si(1920,1440,38e5,30)},Ri={h360fps3:new Si(640,360,2e5,3,"medium"),h360fps15:new Si(640,360,4e5,15,"medium"),h720fps5:new Si(1280,720,8e5,5,"medium"),h720fps15:new Si(1280,720,15e5,15,"medium"),h720fps30:new Si(1280,720,2e6,30,"medium"),h1080fps15:new Si(1920,1080,25e5,15,"medium"),h1080fps30:new Si(1920,1080,5e6,30,"medium"),original:new Si(0,0,7e6,30,"medium")};var Ni,Oi,_i;!function(e){e[e.PUBLISHER=0]="PUBLISHER",e[e.SUBSCRIBER=1]="SUBSCRIBER"}(Ni||(Ni={})),Oe.util.setEnumType(Ni,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),function(e){e[e.ACTIVE=0]="ACTIVE",e[e.PAUSED=1]="PAUSED"}(Oi||(Oi={})),Oe.util.setEnumType(Oi,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),function(e){e[e.UDP=0]="UDP",e[e.TCP=1]="TCP",e[e.TLS=2]="TLS"}(_i||(_i={})),Oe.util.setEnumType(_i,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class Ii extends P{constructor(e){super(),this.message={case:void 0},Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Ii).fromBinary(e,t)}static fromJson(e,t){return(new Ii).fromJson(e,t)}static fromJsonString(e,t){return(new Ii).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Ii,e,t)}}Ii.runtime=Oe,Ii.typeName="livekit.SignalRequest",Ii.fields=Oe.util.newFieldList((()=>[{no:1,name:"offer",kind:"message",T:zi,oneof:"message"},{no:2,name:"answer",kind:"message",T:zi,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Ai,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Li,oneof:"message"},{no:5,name:"mute",kind:"message",T:Ui,oneof:"message"},{no:6,name:"subscription",kind:"message",T:qi,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:Wi,oneof:"message"},{no:8,name:"leave",kind:"message",T:Hi,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:Ki,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:ar,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:cr,oneof:"message"},{no:13,name:"simulate",kind:"message",T:ur,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:Gi,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:dr,oneof:"message"}]));class Di extends P{constructor(e){super(),this.message={case:void 0},Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Di).fromBinary(e,t)}static fromJson(e,t){return(new Di).fromJson(e,t)}static fromJsonString(e,t){return(new Di).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Di,e,t)}}Di.runtime=Oe,Di.typeName="livekit.SignalResponse",Di.fields=Oe.util.newFieldList((()=>[{no:1,name:"join",kind:"message",T:Fi,oneof:"message"},{no:2,name:"answer",kind:"message",T:zi,oneof:"message"},{no:3,name:"offer",kind:"message",T:zi,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Ai,oneof:"message"},{no:5,name:"update",kind:"message",T:Ji,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Bi,oneof:"message"},{no:8,name:"leave",kind:"message",T:Hi,oneof:"message"},{no:9,name:"mute",kind:"message",T:Ui,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:$i,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Yi,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:Zi,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:tr,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:rr,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:sr,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:Vi,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:ji,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:hr,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:mr,oneof:"message"}]));class Mi extends P{constructor(e){super(),this.codec="",this.cid="",Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Mi).fromBinary(e,t)}static fromJson(e,t){return(new Mi).fromJson(e,t)}static fromJsonString(e,t){return(new Mi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Mi,e,t)}}Mi.runtime=Oe,Mi.typeName="livekit.SimulcastCodec",Mi.fields=Oe.util.newFieldList((()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]));class Li extends P{constructor(e){super(),this.cid="",this.name="",this.type=Fe.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=je.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=et.NONE,this.stream="",Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Li).fromBinary(e,t)}static fromJson(e,t){return(new Li).fromJson(e,t)}static fromJsonString(e,t){return(new Li).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Li,e,t)}}Li.runtime=Oe,Li.typeName="livekit.AddTrackRequest",Li.fields=Oe.util.newFieldList((()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:Oe.getEnumType(Fe)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:Oe.getEnumType(je)},{no:9,name:"layers",kind:"message",T:st,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Mi,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:Oe.getEnumType(et)},{no:15,name:"stream",kind:"scalar",T:9}]));class Ai extends P{constructor(e){super(),this.candidateInit="",this.target=Ni.PUBLISHER,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Ai).fromBinary(e,t)}static fromJson(e,t){return(new Ai).fromJson(e,t)}static fromJsonString(e,t){return(new Ai).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Ai,e,t)}}Ai.runtime=Oe,Ai.typeName="livekit.TrickleRequest",Ai.fields=Oe.util.newFieldList((()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:Oe.getEnumType(Ni)}]));class Ui extends P{constructor(e){super(),this.sid="",this.muted=!1,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Ui).fromBinary(e,t)}static fromJson(e,t){return(new Ui).fromJson(e,t)}static fromJsonString(e,t){return(new Ui).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Ui,e,t)}}Ui.runtime=Oe,Ui.typeName="livekit.MuteTrackRequest",Ui.fields=Oe.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]));class Fi extends P{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Fi).fromBinary(e,t)}static fromJson(e,t){return(new Fi).fromJson(e,t)}static fromJsonString(e,t){return(new Fi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Fi,e,t)}}Fi.runtime=Oe,Fi.typeName="livekit.JoinResponse",Fi.fields=Oe.util.newFieldList((()=>[{no:1,name:"room",kind:"message",T:Ge},{no:2,name:"participant",kind:"message",T:Xe},{no:3,name:"other_participants",kind:"message",T:Xe,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Qi,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:mt},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:pt},{no:13,name:"sif_trailer",kind:"scalar",T:12}]));class ji extends P{constructor(e){super(),this.iceServers=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new ji).fromBinary(e,t)}static fromJson(e,t){return(new ji).fromJson(e,t)}static fromJsonString(e,t){return(new ji).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(ji,e,t)}}ji.runtime=Oe,ji.typeName="livekit.ReconnectResponse",ji.fields=Oe.util.newFieldList((()=>[{no:1,name:"ice_servers",kind:"message",T:Qi,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:mt}]));class Bi extends P{constructor(e){super(),this.cid="",Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Bi).fromBinary(e,t)}static fromJson(e,t){return(new Bi).fromJson(e,t)}static fromJsonString(e,t){return(new Bi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Bi,e,t)}}Bi.runtime=Oe,Bi.typeName="livekit.TrackPublishedResponse",Bi.fields=Oe.util.newFieldList((()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:at}]));class Vi extends P{constructor(e){super(),this.trackSid="",Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Vi).fromBinary(e,t)}static fromJson(e,t){return(new Vi).fromJson(e,t)}static fromJsonString(e,t){return(new Vi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Vi,e,t)}}Vi.runtime=Oe,Vi.typeName="livekit.TrackUnpublishedResponse",Vi.fields=Oe.util.newFieldList((()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]));class zi extends P{constructor(e){super(),this.type="",this.sdp="",Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new zi).fromBinary(e,t)}static fromJson(e,t){return(new zi).fromJson(e,t)}static fromJsonString(e,t){return(new zi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(zi,e,t)}}zi.runtime=Oe,zi.typeName="livekit.SessionDescription",zi.fields=Oe.util.newFieldList((()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]));class Ji extends P{constructor(e){super(),this.participants=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Ji).fromBinary(e,t)}static fromJson(e,t){return(new Ji).fromJson(e,t)}static fromJsonString(e,t){return(new Ji).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Ji,e,t)}}Ji.runtime=Oe,Ji.typeName="livekit.ParticipantUpdate",Ji.fields=Oe.util.newFieldList((()=>[{no:1,name:"participants",kind:"message",T:Xe,repeated:!0}]));class qi extends P{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new qi).fromBinary(e,t)}static fromJson(e,t){return(new qi).fromJson(e,t)}static fromJsonString(e,t){return(new qi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(qi,e,t)}}qi.runtime=Oe,qi.typeName="livekit.UpdateSubscription",qi.fields=Oe.util.newFieldList((()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:ht,repeated:!0}]));class Wi extends P{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=Be.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Wi).fromBinary(e,t)}static fromJson(e,t){return(new Wi).fromJson(e,t)}static fromJsonString(e,t){return(new Wi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Wi,e,t)}}Wi.runtime=Oe,Wi.typeName="livekit.UpdateTrackSettings",Wi.fields=Oe.util.newFieldList((()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:Oe.getEnumType(Be)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]));class Hi extends P{constructor(e){super(),this.canReconnect=!1,this.reason=Je.UNKNOWN_REASON,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Hi).fromBinary(e,t)}static fromJson(e,t){return(new Hi).fromJson(e,t)}static fromJsonString(e,t){return(new Hi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Hi,e,t)}}Hi.runtime=Oe,Hi.typeName="livekit.LeaveRequest",Hi.fields=Oe.util.newFieldList((()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:Oe.getEnumType(Je)}]));class Ki extends P{constructor(e){super(),this.trackSid="",this.layers=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Ki).fromBinary(e,t)}static fromJson(e,t){return(new Ki).fromJson(e,t)}static fromJsonString(e,t){return(new Ki).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Ki,e,t)}}Ki.runtime=Oe,Ki.typeName="livekit.UpdateVideoLayers",Ki.fields=Oe.util.newFieldList((()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:st,repeated:!0}]));class Gi extends P{constructor(e){super(),this.metadata="",this.name="",Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Gi).fromBinary(e,t)}static fromJson(e,t){return(new Gi).fromJson(e,t)}static fromJsonString(e,t){return(new Gi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Gi,e,t)}}Gi.runtime=Oe,Gi.typeName="livekit.UpdateParticipantMetadata",Gi.fields=Oe.util.newFieldList((()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]));class Qi extends P{constructor(e){super(),this.urls=[],this.username="",this.credential="",Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Qi).fromBinary(e,t)}static fromJson(e,t){return(new Qi).fromJson(e,t)}static fromJsonString(e,t){return(new Qi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Qi,e,t)}}Qi.runtime=Oe,Qi.typeName="livekit.ICEServer",Qi.fields=Oe.util.newFieldList((()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]));class $i extends P{constructor(e){super(),this.speakers=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new $i).fromBinary(e,t)}static fromJson(e,t){return(new $i).fromJson(e,t)}static fromJsonString(e,t){return(new $i).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals($i,e,t)}}$i.runtime=Oe,$i.typeName="livekit.SpeakersChanged",$i.fields=Oe.util.newFieldList((()=>[{no:1,name:"speakers",kind:"message",T:ut,repeated:!0}]));class Yi extends P{constructor(e){super(),Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Yi).fromBinary(e,t)}static fromJson(e,t){return(new Yi).fromJson(e,t)}static fromJsonString(e,t){return(new Yi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Yi,e,t)}}Yi.runtime=Oe,Yi.typeName="livekit.RoomUpdate",Yi.fields=Oe.util.newFieldList((()=>[{no:1,name:"room",kind:"message",T:Ge}]));class Xi extends P{constructor(e){super(),this.participantSid="",this.quality=Ve.POOR,this.score=0,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Xi).fromBinary(e,t)}static fromJson(e,t){return(new Xi).fromJson(e,t)}static fromJsonString(e,t){return(new Xi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Xi,e,t)}}Xi.runtime=Oe,Xi.typeName="livekit.ConnectionQualityInfo",Xi.fields=Oe.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:Oe.getEnumType(Ve)},{no:3,name:"score",kind:"scalar",T:2}]));class Zi extends P{constructor(e){super(),this.updates=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new Zi).fromBinary(e,t)}static fromJson(e,t){return(new Zi).fromJson(e,t)}static fromJsonString(e,t){return(new Zi).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(Zi,e,t)}}Zi.runtime=Oe,Zi.typeName="livekit.ConnectionQualityUpdate",Zi.fields=Oe.util.newFieldList((()=>[{no:1,name:"updates",kind:"message",T:Xi,repeated:!0}]));class er extends P{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=Oi.ACTIVE,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new er).fromBinary(e,t)}static fromJson(e,t){return(new er).fromJson(e,t)}static fromJsonString(e,t){return(new er).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(er,e,t)}}er.runtime=Oe,er.typeName="livekit.StreamStateInfo",er.fields=Oe.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:Oe.getEnumType(Oi)}]));class tr extends P{constructor(e){super(),this.streamStates=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new tr).fromBinary(e,t)}static fromJson(e,t){return(new tr).fromJson(e,t)}static fromJsonString(e,t){return(new tr).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(tr,e,t)}}tr.runtime=Oe,tr.typeName="livekit.StreamStateUpdate",tr.fields=Oe.util.newFieldList((()=>[{no:1,name:"stream_states",kind:"message",T:er,repeated:!0}]));class nr extends P{constructor(e){super(),this.quality=Be.LOW,this.enabled=!1,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new nr).fromBinary(e,t)}static fromJson(e,t){return(new nr).fromJson(e,t)}static fromJsonString(e,t){return(new nr).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(nr,e,t)}}nr.runtime=Oe,nr.typeName="livekit.SubscribedQuality",nr.fields=Oe.util.newFieldList((()=>[{no:1,name:"quality",kind:"enum",T:Oe.getEnumType(Be)},{no:2,name:"enabled",kind:"scalar",T:8}]));class ir extends P{constructor(e){super(),this.codec="",this.qualities=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new ir).fromBinary(e,t)}static fromJson(e,t){return(new ir).fromJson(e,t)}static fromJsonString(e,t){return(new ir).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(ir,e,t)}}ir.runtime=Oe,ir.typeName="livekit.SubscribedCodec",ir.fields=Oe.util.newFieldList((()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:nr,repeated:!0}]));class rr extends P{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new rr).fromBinary(e,t)}static fromJson(e,t){return(new rr).fromJson(e,t)}static fromJsonString(e,t){return(new rr).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(rr,e,t)}}rr.runtime=Oe,rr.typeName="livekit.SubscribedQualityUpdate",rr.fields=Oe.util.newFieldList((()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:nr,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:ir,repeated:!0}]));class or extends P{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new or).fromBinary(e,t)}static fromJson(e,t){return(new or).fromJson(e,t)}static fromJsonString(e,t){return(new or).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(or,e,t)}}or.runtime=Oe,or.typeName="livekit.TrackPermission",or.fields=Oe.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]));class ar extends P{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new ar).fromBinary(e,t)}static fromJson(e,t){return(new ar).fromJson(e,t)}static fromJsonString(e,t){return(new ar).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(ar,e,t)}}ar.runtime=Oe,ar.typeName="livekit.SubscriptionPermission",ar.fields=Oe.util.newFieldList((()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:or,repeated:!0}]));class sr extends P{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new sr).fromBinary(e,t)}static fromJson(e,t){return(new sr).fromJson(e,t)}static fromJsonString(e,t){return(new sr).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(sr,e,t)}}sr.runtime=Oe,sr.typeName="livekit.SubscriptionPermissionUpdate",sr.fields=Oe.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]));class cr extends P{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new cr).fromBinary(e,t)}static fromJson(e,t){return(new cr).fromJson(e,t)}static fromJsonString(e,t){return(new cr).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(cr,e,t)}}cr.runtime=Oe,cr.typeName="livekit.SyncState",cr.fields=Oe.util.newFieldList((()=>[{no:1,name:"answer",kind:"message",T:zi},{no:2,name:"subscription",kind:"message",T:qi},{no:3,name:"publish_tracks",kind:"message",T:Bi,repeated:!0},{no:4,name:"data_channels",kind:"message",T:lr,repeated:!0},{no:5,name:"offer",kind:"message",T:zi}]));class lr extends P{constructor(e){super(),this.label="",this.id=0,this.target=Ni.PUBLISHER,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new lr).fromBinary(e,t)}static fromJson(e,t){return(new lr).fromJson(e,t)}static fromJsonString(e,t){return(new lr).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(lr,e,t)}}lr.runtime=Oe,lr.typeName="livekit.DataChannelInfo",lr.fields=Oe.util.newFieldList((()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:Oe.getEnumType(Ni)}]));class ur extends P{constructor(e){super(),this.scenario={case:void 0},Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new ur).fromBinary(e,t)}static fromJson(e,t){return(new ur).fromJson(e,t)}static fromJsonString(e,t){return(new ur).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(ur,e,t)}}ur.runtime=Oe,ur.typeName="livekit.SimulateScenario",ur.fields=Oe.util.newFieldList((()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:Oe.getEnumType(_i),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"}]));class dr extends P{constructor(e){super(),this.timestamp=j.zero,this.rtt=j.zero,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new dr).fromBinary(e,t)}static fromJson(e,t){return(new dr).fromJson(e,t)}static fromJsonString(e,t){return(new dr).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(dr,e,t)}}dr.runtime=Oe,dr.typeName="livekit.Ping",dr.fields=Oe.util.newFieldList((()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]));class hr extends P{constructor(e){super(),this.lastPingTimestamp=j.zero,this.timestamp=j.zero,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new hr).fromBinary(e,t)}static fromJson(e,t){return(new hr).fromJson(e,t)}static fromJsonString(e,t){return(new hr).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(hr,e,t)}}hr.runtime=Oe,hr.typeName="livekit.Pong",hr.fields=Oe.util.newFieldList((()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]));class pr extends P{constructor(e){super(),this.regions=[],Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new pr).fromBinary(e,t)}static fromJson(e,t){return(new pr).fromJson(e,t)}static fromJsonString(e,t){return(new pr).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(pr,e,t)}}pr.runtime=Oe,pr.typeName="livekit.RegionSettings",pr.fields=Oe.util.newFieldList((()=>[{no:1,name:"regions",kind:"message",T:fr,repeated:!0}]));class fr extends P{constructor(e){super(),this.region="",this.url="",this.distance=j.zero,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new fr).fromBinary(e,t)}static fromJson(e,t){return(new fr).fromJson(e,t)}static fromJsonString(e,t){return(new fr).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(fr,e,t)}}fr.runtime=Oe,fr.typeName="livekit.RegionInfo",fr.fields=Oe.util.newFieldList((()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]));class mr extends P{constructor(e){super(),this.trackSid="",this.err=We.SE_UNKNOWN,Oe.util.initPartial(e,this)}static fromBinary(e,t){return(new mr).fromBinary(e,t)}static fromJson(e,t){return(new mr).fromJson(e,t)}static fromJsonString(e,t){return(new mr).fromJsonString(e,t)}static equals(e,t){return Oe.util.equals(mr,e,t)}}mr.runtime=Oe,mr.typeName="livekit.SubscriptionResponse",mr.fields=Oe.util.newFieldList((()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:Oe.getEnumType(We)}]));const gr=[];class vr extends zt.EventEmitter{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=vr.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=f,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),"hidden"===document.visibilityState?this.backgroundTimeout=setTimeout((()=>this.handleAppVisibilityChanged()),5e3):this.handleAppVisibilityChanged()},this.log=m(null!==(i=n.loggerName)&&void 0!==i?i:h.Track),this.loggerContextCb=n.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=vr.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),xr(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===vr.Kind.Video&&(t="video"),0===this.attachedElements.length&&vr.Kind.Video&&this.addAppVisibilityListener(),e||("audio"===t&&(gr.forEach((t=>{null!==t.parentElement||e||(e=t)})),e&&gr.splice(gr.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),yr(this.mediaStreamTrack,e);const n=e.srcObject.getTracks(),i=n.some((e=>"audio"===e.kind));return e.play().then((()=>{this.emit(i?pi.AudioPlaybackStarted:pi.VideoPlaybackStarted)})).catch((t=>{"NotAllowedError"===t.name?this.emit(i?pi.AudioPlaybackFailed:pi.VideoPlaybackFailed,t):"AbortError"===t.name?f.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):f.warn("could not playback ".concat(i?"audio":"video"),t),i&&e&&n.some((e=>"video"===e.kind))&&"NotAllowedError"===t.name&&(e.muted=!0,e.play().catch((()=>{})))})),this.emit(pi.ElementAttached,e),e}detach(e){try{if(e){br(this.mediaStreamTrack,e);const t=this.attachedElements.indexOf(e);return t>=0&&(this.attachedElements.splice(t,1),this.recycleElement(e),this.emit(pi.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach((e=>{br(this.mediaStreamTrack,e),t.push(e),this.recycleElement(e),this.emit(pi.ElementDetached,e)})),this.attachedElements=[],t}finally{0===this.attachedElements.length&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}updateLoggerOptions(e){e.loggerName&&(this.log=m(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),gr.forEach((e=>{e.parentElement||(t=!1)})),t&&gr.push(e)}}handleAppVisibilityChanged(){return Ct(this,void 0,void 0,(function*(){this.isInBackground="hidden"===document.visibilityState}))}addAppVisibilityListener(){jr()?(this.isInBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){jr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function yr(e,t){let n,i;n=t.srcObject instanceof MediaStream?t.srcObject:new MediaStream,i="audio"===e.kind?n.getAudioTracks():n.getVideoTracks(),i.includes(e)||(i.forEach((e=>{n.removeTrack(e)})),n.addTrack(e)),Ar()&&t instanceof HTMLVideoElement||(t.autoplay=!0),t.muted=0===n.getAudioTracks().length,t instanceof HTMLVideoElement&&(t.playsInline=!0),t.srcObject!==n&&(t.srcObject=n,(Ar()||Lr())&&t instanceof HTMLVideoElement&&setTimeout((()=>{t.srcObject=n,t.play().catch((()=>{}))}),0))}function br(e,t){if(t.srcObject instanceof MediaStream){const n=t.srcObject;n.removeTrack(e),n.getTracks().length>0?t.srcObject=n:t.srcObject=null}}function kr(e,t,n){var i;const r=null!==(i=function(e){if("undefined"!==typeof e)return"function"===typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}(e))&&void 0!==i?i:{};return!0===r.audio&&(r.audio={}),!0===r.video&&(r.video={}),r.audio&&Sr(r.audio,t),r.video&&Sr(r.video,n),r}function Sr(e,t){return Object.keys(t).forEach((n=>{void 0===e[n]&&(e[n]=t[n])})),e}function wr(e){const t={};if(e.video)if("object"===typeof e.video){const n={},i=n,r=e.video;Object.keys(r).forEach((e=>{if("resolution"===e)Sr(i,r.resolution);else i[e]=r[e]})),t.video=n}else t.video=e.video;else t.video=!1;return e.audio?"object"===typeof e.audio?t.audio=e.audio:t.audio=!0:t.audio=!1,t}function Cr(){const e="undefined"!==typeof window&&(window.AudioContext||window.webkitAudioContext);if(e)return new e({latencyHint:"interactive"})}function Tr(e){var t,n;let i=null===(t=e.video)||void 0===t||t;return e.resolution&&e.resolution.width>0&&e.resolution.height>0&&(i="boolean"===typeof i?{}:i,i=Ar()?Object.assign(Object.assign({},i),{width:{max:e.resolution.width},height:{max:e.resolution.height},frameRate:e.resolution.frameRate}):Object.assign(Object.assign({},i),{width:{ideal:e.resolution.width},height:{ideal:e.resolution.height},frameRate:e.resolution.frameRate})),{audio:null!==(n=e.audio)&&void 0!==n&&n,video:i,controller:e.controller,selfBrowserSurface:e.selfBrowserSurface,surfaceSwitching:e.surfaceSwitching,systemAudio:e.systemAudio}}function Er(e){const t=e.split("/")[1].toLowerCase();if(!Ci.includes(t))throw Error("Video codec not supported: ".concat(t));return t}function Pr(e){const t=[];return e.forEach((e=>{void 0!==e.track&&t.push(new Bi({cid:e.track.mediaStreamID,track:e.trackInfo}))})),t}function xr(e){return e instanceof vr?{trackSid:e.sid,trackSource:e.source,trackMuted:e.isMuted,trackEnabled:e.mediaStreamTrack.enabled,trackKind:e.kind}:{trackSid:e.trackSid,trackName:e.trackName,track:e.track?xr(e.track):void 0,trackEnabled:e.isEnabled,trackEncrypted:e.isEncrypted,trackMimeType:e.mimeType}}!function(e){let t,n,i;!function(e){e.Audio="audio",e.Video="video",e.Unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){e.Camera="camera",e.Microphone="microphone",e.ScreenShare="screen_share",e.ScreenShareAudio="screen_share_audio",e.Unknown="unknown"}(n=e.Source||(e.Source={})),function(e){e.Active="active",e.Paused="paused",e.Unknown="unknown"}(i=e.StreamState||(e.StreamState={})),e.kindToProto=function(e){switch(e){case t.Audio:return Fe.AUDIO;case t.Video:return Fe.VIDEO;default:return Fe.DATA}},e.kindFromProto=function(e){switch(e){case Fe.AUDIO:return t.Audio;case Fe.VIDEO:return t.Video;default:return t.Unknown}},e.sourceToProto=function(e){switch(e){case n.Camera:return je.CAMERA;case n.Microphone:return je.MICROPHONE;case n.ScreenShare:return je.SCREEN_SHARE;case n.ScreenShareAudio:return je.SCREEN_SHARE_AUDIO;default:return je.UNKNOWN}},e.sourceFromProto=function(e){switch(e){case je.CAMERA:return n.Camera;case je.MICROPHONE:return n.Microphone;case je.SCREEN_SHARE:return n.ScreenShare;case je.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}},e.streamStateFromProto=function(e){switch(e){case Oi.ACTIVE:return i.Active;case Oi.PAUSED:return i.Paused;default:return i.Unknown}}}(vr||(vr={}));const Rr="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function Nr(e){return Ct(this,void 0,void 0,(function*(){return new Promise((t=>ki.setTimeout(t,e)))}))}function Or(){return"addTransceiver"in RTCPeerConnection.prototype}function _r(){return"addTrack"in RTCPeerConnection.prototype}function Ir(e){return"av1"===e||"vp9"===e}function Dr(e){return!!document&&(e||(e=document.createElement("audio")),"setSinkId"in e)}const Mr={Chrome:"100",Safari:"15",Firefox:"100"};function Lr(){var e;return"Firefox"===(null===(e=vi())||void 0===e?void 0:e.name)}function Ar(){var e;return"Safari"===(null===(e=vi())||void 0===e?void 0:e.name)}function Ur(){const e=vi();return"Safari"===(null===e||void 0===e?void 0:e.name)&&e.version.startsWith("17.")}function Fr(){return!!jr()&&/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent)}function jr(){return"undefined"!==typeof document}function Br(){return"ReactNative"==navigator.product}function Vr(e){return e.hostname.endsWith(".livekit.cloud")||e.hostname.endsWith(".livekit.run")}function zr(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function Jr(){if(!Br())return;let e=zr();return e?e.platform:void 0}function qr(){if(jr())return window.devicePixelRatio;if(Br()){let e=zr();if(e)return e.devicePixelRatio}return 1}function Wr(e,t){const n=e.split("."),i=t.split("."),r=Math.min(n.length,i.length);for(let o=0;o<r;++o){const e=parseInt(n[o],10),t=parseInt(i[o],10);if(e>t)return 1;if(e<t)return-1;if(o===r-1&&e===t)return 0}return""===e&&""!==t?-1:""===t?1:n.length==i.length?0:n.length<i.length?-1:1}function Hr(e){for(const t of e)t.target.handleResize(t)}function Kr(e){for(const t of e)t.target.handleVisibilityChanged(t)}let Gr=null;const Qr=()=>(Gr||(Gr=new ResizeObserver(Hr)),Gr);let $r=null;const Yr=()=>($r||($r=new IntersectionObserver(Kr,{root:null,rootMargin:"0px"})),$r);let Xr;function Zr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=document.createElement("canvas");r.width=e,r.height=t;const o=r.getContext("2d");null===o||void 0===o||o.fillRect(0,0,r.width,r.height),i&&o&&(o.beginPath(),o.arc(e/2,t/2,50,0,2*Math.PI,!0),o.closePath(),o.fillStyle="grey",o.fill());const a=r.captureStream(),[s]=a.getTracks();if(!s)throw Error("Could not get empty media stream video track");return s.enabled=n,s}function eo(){if(!Xr){const e=new AudioContext,t=e.createOscillator(),n=e.createGain();n.gain.setValueAtTime(0,0);const i=e.createMediaStreamDestination();if(t.connect(n),n.connect(i),t.start(),[Xr]=i.stream.getAudioTracks(),!Xr)throw Error("Could not get empty media stream audio track");Xr.enabled=!1}return Xr.clone()}class to{constructor(e,t){this.onFinally=t,this.promise=new Promise(((t,n)=>Ct(this,void 0,void 0,(function*(){this.resolve=t,this.reject=n,e&&(yield e(t,n))})))).finally((()=>{var e;return null===(e=this.onFinally)||void 0===e?void 0:e.call(this)}))}}class no{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){let e;this._locks+=1;const t=new Promise((t=>e=()=>{this._locks-=1,t()})),n=this._locking.then((()=>e));return this._locking=this._locking.then((()=>t)),n}}function io(e){if("string"===typeof e)return e;if(Array.isArray(e))return e[0];if(e.exact)return Array.isArray(e.exact)?e.exact[0]:e.exact;if(e.ideal)return Array.isArray(e.ideal)?e.ideal[0]:e.ideal;throw Error("could not unwrap constraint")}function ro(e){return e.startsWith("ws")?e.replace(/^(ws)/,"http"):e}const oo="default";class ao{static getInstance(){return void 0===this.instance&&(this.instance=new ao),this.instance}getDevices(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n;return Ct(this,void 0,void 0,(function*(){if((null===(n=ao.userMediaPromiseMap)||void 0===n?void 0:n.size)>0){f.debug("awaiting getUserMedia promise");try{e?yield ao.userMediaPromiseMap.get(e):yield Promise.all(ao.userMediaPromiseMap.values())}catch(r){f.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(t&&(!Ar()||!this.hasDeviceInUse(e))){if(0===i.length||i.some((t=>{const n=""===t.label,i=!e||t.kind===e;return n&&i}))){const t={video:"audioinput"!==e&&"audiooutput"!==e,audio:"videoinput"!==e},n=yield navigator.mediaDevices.getUserMedia(t);i=yield navigator.mediaDevices.enumerateDevices(),n.getTracks().forEach((e=>{e.stop()}))}}return e&&(i=i.filter((t=>t.kind===e))),i}))}normalizeDeviceId(e,t,n){return Ct(this,void 0,void 0,(function*(){if(t!==oo)return t;const i=(yield this.getDevices(e)).find((e=>e.groupId===n&&e.deviceId!==oo));return null===i||void 0===i?void 0:i.deviceId}))}hasDeviceInUse(e){return e?ao.userMediaPromiseMap.has(e):ao.userMediaPromiseMap.size>0}}ao.mediaDeviceKinds=["audioinput","audiooutput","videoinput"],ao.userMediaPromiseMap=new Map;class so extends vr{get constraints(){return this._constraints}constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(e,t,arguments.length>4?arguments[4]:void 0),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch((()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext))),this.debouncedTrackMuteHandler=fi((()=>Ct(this,void 0,void 0,(function*(){yield this.pauseUpstream()}))),5e3),this.handleTrackUnmuteEvent=()=>Ct(this,void 0,void 0,(function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()})),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(pi.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new no,this.pauseUpstreamLock=new no,this.processorLock=new no,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),n&&(this._constraints=n)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==vr.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();return e&&t?{width:e,height:t}:void 0}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return null!==(t=null===(e=this.processor)||void 0===e?void 0:e.processedTrack)&&void 0!==t?t:this._mediaStreamTrack}setMediaStreamTrack(e,t){return Ct(this,void 0,void 0,(function*(){if(e===this._mediaStreamTrack&&!t)return;let n;if(this._mediaStreamTrack&&(this.attachedElements.forEach((e=>{br(this._mediaStreamTrack,e)})),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints()),this.processor&&e&&this.processorElement){if(this.log.debug("restarting processor",this.logContext),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");yr(e,this.processorElement),this.processorElement.muted=!0,yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),n=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(null!==n&&void 0!==n?n:e)),this.providedByUser||this._mediaStreamTrack===e||this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach((t=>{yr(null!==n&&void 0!==n?n:e,t)})))}))}waitForDimensions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;var t;return Ct(this,void 0,void 0,(function*(){if(this.kind===vr.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");"iOS"===(null===(t=vi())||void 0===t?void 0:t.os)&&(yield Nr(10));const n=Date.now();for(;Date.now()-n<e;){const e=this.dimensions;if(e)return e;yield Nr(50)}throw new oi("unable to get track dimensions after timeout")}))}getDeviceId(){return Ct(this,void 0,void 0,(function*(){if(this.source===vr.Source.ScreenShare)return;const{deviceId:e,groupId:t}=this._mediaStreamTrack.getSettings(),n=this.kind===vr.Kind.Audio?"audioinput":"videoinput";return ao.getInstance().normalizeDeviceId(n,e,t)}))}mute(){return Ct(this,void 0,void 0,(function*(){return this.setTrackMuted(!0),this}))}unmute(){return Ct(this,void 0,void 0,(function*(){return this.setTrackMuted(!1),this}))}replaceTrack(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Ct(this,void 0,void 0,(function*(){if(!this.sender)throw new oi("unable to replace an unpublished track");return this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),this.providedByUser=t,this.processor&&(yield this.stopProcessor()),this}))}restart(e){return Ct(this,void 0,void 0,(function*(){e||(e=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const t={audio:!1,video:!1};this.kind===vr.Kind.Video?t.video=e:t.audio=e,this.attachedElements.forEach((e=>{br(this.mediaStreamTrack,e)})),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const n=(yield navigator.mediaDevices.getUserMedia(t)).getTracks()[0];return n.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(n),this._constraints=e,this.emit(pi.Restarted,this),this}))}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),this.isMuted===e&&this._mediaStreamTrack.enabled!==e||(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?pi.Muted:pi.Unmuted,this))}get needsReAcquisition(){return"live"!==this._mediaStreamTrack.readyState||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Ct(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),Fr()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),this.isInBackground||!this.needsReAcquisition||this.isUserProvided||this.isMuted||(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))}))}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),null===(e=this.processor)||void 0===e||e.destroy(),this.processor=void 0}pauseUpstream(){return Ct(this,void 0,void 0,(function*(){const e=yield this.pauseUpstreamLock.lock();try{if(!0===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to pause upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!0,this.emit(pi.UpstreamPaused,this);const e=vi();if("Safari"===(null===e||void 0===e?void 0:e.name)&&Wr(e.version,"12.0")<0)throw new ri("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}}))}resumeUpstream(){return Ct(this,void 0,void 0,(function*(){const e=yield this.pauseUpstreamLock.lock();try{if(!1===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to resume upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!1,this.emit(pi.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}}))}getRTCStatsReport(){var e;return Ct(this,void 0,void 0,(function*(){if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;return yield this.sender.getStats()}))}setProcessor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n,i;return Ct(this,void 0,void 0,(function*(){const r=yield this.processorLock.lock();try{if(this.log.debug("setting up processor",this.logContext),this.processor&&(yield this.stopProcessor()),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");this.processorElement=null!==(n=this.processorElement)&&void 0!==n?n:document.createElement(this.kind),yr(this._mediaStreamTrack,this.processorElement),this.processorElement.muted=!0,this.processorElement.play().catch((e=>this.log.error("failed to play processor element",Object.assign(Object.assign({},this.logContext),{error:e}))));const r={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(r),this.processor=e,this.processor.processedTrack){for(const e of this.attachedElements)e!==this.processorElement&&t&&(br(this._mediaStreamTrack,e),yr(this.processor.processedTrack,e));yield null===(i=this.sender)||void 0===i?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{r()}}))}getProcessor(){return this.processor}stopProcessor(){var e,t;return Ct(this,void 0,void 0,(function*(){this.processor&&(this.log.debug("stopping processor",this.logContext),null===(e=this.processor.processedTrack)||void 0===e||e.stop(),yield this.processor.destroy(),this.processor=void 0,null===(t=this.processorElement)||void 0===t||t.remove(),this.processorElement=void 0,yield this.restart())}))}}class co extends zt.EventEmitter{constructor(e){super(),this.onWorkerMessage=e=>{var t,n;const{kind:i,data:r}=e.data;switch(i){case"error":f.error(r.error.message),this.emit(Xn.EncryptionError,r.error);break;case"initAck":r.enabled&&this.keyProvider.getKeys().forEach((e=>{this.postKey(e)}));break;case"enable":if(this.encryptionEnabled!==r.enabled&&r.participantIdentity===(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))this.emit(Xn.ParticipantEncryptionStatusChanged,r.enabled,this.room.localParticipant),this.encryptionEnabled=r.enabled;else if(r.participantIdentity){const e=null===(n=this.room)||void 0===n?void 0:n.getParticipantByIdentity(r.participantIdentity);if(!e)throw TypeError("couldn't set encryption status, participant not found".concat(r.participantIdentity));this.emit(Xn.ParticipantEncryptionStatusChanged,r.enabled,e)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach((e=>{this.postKey(e)}));break;case"ratchetKey":this.keyProvider.emit($n.KeyRatcheted,r.material,r.keyIndex)}},this.onWorkerError=e=>{f.error("e2ee worker encountered an error:",{error:e.error}),this.emit(Xn.EncryptionError,e.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!ei())throw new ri("tried to setup end-to-end encryption on an unsupported browser");if(f.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(f.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){f.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){e&&0!==e.length?this.postSifTrailer(e):f.warn("ignoring server sent trailer as it's empty")}setupEngine(e){e.on(hi.RTPVideoMapUpdate,(e=>{this.postRTPMap(e)}))}setupEventListeners(e,t){e.on(ui.TrackPublished,((e,t)=>this.setParticipantCryptorEnabled(e.trackInfo.encryption!==et.NONE,t.identity))),e.on(ui.ConnectionStateChanged,(t=>{t===Ta.Connected&&e.participants.forEach((e=>{e.tracks.forEach((t=>{this.setParticipantCryptorEnabled(t.trackInfo.encryption!==et.NONE,e.identity)}))}))})).on(ui.TrackUnsubscribed,((e,t,n)=>{var i;const r={kind:"removeTransform",data:{participantIdentity:n.identity,trackId:e.mediaStreamID}};null===(i=this.worker)||void 0===i||i.postMessage(r)})).on(ui.TrackSubscribed,((e,t,n)=>{this.setupE2EEReceiver(e,n.identity,t.trackInfo)})).on(ui.SignalConnected,(()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),t.getKeys().forEach((e=>{this.postKey(e)}))})),e.localParticipant.on(di.LocalTrackPublished,(e=>Ct(this,void 0,void 0,(function*(){this.setupE2EESender(e.track,e.track.sender)})))),t.on($n.SetKey,(e=>this.postKey(e))).on($n.RatchetRequest,((e,t)=>this.postRatchetRequest(e,t)))}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const n={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(n)}postKey(e){let{key:t,participantIdentity:n,keyIndex:i}=e;var r;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:n,isPublisher:n===(null===(r=this.room)||void 0===r?void 0:r.localParticipant.identity),key:t,keyIndex:i}};this.worker.postMessage(o)}postEnable(e,t){if(!this.worker)throw new ReferenceError("failed to enable e2ee, worker is not ready");{const n={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(n)}}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const n={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(n)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,n){if(e.receiver){if(!(null===n||void 0===n?void 0:n.mimeType)||""===n.mimeType)throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,"video"===e.kind?Er(n.mimeType):void 0)}}setupE2EESender(e,t){e instanceof so&&t?this.handleSender(t,e.mediaStreamID,void 0):t||f.warn("early return because sender is not ready")}handleReceiver(e,t,n,i){return Ct(this,void 0,void 0,(function*(){if(this.worker){if(ti()){const r={kind:"decode",participantIdentity:n,trackId:t,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,r)}else{if(Qn in e&&i){const e={kind:"updateCodec",data:{trackId:t,codec:i,participantIdentity:n}};return void this.worker.postMessage(e)}let r=e.writableStream,o=e.readableStream;if(!r||!o){const t=e.createEncodedStreams();e.writableStream=t.writable,r=t.writable,e.readableStream=t.readable,o=t.readable}const a={kind:"decode",data:{readableStream:o,writableStream:r,trackId:t,codec:i,participantIdentity:n}};this.worker.postMessage(a,[o,r])}e[Qn]=!0}}))}handleSender(e,t,n){var i;if(!(Qn in e)&&this.worker){if(!(null===(i=this.room)||void 0===i?void 0:i.localParticipant.identity)||""===this.room.localParticipant.identity)throw TypeError("local identity needs to be known in order to set up encrypted sender");if(ti()){f.info("initialize script transform");const i={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:n};e.transform=new RTCRtpScriptTransform(this.worker,i)}else{f.info("initialize encoded streams");const i=e.createEncodedStreams(),r={kind:"encode",data:{readableStream:i.readable,writableStream:i.writable,codec:n,trackId:t,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r,[i.readable,i.writable])}e[Qn]=!0}}}var lo;!function(e){e[e.WAITING=0]="WAITING",e[e.RUNNING=1]="RUNNING",e[e.COMPLETED=2]="COMPLETED"}(lo||(lo={}));class uo{constructor(){this.pendingTasks=new Map,this.taskMutex=new no,this.nextTaskIndex=0}run(e){return Ct(this,void 0,void 0,(function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:lo.WAITING};this.pendingTasks.set(t.id,t);const n=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=lo.RUNNING,yield e()}finally{t.status=lo.COMPLETED,this.pendingTasks.delete(t.id),n()}}))}flush(){return Ct(this,void 0,void 0,(function*(){return this.run((()=>Ct(this,void 0,void 0,(function*(){}))))}))}snapshot(){return Array.from(this.pendingTasks.values())}}const ho=["syncState","trickle","offer","answer","simulate","leave"];var po;!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.RECONNECTING=2]="RECONNECTING",e[e.DISCONNECTING=3]="DISCONNECTING",e[e.DISCONNECTED=4]="DISCONNECTED"}(po||(po={}));class fo{get currentState(){return this.state}get isDisconnected(){return this.state===po.DISCONNECTING||this.state===po.DISCONNECTED}get isEstablishingConnection(){return this.state===po.CONNECTING||this.state===po.RECONNECTING}constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;this.rtt=0,this.state=po.DISCONNECTED,this.log=f,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=m(null!==(n=t.loggerName)&&void 0!==n?n:h.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new uo,this.queuedRequests=[],this.closingLock=new no,this.connectionLock=new no,this.state=po.DISCONNECTED}get logContext(){var e,t;return null!==(t=null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this))&&void 0!==t?t:{}}join(e,t,n,i){return Ct(this,void 0,void 0,(function*(){this.state=po.CONNECTING,this.options=n;return yield this.connect(e,t,n,i)}))}reconnect(e,t,n,i){return Ct(this,void 0,void 0,(function*(){if(!this.options)return void this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);this.state=po.RECONNECTING,this.clearPingInterval();return yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:n,reconnectReason:i}))}))}connect(e,t,n,i){this.connectOptions=n,e=(e=function(e){return e.startsWith("http")?e.replace(/^(http)/,"ws"):e}(e)).replace(/\/$/,""),e+="/rtc";const r=function(e,t,n){var i;const r=new URLSearchParams;r.set("access_token",e),n.reconnect&&(r.set("reconnect","1"),n.sid&&r.set("sid",n.sid));r.set("auto_subscribe",n.autoSubscribe?"1":"0"),r.set("sdk",Br()?"reactnative":"js"),r.set("version",t.version),r.set("protocol",t.protocol.toString()),t.deviceModel&&r.set("device_model",t.deviceModel);t.os&&r.set("os",t.os);t.osVersion&&r.set("os_version",t.osVersion);t.browser&&r.set("browser",t.browser);t.browserVersion&&r.set("browser_version",t.browserVersion);void 0!==n.publishOnly&&r.set("publish",n.publishOnly);n.adaptiveStream&&r.set("adaptive_stream","1");n.reconnectReason&&r.set("reconnect_reason",n.reconnectReason.toString());(null===(i=navigator.connection)||void 0===i?void 0:i.type)&&r.set("network",navigator.connection.type);return"?".concat(r.toString())}(t,function(){var e;const t=new ft({sdk:it.JS,protocol:11,version:"1.15.13"});return Br()&&(t.os=null!==(e=Jr())&&void 0!==e?e:""),t}(),n);return new Promise(((t,o)=>Ct(this,void 0,void 0,(function*(){const a=yield this.connectionLock.lock();try{const a=()=>Ct(this,void 0,void 0,(function*(){this.close(),clearTimeout(s),o(new ii("room connection has been cancelled (signal)"))})),s=setTimeout((()=>{this.close(),o(new ii("room connection has timed out (signal)"))}),n.websocketTimeout);(null===i||void 0===i?void 0:i.aborted)&&a(),null===i||void 0===i||i.addEventListener("abort",a),this.log.debug("connecting to ".concat(e+r),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(e+r),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(s)},this.ws.onerror=t=>Ct(this,void 0,void 0,(function*(){if(this.state===po.CONNECTED)this.handleWSError(t);else{clearTimeout(s);try{const t=yield fetch("http".concat(e.substring(2),"/validate").concat(r));if(t.status.toFixed(0).startsWith("4")){const e=yield t.text();o(new ii(e,0,t.status))}else o(new ii("Internal error",2,t.status))}catch(n){o(new ii("server was not reachable",1))}}})),this.ws.onmessage=e=>Ct(this,void 0,void 0,(function*(){var r,s,c,l;let u;if("string"===typeof e.data){const t=JSON.parse(e.data);u=Di.fromJson(t)}else{if(!(e.data instanceof ArrayBuffer))return void this.log.error("could not decode websocket message: ".concat(typeof e.data),this.logContext);u=Di.fromBinary(new Uint8Array(e.data))}if(this.state!==po.CONNECTED){let e=!1;if("join"===(null===(r=u.message)||void 0===r?void 0:r.case)?(this.state=po.CONNECTED,null===i||void 0===i||i.removeEventListener("abort",a),this.pingTimeoutDuration=u.message.value.pingTimeout,this.pingIntervalDuration=u.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),t(u.message.value)):this.state===po.RECONNECTING&&"leave"!==u.message.case?(this.state=po.CONNECTED,null===i||void 0===i||i.removeEventListener("abort",a),this.startPingInterval(),"reconnect"===(null===(s=u.message)||void 0===s?void 0:s.case)?t(null===(c=u.message)||void 0===c?void 0:c.value):(t(),e=!0)):this.isEstablishingConnection&&"leave"===u.message.case?o(new ii("Received leave request while trying to (re)connect",4)):n.reconnect||o(new ii("did not receive join response, got ".concat(null===(l=u.message)||void 0===l?void 0:l.case," instead"))),!e)return}this.signalLatency&&(yield Nr(this.signalLatency)),this.handleSignalResponse(u)})),this.ws.onclose=e=>{this.isEstablishingConnection&&o(new ii("Websocket got closed during a (re)connection attempt")),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:e.reason,state:this.state})),this.handleOnClose(e.reason)}}finally{a()}}))))}close(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Ct(this,void 0,void 0,(function*(){const t=yield this.closingLock.lock();try{if(e&&(this.state=po.DISCONNECTING),this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const e=new Promise((e=>{this.ws?this.ws.onclose=()=>{e()}:e()}));this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([e,Nr(250)])),this.ws=void 0}}finally{e&&(this.state=po.DISCONNECTED),this.clearPingInterval(),t()}}))}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:go(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:go(e)})}sendIceCandidate(e,t){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Ai({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new Ui({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return this.sendRequest({case:"updateMetadata",value:new Gi({metadata:e,name:t})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new Ki({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new ar({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:j.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new dr({timestamp:j.parse(Date.now()),rtt:j.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new Hi({canReconnect:!1,reason:Je.CLIENT_INITIATED})})}sendRequest(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Ct(this,void 0,void 0,(function*(){const n=!t&&!function(e){const t=ho.indexOf(e.case)>=0;return f.trace("request allowed to bypass queue:",{canPass:t,req:e}),t}(e);if(n&&this.state===po.RECONNECTING)return void this.queuedRequests.push((()=>Ct(this,void 0,void 0,(function*(){yield this.sendRequest(e,!0)}))));if(t||(yield this.requestQueue.flush()),this.signalLatency&&(yield Nr(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN)return void this.log.error("cannot send signal request before connected, type: ".concat(null===e||void 0===e?void 0:e.case),this.logContext);const i=new Ii({message:e});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(r){this.log.error("error sending signal message",Object.assign(Object.assign({},this.logContext),{error:r}))}}))}handleSignalResponse(e){var t,n;const i=e.message;if(void 0==i)return void this.log.debug("received unsupported message",this.logContext);let r=!1;if("answer"===i.case){const e=mo(i.value);this.onAnswer&&this.onAnswer(e)}else if("offer"===i.case){const e=mo(i.value);this.onOffer&&this.onOffer(e)}else if("trickle"===i.case){const e=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(e,i.value.target)}else"update"===i.case?this.onParticipantUpdate&&this.onParticipantUpdate(null!==(t=i.value.participants)&&void 0!==t?t:[]):"trackPublished"===i.case?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):"speakersChanged"===i.case?this.onSpeakersChanged&&this.onSpeakersChanged(null!==(n=i.value.speakers)&&void 0!==n?n:[]):"leave"===i.case?this.onLeave&&this.onLeave(i.value):"mute"===i.case?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):"roomUpdate"===i.case?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):"connectionQuality"===i.case?this.onConnectionQuality&&this.onConnectionQuality(i.value):"streamStateUpdate"===i.case?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):"subscribedQualityUpdate"===i.case?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):"subscriptionPermissionUpdate"===i.case?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):"refreshToken"===i.case?this.onTokenRefresh&&this.onTokenRefresh(i.value):"trackUnpublished"===i.case?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):"subscriptionResponse"===i.case?this.onSubscriptionError&&this.onSubscriptionError(i.value):"pong"===i.case||("pongResp"===i.case?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),r=!0):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));r||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return Ct(this,void 0,void 0,(function*(){if(this.state===po.DISCONNECTED)return;const t=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)}))}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){this.clearPingTimeout(),this.pingTimeoutDuration?this.pingTimeout=ki.setTimeout((()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-1e3*this.pingTimeoutDuration).toUTCString()),this.logContext),this.handleOnClose("ping timeout")}),1e3*this.pingTimeoutDuration):this.log.warn("ping timeout duration not set",this.logContext)}clearPingTimeout(){this.pingTimeout&&ki.clearTimeout(this.pingTimeout)}startPingInterval(){this.clearPingInterval(),this.resetPingTimeout(),this.pingIntervalDuration?(this.log.debug("start ping interval",this.logContext),this.pingInterval=ki.setInterval((()=>{this.sendPing()}),1e3*this.pingIntervalDuration)):this.log.warn("ping interval duration not set",this.logContext)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&ki.clearInterval(this.pingInterval)}}function mo(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type}return t}function go(e){return new zi({sdp:e.sdp,type:e.type})}var vo={},yo={exports:{}},bo=yo.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(bo).forEach((function(e){bo[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}));var ko=yo.exports;!function(e){var t=function(e){return String(Number(e))===e?Number(e):e},n=function(e,n,i){var r=e.name&&e.names;e.push&&!n[e.push]?n[e.push]=[]:r&&!n[e.name]&&(n[e.name]={});var o=e.push?{}:r?n[e.name]:n;!function(e,n,i,r){if(r&&!i)n[r]=t(e[1]);else for(var o=0;o<i.length;o+=1)null!=e[o+1]&&(n[i[o]]=t(e[o+1]))}(i.match(e.reg),o,e.names,e.name),e.push&&n[e.push].push(o)},i=ko,r=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},o=[],a=t;return e.split(/(\r\n|\r|\n)/).filter(r).forEach((function(e){var t=e[0],r=e.slice(2);"m"===t&&(o.push({rtp:[],fmtp:[]}),a=o[o.length-1]);for(var s=0;s<(i[t]||[]).length;s+=1){var c=i[t][s];if(c.reg.test(r))return n(c,a,r)}})),t.media=o,t};var o=function(e,n){var i=n.split(/=(.+)/,2);return 2===i.length?e[i[0]]=t(i[1]):1===i.length&&n.length>1&&(e[i[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var n=[],i=e.split(" ").map(t),r=0;r<i.length;r+=3)n.push({component:i[r],ip:i[r+1],port:i[r+2]});return n},e.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})}))},e.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var n,i=!1;return"~"!==e[0]?n=t(e):(n=t(e.substring(1,e.length)),i=!0),{scid:n,paused:i}}))}))}}(vo);var So=ko,wo=/%[sdv%]/g,Co=function(e){var t=1,n=arguments,i=n.length;return e.replace(wo,(function(e){if(t>=i)return e;var r=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(r);case"%d":return Number(r);case"%v":return""}}))},To=function(e,t,n){var i=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var r=0;r<t.names.length;r+=1){var o=t.names[r];t.name?i.push(n[t.name][o]):i.push(n[t.names[r]])}else i.push(n[t.name]);return Co.apply(null,i)},Eo=["v","o","s","i","u","e","p","c","b","t","r","z","a"],Po=["i","c","b","a"],xo=vo,Ro=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||Eo,i=t.innerOrder||Po,r=[];return n.forEach((function(t){So[t].forEach((function(n){n.name in e&&null!=e[n.name]?r.push(To(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){r.push(To(t,n,e))}))}))})),e.media.forEach((function(e){r.push(To("m",So.m[0],e)),i.forEach((function(t){So[t].forEach((function(n){n.name in e&&null!=e[n.name]?r.push(To(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){r.push(To(t,n,e))}))}))}))})),r.join("\r\n")+"\r\n"},No=Ro,Oo=xo.parse;const _o="negotiationStarted",Io="negotiationComplete",Do="rtpVideoPayloadTypes";class Mo extends zt.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;super(),this.log=f,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=fi((e=>Ct(this,void 0,void 0,(function*(){this.emit(_o);try{yield this.createAndSendOffer()}catch(t){if(!e)throw t;e(t)}}))),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=m(null!==(i=n.loggerName)&&void 0!==i?i:h.PCTransport),this.loggerOptions=n,this.config=e,this.mediaConstraints=t,this._pc=this.createPC()}createPC(){const e=function(){var e;return"Chrome"===(null===(e=vi())||void 0===e?void 0:e.name)}()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=e=>{var t;e.candidate&&(null===(t=this.onIceCandidate)||void 0===t||t.call(this,e.candidate))},e.onicecandidateerror=e=>{var t;null===(t=this.onIceCandidateError)||void 0===t||t.call(this,e)},e.oniceconnectionstatechange=()=>{var t;null===(t=this.onIceConnectionStateChange)||void 0===t||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;null===(t=this.onSignalingStatechange)||void 0===t||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,e.connectionState)},e.ondatachannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},e.ontrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},e}get logContext(){var e,t;return Object.assign({},null===(t=(e=this.loggerOptions).loggerContextCb)||void 0===t?void 0:t.call(e))}get isICEConnected(){return null!==this._pc&&("connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState)}addIceCandidate(e){return Ct(this,void 0,void 0,(function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)}))}setRemoteDescription(e){var t;return Ct(this,void 0,void 0,(function*(){let n;if("offer"===e.type){let{stereoMids:t,nackMids:n}=function(e){var t;const n=[],i=[],r=Oo(null!==(t=e.sdp)&&void 0!==t?t:"");let o=0;return r.media.forEach((e=>{var t;"audio"===e.type&&(e.rtp.some((e=>"opus"===e.codec&&(o=e.payload,!0))),(null===(t=e.rtcpFb)||void 0===t?void 0:t.some((e=>e.payload===o&&"nack"===e.type)))&&i.push(e.mid),e.fmtp.some((t=>t.payload===o&&(t.config.includes("sprop-stereo=1")&&n.push(e.mid),!0))))})),{stereoMids:n,nackMids:i}}(e);this.remoteStereoMids=t,this.remoteNackMids=n}else if("answer"===e.type){const i=Oo(null!==(t=e.sdp)&&void 0!==t?t:"");i.media.forEach((e=>{"audio"===e.type&&this.trackBitrates.some((t=>{if(!t.transceiver||e.mid!=t.transceiver.mid)return!1;let n=0;if(e.rtp.some((e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0))),0===n)return!0;let i=!1;for(const r of e.fmtp)if(r.payload===n){r.config=r.config.split(";").filter((e=>!e.includes("maxaveragebitrate"))).join(";"),t.maxbr>0&&(r.config+=";maxaveragebitrate=".concat(1e3*t.maxbr)),i=!0;break}return i||t.maxbr>0&&e.fmtp.push({payload:n,config:"maxaveragebitrate=".concat(1e3*t.maxbr)}),!0}))})),n=No(i)}if(yield this.setMungedSDP(e,n,!0),this.pendingCandidates.forEach((e=>{this.pc.addIceCandidate(e)})),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate)this.renegotiate=!1,yield this.createAndSendOffer();else if("answer"===e.type&&(this.emit(Io),e.sdp)){Oo(e.sdp).media.forEach((e=>{"video"===e.type&&this.emit(Do,e.rtp)}))}}))}createAndSendOffer(e){var t;return Ct(this,void 0,void 0,(function*(){if(void 0===this.onOffer)return;if((null===e||void 0===e?void 0:e.iceRestart)&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&"have-local-offer"===this._pc.signalingState){const t=this._pc.remoteDescription;if(!(null===e||void 0===e?void 0:e.iceRestart)||!t)return void(this.renegotiate=!0);yield this._pc.setRemoteDescription(t)}else if(!this._pc||"closed"===this._pc.signalingState)return void this.log.warn("could not createOffer with closed peer connection",this.logContext);this.log.debug("starting to negotiate",this.logContext);const n=yield this.pc.createOffer(e),i=Oo(null!==(t=n.sdp)&&void 0!==t?t:"");i.media.forEach((e=>{"audio"===e.type?Lo(e,[],[]):"video"===e.type&&(!function(e){var t,n,i,r;const o=null===(n=null===(t=e.rtp[0])||void 0===t?void 0:t.codec)||void 0===n?void 0:n.toLowerCase();if(!Ir(o))return;let a=0;const s=null===(i=e.ext)||void 0===i?void 0:i.some((e=>e.uri===Rr||(e.value>a&&(a=e.value),!1)));s||null===(r=e.ext)||void 0===r||r.push({value:a+1,uri:Rr})}(e),this.trackBitrates.some((t=>{if(!e.msid||!t.cid||!e.msid.includes(t.cid))return!1;let n=0;if(e.rtp.some((e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0))),0===n)return!0;let i=!1;for(const r of e.fmtp)if(r.payload===n){r.config.includes("x-google-start-bitrate")||(r.config+=";x-google-start-bitrate=".concat(Math.round(.7*t.maxbr))),r.config.includes("x-google-max-bitrate")||(r.config+=";x-google-max-bitrate=".concat(t.maxbr)),i=!0;break}return i||e.fmtp.push({payload:n,config:"x-google-start-bitrate=".concat(Math.round(.7*t.maxbr),";x-google-max-bitrate=").concat(t.maxbr)}),!0})))})),yield this.setMungedSDP(n,No(i)),this.onOffer(n)}))}createAndSetAnswer(){var e;return Ct(this,void 0,void 0,(function*(){const t=yield this.pc.createAnswer(),n=Oo(null!==(e=t.sdp)&&void 0!==e?e:"");return n.media.forEach((e=>{"audio"===e.type&&Lo(e,this.remoteStereoMids,this.remoteNackMids)})),yield this.setMungedSDP(t,No(n)),t}))}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new si("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new si("PC closed, cannot configure");return null===(t=this._pc)||void 0===t?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(null===(e=this._pc)||void 0===e?void 0:e.removeTrack)}removeTrack(e){var t;return null===(t=this._pc)||void 0===t?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.connectionState)&&void 0!==t?t:"closed"}getICEConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.iceConnectionState)&&void 0!==t?t:"closed"}getSignallingState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.signalingState)&&void 0!==t?t:"closed"}getTransceivers(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getTransceivers())&&void 0!==t?t:[]}getSenders(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getSenders())&&void 0!==t?t:[]}getLocalDescription(){var e;return null===(e=this._pc)||void 0===e?void 0:e.localDescription}getRemoteDescription(){var e;return null===(e=this.pc)||void 0===e?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return Ct(this,void 0,void 0,(function*(){if(!this._pc)return;let t="";const n=new Map,i=new Map;if((yield this._pc.getStats()).forEach((e=>{switch(e.type){case"transport":t=e.selectedCandidatePairId;break;case"candidate-pair":""===t&&e.selected&&(t=e.id),n.set(e.id,e);break;case"remote-candidate":i.set(e.id,"".concat(e.address,":").concat(e.port))}})),""===t)return;const r=null===(e=n.get(t))||void 0===e?void 0:e.remoteCandidateId;return void 0!==r?i.get(r):void 0}))}setMungedSDP(e,t,n){return Ct(this,void 0,void 0,(function*(){if(t){const r=e.sdp;e.sdp=t;try{return this.log.debug("setting munged ".concat(n?"remote":"local"," description"),this.logContext),void(n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e))}catch(i){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:i,sdp:t})),e.sdp=r}}try{n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let t="unknown error";i instanceof Error?t=i.message:"string"===typeof i&&(t=i);const r={error:t,sdp:e.sdp};throw!n&&this.pc.remoteDescription&&(r.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:r})),new ci(t)}}))}}function Lo(e,t,n){let i=0;e.rtp.some((e=>"opus"===e.codec&&(i=e.payload,!0))),i>0&&(e.rtcpFb||(e.rtcpFb=[]),n.includes(e.mid)&&!e.rtcpFb.some((e=>e.payload===i&&"nack"===e.type))&&e.rtcpFb.push({payload:i,type:"nack"}),t.includes(e.mid)&&e.fmtp.some((e=>e.payload===i&&(e.config.includes("stereo=1")||(e.config+=";stereo=1"),!0))))}const Ao="vp8",Uo={audioBitrate:Ei.music.maxBitrate,audioPreset:Ei.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:Ri.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Ao,backupCodec:!0},Fo={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},jo={resolution:Pi.h720.resolution},Bo={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new class{constructor(e){this._retryDelays=void 0!==e?[...e]:wt}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+1e3*Math.random()}},disconnectOnPageLeave:!0,expWebAudioMix:!1},Vo={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var zo;!function(e){e[e.NEW=0]="NEW",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.FAILED=3]="FAILED",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED"}(zo||(zo={}));class Jo{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,t,n){var i;this.peerConnectionTimeout=Vo.peerConnectionTimeout,this.log=f,this.updateState=()=>{var e;const t=this.state,n=this.requiredTransports.map((e=>e.getConnectionState()));n.every((e=>"connected"===e))?this.state=zo.CONNECTED:n.some((e=>"failed"===e))?this.state=zo.FAILED:n.some((e=>"connecting"===e))?this.state=zo.CONNECTING:n.every((e=>"closed"===e))?this.state=zo.CLOSED:n.some((e=>"closed"===e))?this.state=zo.CLOSING:n.every((e=>"new"===e))&&(this.state=zo.NEW),t!==this.state&&(this.log.debug("pc state change: from ".concat(zo[t]," to ").concat(zo[this.state]),this.logContext),null===(e=this.onStateChange)||void 0===e||e.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=m(null!==(i=n.loggerName)&&void 0!==i?i:h.PCManager),this.loggerOptions=n,this.isPublisherConnectionRequired=!t,this.isSubscriberConnectionRequired=t;this.publisher=new Mo(e,{optional:[{googDscp:!0}]},n),this.subscriber=new Mo(e,void 0,n),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,Ni.PUBLISHER)},this.subscriber.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,Ni.SUBSCRIBER)},this.subscriber.onDataChannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},this.subscriber.onTrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},this.publisher.onOffer=e=>{var t;null===(t=this.onPublisherOffer)||void 0===t||t.call(this,e)},this.state=zo.NEW,this.connectionLock=new no}get logContext(){var e,t;return Object.assign({},null===(t=(e=this.loggerOptions).loggerContextCb)||void 0===t?void 0:t.call(e))}requirePublisher(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return Ct(this,void 0,void 0,(function*(){if(this.publisher&&"closed"!==this.publisher.getSignallingState()){const t=this.publisher;for(const n of t.getSenders())try{t.canRemoveTrack()&&t.removeTrack(n)}catch(e){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:e}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()}))}triggerIceRestart(){return Ct(this,void 0,void 0,(function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))}))}addIceCandidate(e,t){return Ct(this,void 0,void 0,(function*(){t===Ni.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)}))}createSubscriberAnswerFromOffer(e){return Ct(this,void 0,void 0,(function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()})),yield this.subscriber.setRemoteDescription(e);return yield this.subscriber.createAndSetAnswer()}))}updateConfiguration(e,t){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){var n;return Ct(this,void 0,void 0,(function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&"connected"!==this.publisher.getConnectionState()&&"connecting"!==this.publisher.getConnectionState()&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all(null===(n=this.requiredTransports)||void 0===n?void 0:n.map((n=>this.ensureTransportConnected(n,e,t))))}finally{i()}}))}negotiate(e){return Ct(this,void 0,void 0,(function*(){return new Promise(((t,n)=>Ct(this,void 0,void 0,(function*(){const i=setTimeout((()=>{n("negotiation timed out")}),this.peerConnectionTimeout);e.signal.addEventListener("abort",(()=>{clearTimeout(i),n("negotiation aborted")})),this.publisher.once(_o,(()=>{e.signal.aborted||this.publisher.once(Io,(()=>{clearTimeout(i),t()}))})),yield this.publisher.negotiate((e=>{clearTimeout(i),n(e)}))}))))}))}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===Ni.PUBLISHER||e===Ni.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.peerConnectionTimeout;return Ct(this,void 0,void 0,(function*(){if("connected"!==e.getConnectionState())return new Promise(((e,i)=>Ct(this,void 0,void 0,(function*(){const r=()=>{this.log.warn("abort transport connection",this.logContext),ki.clearTimeout(o),i(new ii("room connection has been cancelled",3))};(null===t||void 0===t?void 0:t.signal.aborted)&&r(),null===t||void 0===t||t.signal.addEventListener("abort",r);const o=ki.setTimeout((()=>{null===t||void 0===t||t.signal.removeEventListener("abort",r),i(new ii("could not establish pc connection"))}),n);for(;this.state!==zo.CONNECTED;)if(yield Nr(50),null===t||void 0===t?void 0:t.signal.aborted)return void i(new ii("room connection has been cancelled",3));ki.clearTimeout(o),null===t||void 0===t||t.signal.removeEventListener("abort",r),e()}))))}))}}const qo="_lossy",Wo="_reliable",Ho="leave-reconnect";var Ko;!function(e){e[e.New=0]="New",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected",e[e.Reconnecting=3]="Reconnecting",e[e.Closed=4]="Closed"}(Ko||(Ko={}));class Go extends zt.EventEmitter{get isClosed(){return this._isClosed}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Vo.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=Ko.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=f,this.handleDataChannel=e=>{let{channel:t}=e;return Ct(this,void 0,void 0,(function*(){if(t){if(t.label===Wo)this.reliableDCSub=t;else{if(t.label!==qo)return;this.lossyDCSub=t}this.log.debug("on data channel ".concat(t.id,", ").concat(t.label),this.logContext),t.onmessage=this.handleDataMessage}}))},this.handleDataMessage=e=>Ct(this,void 0,void 0,(function*(){var t,n;const i=yield this.dataProcessLock.lock();try{let i;if(e.data instanceof ArrayBuffer)i=e.data;else{if(!(e.data instanceof Blob))return void this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:e.data}));i=yield e.data.arrayBuffer()}const r=ct.fromBinary(new Uint8Array(i));"speaker"===(null===(t=r.value)||void 0===t?void 0:t.case)?this.emit(hi.ActiveSpeakersUpdate,r.value.value.speakers):"user"===(null===(n=r.value)||void 0===n?void 0:n.case)&&this.emit(hi.DataPacketReceived,r.value.value,r.kind)}finally{i()}})),this.handleDataError=e=>{const t=0===e.currentTarget.maxRetransmits?"lossy":"reliable";if(e instanceof ErrorEvent&&e.error){const{error:n}=e.error;this.log.error("DataChannel error on ".concat(t,": ").concat(e.message),Object.assign(Object.assign({},this.logContext),{error:n}))}else this.log.error("Unknown DataChannel error on ".concat(t),Object.assign(Object.assign({},this.logContext),{event:e}))},this.handleBufferedAmountLow=e=>{const t=0===e.currentTarget.maxRetransmits?tt.LOSSY:tt.RELIABLE;this.updateAndEmitDCBufferStatus(t)},this.handleDisconnect=(e,t)=>{if(this._isClosed)return;this.log.warn("".concat(e," disconnected"),this.logContext),0===this.reconnectAttempts&&(this.reconnectStart=Date.now());const n=e=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(e,"ms. giving up"),this.logContext),this.emit(hi.Disconnected),this.close()},i=Date.now()-this.reconnectStart;let r=this.getNextRetryDelay({elapsedMs:i,retryCount:this.reconnectAttempts});null!==r?(e===Ho&&(r=0),this.log.debug("reconnecting in ".concat(r,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=ki.setTimeout((()=>this.attemptReconnect(t)),r)):n(i)},this.waitForRestarted=()=>new Promise(((e,t)=>{this.pcState===Ko.Connected&&e();const n=()=>{this.off(hi.Disconnected,i),e()},i=()=>{this.off(hi.Restarted,n),t()};this.once(hi.Restarted,n),this.once(hi.Disconnected,i)})),this.updateAndEmitDCBufferStatus=e=>{const t=this.isBufferStatusLow(e);"undefined"!==typeof t&&t!==this.dcBufferStatus.get(e)&&(this.dcBufferStatus.set(e,t),this.emit(hi.DCBufferStatusChanged,t,e))},this.isBufferStatusLow=e=>{const t=this.dataChannelForKind(e);if(t)return t.bufferedAmount<=t.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===po.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(qe.RR_SIGNAL_DISCONNECTED))},this.log=m(null!==(t=e.loggerName)&&void 0!==t?t:h.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new fo(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new no,this.dataProcessLock=new no,this.dcBufferStatus=new Map([[tt.LOSSY,!0],[tt.RELIABLE,!0]]),this.client.onParticipantUpdate=e=>this.emit(hi.ParticipantUpdate,e),this.client.onConnectionQuality=e=>this.emit(hi.ConnectionQualityUpdate,e),this.client.onRoomUpdate=e=>this.emit(hi.RoomUpdate,e),this.client.onSubscriptionError=e=>this.emit(hi.SubscriptionError,e),this.client.onSubscriptionPermissionUpdate=e=>this.emit(hi.SubscriptionPermissionUpdate,e),this.client.onSpeakersChanged=e=>this.emit(hi.SpeakersChanged,e),this.client.onStreamStateUpdate=e=>this.emit(hi.StreamStateChanged,e)}get logContext(){var e,t,n,i,r,o;return{room:null===(t=null===(e=this.latestJoinResponse)||void 0===e?void 0:e.room)||void 0===t?void 0:t.name,roomSid:null===(i=null===(n=this.latestJoinResponse)||void 0===n?void 0:n.room)||void 0===i?void 0:i.sid,identity:null===(o=null===(r=this.latestJoinResponse)||void 0===r?void 0:r.participant)||void 0===o?void 0:o.identity}}join(e,t,n,i){return Ct(this,void 0,void 0,(function*(){this.url=e,this.token=t,this.signalOpts=n,this.maxJoinAttempts=n.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const r=yield this.client.join(e,t,n,i);return this._isClosed=!1,this.latestJoinResponse=r,this.subscriberPrimary=r.subscriberPrimary,this.pcManager||(yield this.configure(r)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=r.clientConfiguration,r}catch(r){if(r instanceof ii&&1===r.reason&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,n,i);throw r}}))}close(){return Ct(this,void 0,void 0,(function*(){const e=yield this.closingLock.lock();if(this.isClosed)e();else try{this._isClosed=!0,this.emit(hi.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}}))}cleanupPeerConnections(){var e;return Ct(this,void 0,void 0,(function*(){yield null===(e=this.pcManager)||void 0===e?void 0:e.close(),this.pcManager=void 0;const t=e=>{e&&(e.close(),e.onbufferedamountlow=null,e.onclose=null,e.onclosing=null,e.onerror=null,e.onmessage=null,e.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0}))}cleanupClient(){return Ct(this,void 0,void 0,(function*(){yield this.client.close(),this.client.resetCallbacks()}))}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new oi("a track with the same ID has already been published");return new Promise(((t,n)=>{const i=setTimeout((()=>{delete this.pendingTrackResolvers[e.cid],n(new ii("publication of local track timed out, no response from server"))}),1e4);this.pendingTrackResolvers[e.cid]={resolve:e=>{clearTimeout(i),t(e)},reject:()=>{clearTimeout(i),n(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)}))}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(t){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:t}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return null===(e=this.reliableDCSub)||void 0===e?void 0:e.readyState}getConnectedServerAddress(){var e;return Ct(this,void 0,void 0,(function*(){return null===(e=this.pcManager)||void 0===e?void 0:e.getConnectedAddress()}))}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var t;return Ct(this,void 0,void 0,(function*(){if(this.pcManager&&this.pcManager.currentState!==zo.NEW)return;this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid;const n=this.makeRTCConfiguration(e);this.pcManager=new Jo(n,e.subscriberPrimary,this.loggerOptions),this.emit(hi.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(e,t)=>{this.client.sendIceCandidate(e,t)},this.pcManager.onPublisherOffer=e=>{this.client.sendOffer(e)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(t,n,i)=>Ct(this,void 0,void 0,(function*(){if(this.log.debug("primary PC state changed ".concat(t),this.logContext),t===zo.CONNECTED){const t=this.pcState===Ko.New;this.pcState=Ko.Connected,t&&this.emit(hi.Connected,e)}else t===zo.FAILED&&this.pcState===Ko.Connected&&(this.pcState=Ko.Disconnected,this.handleDisconnect("peerconnection failed","failed"===i?qe.RR_SUBSCRIBER_FAILED:qe.RR_PUBLISHER_FAILED))})),this.pcManager.onTrack=e=>{this.emit(hi.MediaTrackAdded,e.track,e.streams[0],e.receiver)},this.createDataChannels()}))}setupSignalClientCallbacks(){this.client.onAnswer=e=>Ct(this,void 0,void 0,(function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))})),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=e=>Ct(this,void 0,void 0,(function*(){if(!this.pcManager)return;const t=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(t)})),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:null===(t=e.track)||void 0===t?void 0:t.sid})),!this.pendingTrackResolvers[e.cid])return void this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));const{resolve:n}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],n(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(hi.LocalTrackUnpublished,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(hi.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(hi.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",qe.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{(null===e||void 0===e?void 0:e.canReconnect)?(this.fullReconnectOnNext=!0,this.handleDisconnect(Ho)):(this.emit(hi.Disconnected,null===e||void 0===e?void 0:e.reason),this.close()),this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:null===e||void 0===e?void 0:e.reason}))}}makeRTCConfiguration(e){var t;const n=Object.assign({},this.rtcConfig);if((null===(t=this.signalOpts)||void 0===t?void 0:t.e2eeEnabled)&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),n.encodedInsertableStreams=!0),e.iceServers&&!n.iceServers){const t=[];e.iceServers.forEach((e=>{const n={urls:e.urls};e.username&&(n.username=e.username),e.credential&&(n.credential=e.credential),t.push(n)})),n.iceServers=t}return e.clientConfiguration&&e.clientConfiguration.forceRelay===ze.ENABLED&&(n.iceTransportPolicy="relay"),n.sdpSemantics="unified-plan",n.continualGatheringPolicy="gather_continually",n}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(qo,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(Wo,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,t,n){if(!("getCapabilities"in RTCRtpReceiver))return;const i=RTCRtpReceiver.getCapabilities(t);if(!i)return;this.log.debug("get receiver capabilities",Object.assign(Object.assign({},this.logContext),{cap:i}));const r=[],o=[],a=[];i.codecs.forEach((e=>{const t=e.mimeType.toLowerCase();if("audio/opus"===t)return void r.push(e);t==="video/".concat(n)?"h264"!==n||e.sdpFmtpLine&&e.sdpFmtpLine.includes("profile-level-id=42e01f")?r.push(e):o.push(e):a.push(e)})),function(e){if(!jr())return!1;if(!("setCodecPreferences"in e))return!1;const t=vi();if(!(null===t||void 0===t?void 0:t.name)||!t.version)return!1;const n=Mr[t.name];return!!n&&Wr(t.version,n)>=0}(e)&&e.setCodecPreferences(r.concat(o,a))}createSender(e,t,n){return Ct(this,void 0,void 0,(function*(){if(Or()){return yield this.createTransceiverRTCRtpSender(e,t,n)}if(_r()){this.log.warn("using add-track fallback",this.logContext);return yield this.createRTCRtpSender(e.mediaStreamTrack)}throw new si("Required webRTC APIs not supported on this device")}))}createSimulcastSender(e,t,n,i){return Ct(this,void 0,void 0,(function*(){if(Or())return this.createSimulcastTransceiverSender(e,t,n,i);if(_r())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new si("Cannot stream on this device")}))}createTransceiverRTCRtpSender(e,t,n){return Ct(this,void 0,void 0,(function*(){if(!this.pcManager)throw new si("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream);const r={direction:"sendonly",streams:i};n&&(r.sendEncodings=n);const o=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,r);return e.kind===vr.Kind.Video&&t.videoCodec&&(this.setPreferredCodec(o,e.kind,t.videoCodec),e.codec=t.videoCodec),o.sender}))}createSimulcastTransceiverSender(e,t,n,i){return Ct(this,void 0,void 0,(function*(){if(!this.pcManager)throw new si("publisher is closed");const r={direction:"sendonly"};i&&(r.sendEncodings=i);const o=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,r);if(n.videoCodec)return this.setPreferredCodec(o,e.kind,n.videoCodec),e.setSimulcastTrackSender(n.videoCodec,o.sender),o.sender}))}createRTCRtpSender(e){return Ct(this,void 0,void 0,(function*(){if(!this.pcManager)throw new si("publisher is closed");return this.pcManager.addPublisherTrack(e)}))}attemptReconnect(e){var t,n,i;return Ct(this,void 0,void 0,(function*(){if(!this._isClosed)if(this.attemptingReconnect)f.warn("already attempting reconnect, returning early",this.logContext);else{(null===(t=this.clientConfiguration)||void 0===t?void 0:t.resumeConnection)!==ze.DISABLED&&(null!==(i=null===(n=this.pcManager)||void 0===n?void 0:n.currentState)&&void 0!==i?i:zo.NEW)!==zo.NEW||(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(r){this.reconnectAttempts+=1;let e=!0;r instanceof si?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:r})),e=!1):r instanceof Qo||(this.fullReconnectOnNext=!0),e?this.handleDisconnect("reconnect",qe.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(hi.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}}))}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(t){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:t}))}return null}restartConnection(e){var t,n,i;return Ct(this,void 0,void 0,(function*(){try{if(!this.url||!this.token)throw new si("could not reconnect, url or token not saved");let n;this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(hi.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Qo;n=yield this.join(null!==e&&void 0!==e?e:this.url,this.token,this.signalOpts)}catch(r){if(r instanceof ii&&0===r.reason)throw new si("could not reconnect, token might be expired");throw new Qo}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(hi.SignalRestarted,n),yield this.waitForPCReconnected(),this.client.currentState!==po.CONNECTED)throw new Qo("Signal connection got severed during reconnect");null===(t=this.regionUrlProvider)||void 0===t||t.resetAttempts(),this.emit(hi.Restarted)}catch(o){const e=yield null===(n=this.regionUrlProvider)||void 0===n?void 0:n.getNextBestRegionUrl();if(e)return void(yield this.restartConnection(e));throw null===(i=this.regionUrlProvider)||void 0===i||i.resetAttempts(),o}}))}resumeConnection(e){var t;return Ct(this,void 0,void 0,(function*(){if(!this.url||!this.token)throw new si("could not reconnect, url or token not saved");if(!this.pcManager)throw new si("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(hi.Resuming);try{this.setupSignalClientCallbacks();const t=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(t){const e=this.makeRTCConfiguration(t);this.pcManager.updateConfiguration(e)}}catch(n){let e="";if(n instanceof Error&&(e=n.message,this.log.error(n.message,Object.assign(Object.assign({},this.logContext),{error:n}))),n instanceof ii&&0===n.reason)throw new si("could not reconnect, token might be expired");if(n instanceof ii&&4===n.reason)throw n;throw new Qo(e)}if(this.emit(hi.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==po.CONNECTED)throw new Qo("Signal connection got severed during reconnect");this.client.setReconnected(),"open"===(null===(t=this.reliableDC)||void 0===t?void 0:t.readyState)&&null===this.reliableDC.id&&this.createDataChannels(),this.emit(hi.Resumed)}))}waitForPCInitialConnection(e,t){return Ct(this,void 0,void 0,(function*(){if(!this.pcManager)throw new si("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)}))}waitForPCReconnected(){return Ct(this,void 0,void 0,(function*(){this.pcState=Ko.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Nr(2e3),!this.pcManager)throw new si("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Ko.Connected}catch(e){throw this.pcState=Ko.Disconnected,new ii("could not establish PC connection, ".concat(e.message))}}))}sendDataPacket(e,t){return Ct(this,void 0,void 0,(function*(){const n=e.toBinary();yield this.ensurePublisherConnected(t);const i=this.dataChannelForKind(t);i&&i.send(n),this.updateAndEmitDCBufferStatus(t)}))}ensureDataTransportConnected(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.subscriberPrimary;var n;return Ct(this,void 0,void 0,(function*(){if(!this.pcManager)throw new si("PC manager is closed");const i=t?this.pcManager.subscriber:this.pcManager.publisher,r=t?"Subscriber":"Publisher";if(!i)throw new ii("".concat(r," connection not set"));t||this.pcManager.publisher.isICEConnected||"checking"===this.pcManager.publisher.getICEConnectionState()||this.negotiate();const o=this.dataChannelForKind(e,t);if("open"===(null===o||void 0===o?void 0:o.readyState))return;const a=(new Date).getTime()+this.peerConnectionTimeout;for(;(new Date).getTime()<a;){if(i.isICEConnected&&"open"===(null===(n=this.dataChannelForKind(e,t))||void 0===n?void 0:n.readyState))return;yield Nr(50)}throw new ii("could not establish ".concat(r," connection, state: ").concat(i.getICEConnectionState()))}))}ensurePublisherConnected(e){return Ct(this,void 0,void 0,(function*(){yield this.ensureDataTransportConnected(e,!1)}))}verifyTransport(){return!!this.pcManager&&(this.pcManager.currentState===zo.CONNECTED&&!(!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED))}negotiate(){return Ct(this,void 0,void 0,(function*(){return new Promise(((e,t)=>Ct(this,void 0,void 0,(function*(){if(!this.pcManager)return void t(new ci("PC manager is closed"));this.pcManager.requirePublisher();const n=new AbortController,i=()=>{n.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(hi.Closing,i),this.pcManager.publisher.once(Do,(e=>{const t=new Map;e.forEach((e=>{const n=e.codec.toLowerCase();var i;i=n,Ci.includes(i)&&t.set(e.payload,n)})),this.emit(hi.RTPVideoMapUpdate,t)}));try{yield this.pcManager.negotiate(n),e()}catch(r){r instanceof ci&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",qe.RR_UNKNOWN),t(r)}finally{this.off(hi.Closing,i)}}))))}))}dataChannelForKind(e,t){if(t){if(e===tt.LOSSY)return this.lossyDCSub;if(e===tt.RELIABLE)return this.reliableDCSub}else{if(e===tt.LOSSY)return this.lossyDC;if(e===tt.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var n,i;if(!this.pcManager)return void this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);const r=this.pcManager.subscriber.getLocalDescription(),o=this.pcManager.subscriber.getRemoteDescription(),a=null===(i=null===(n=this.signalOpts)||void 0===n?void 0:n.autoSubscribe)||void 0===i||i,s=new Array;e.forEach((e=>{e.isDesired!==a&&s.push(e.trackSid)})),this.client.sendSyncState(new cr({answer:r?go({sdp:r.sdp,type:r.type}):void 0,offer:o?go({sdp:o.sdp,type:o.type}):void 0,subscription:new qi({trackSids:s,subscribe:!a,participantTracks:[]}),publishTracks:Pr(t),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(t,n)=>{void 0!==(null===t||void 0===t?void 0:t.id)&&null!==t.id&&e.push(new lr({label:t.label,id:t.id,target:n}))};return t(this.dataChannelForKind(tt.LOSSY),Ni.PUBLISHER),t(this.dataChannelForKind(tt.RELIABLE),Ni.PUBLISHER),t(this.dataChannelForKind(tt.LOSSY,!0),Ni.SUBSCRIBER),t(this.dataChannelForKind(tt.RELIABLE,!0),Ni.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&ki.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){jr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){jr()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class Qo extends Error{}class $o{constructor(e,t){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return Vr(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return Ct(this,void 0,void 0,(function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const t=this.regionSettings.regions.filter((e=>!this.attemptedRegions.find((t=>t.url===e.url))));if(t.length>0){const e=t[0];return this.attemptedRegions.push(e),f.debug("next region: ".concat(e.region)),e.url}return null}))}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return Ct(this,void 0,void 0,(function*(){const t=yield fetch("".concat((n=this.serverUrl,"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});var n;if(t.ok){const e=yield t.json();return this.lastUpdateAt=Date.now(),e}throw new ii("Could not fetch region settings: ".concat(t.statusText),401===t.status?0:void 0,t.status)}))}}const Yo=2e3;function Xo(e,t){if(!t)return 0;let n,i;return"bytesReceived"in e?(n=e.bytesReceived,i=t.bytesReceived):"bytesSent"in e&&(n=e.bytesSent,i=t.bytesSent),void 0===n||void 0===i||void 0===e.timestamp||void 0===t.timestamp?0:8*(n-i)*1e3/(e.timestamp-t.timestamp)}class Zo extends so{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;super(e,vr.Kind.Audio,t,n,r),this.stopOnMute=!1,this.monitorSender=()=>Ct(this,void 0,void 0,(function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(t){return void this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:t}))}e&&this.prevStats&&(this._currentBitrate=Xo(e,this.prevStats)),this.prevStats=e})),this.audioContext=i,this.checkForSilence()}setDeviceId(e){return Ct(this,void 0,void 0,(function*(){return this._constraints.deviceId===e||(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||io(e)===this.mediaStreamTrack.getSettings().deviceId)}))}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return Ct(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{return this.source===vr.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{t()}}))}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return Ct(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{const t=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==io(this._constraints.deviceId);return this.source!==vr.Source.Microphone||!this.stopOnMute&&"ended"!==this._mediaStreamTrack.readyState&&!t||this.isUserProvided||(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}}))}restartTrack(e){return Ct(this,void 0,void 0,(function*(){let t;if(e){const n=wr({audio:e});"boolean"!==typeof n.audio&&(t=n.audio)}yield this.restart(t)}))}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return Ct(this,void 0,void 0,(function*(){const n=yield t.restart.call(this,e);return this.checkForSilence(),n}))}startMonitor(){jr()&&(this.monitorInterval||(this.monitorInterval=setInterval((()=>{this.monitorSender()}),Yo)))}setProcessor(e){var t;return Ct(this,void 0,void 0,(function*(){const n=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");const n={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(n),this.processor=e,this.processor.processedTrack&&(yield null===(t=this.sender)||void 0===t?void 0:t.replaceTrack(this.processor.processedTrack))}finally{n()}}))}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return Ct(this,void 0,void 0,(function*(){if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;let t;return(yield this.sender.getStats()).forEach((e=>{"outbound-rtp"===e.type&&(t={type:"audio",streamId:e.id,packetsSent:e.packetsSent,packetsLost:e.packetsLost,bytesSent:e.bytesSent,timestamp:e.timestamp,roundTripTime:e.roundTripTime,jitter:e.jitter})})),t}))}checkForSilence(){return Ct(this,void 0,void 0,(function*(){const e=yield function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return Ct(this,void 0,void 0,(function*(){const n=Cr();if(n){const i=n.createAnalyser();i.fftSize=2048;const r=i.frequencyBinCount,o=new Uint8Array(r);n.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(i),yield Nr(t),i.getByteTimeDomainData(o);const a=o.some((e=>128!==e&&0!==e));return n.close(),!a}return!1}))}(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(pi.AudioSilenceDetected)),e}))}}function ea(e,t,n){switch(e.kind){case"audio":return new Zo(e,t,!1,void 0,n);case"video":return new ha(e,t,!1,n);default:throw new oi("unsupported track type: ".concat(e.kind))}}const ta=Object.values(Pi),na=Object.values(xi),ia=Object.values(Ri),ra=[Pi.h180,Pi.h360],oa=[xi.h180,xi.h360],aa=["q","h","f"];function sa(e,t,n,i){var r,o;let a=null===i||void 0===i?void 0:i.videoEncoding;e&&(a=null===i||void 0===i?void 0:i.screenShareEncoding);const s=null===i||void 0===i?void 0:i.simulcast,c=null===i||void 0===i?void 0:i.scalabilityMode,l=null===i||void 0===i?void 0:i.videoCodec;if(!a&&!s&&!c||!t||!n)return[{}];a||(a=function(e,t,n,i){const r=function(e,t,n){if(e)return ia;const i=t>n?t/n:n/t;if(Math.abs(i-16/9)<Math.abs(i-4/3))return ta;return na}(e,t,n);let{encoding:o}=r[0];const a=Math.max(t,n);for(let s=0;s<r.length;s+=1){const e=r[s];if(o=e.encoding,e.width>=a)break}if(i)switch(i){case"av1":o=Object.assign({},o),o.maxBitrate=.7*o.maxBitrate;break;case"vp9":o=Object.assign({},o),o.maxBitrate=.85*o.maxBitrate}return o}(e,t,n,l),f.debug("using video encoding",a));const u=new Si(t,n,a.maxBitrate,a.maxFramerate,a.priority);if(c&&Ir(l)){f.debug("using svc with scalabilityMode ".concat(c));const e=new da(c),t=[];if(e.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));for(let n=0;n<e.spatial;n+=1)t.push({rid:aa[2-n],maxBitrate:a.maxBitrate/Math.pow(3,n),maxFramerate:u.encoding.maxFramerate});return t[0].scalabilityMode=c,f.debug("encodings",t),t}if(!s)return[a];let d,h=[];if(h=e?null!==(r=ua(null===i||void 0===i?void 0:i.screenShareSimulcastLayers))&&void 0!==r?r:ca(e,u):null!==(o=ua(null===i||void 0===i?void 0:i.videoSimulcastLayers))&&void 0!==o?o:ca(e,u),h.length>0){const e=h[0];h.length>1&&([,d]=h);const i=Math.max(t,n);if(i>=960&&d)return la(t,n,[e,d,u]);if(i>=480)return la(t,n,[e,u])}return la(t,n,[u])}function ca(e,t){if(e)return[{scaleResolutionDownBy:2,fps:(n=t).encoding.maxFramerate}].map((e=>{var t,i;return new Si(Math.floor(n.width/e.scaleResolutionDownBy),Math.floor(n.height/e.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(e.scaleResolutionDownBy,2)*((null!==(t=n.encoding.maxFramerate)&&void 0!==t?t:30)/(null!==(i=e.fps)&&void 0!==i?i:30))))),e.fps,n.encoding.priority)}));var n;const{width:i,height:r}=t,o=i>r?i/r:r/i;return Math.abs(o-16/9)<Math.abs(o-4/3)?ra:oa}function la(e,t,n){const i=[];if(n.forEach(((n,r)=>{if(r>=aa.length)return;const o=Math.min(e,t),a={rid:aa[r],scaleResolutionDownBy:Math.max(1,o/Math.min(n.width,n.height)),maxBitrate:n.encoding.maxBitrate};n.encoding.maxFramerate&&(a.maxFramerate=n.encoding.maxFramerate);const s=Lr()||0===r;n.encoding.priority&&s&&(a.priority=n.encoding.priority,a.networkPriority=n.encoding.priority),i.push(a)})),Br()&&"ios"===Jr()){let e;i.forEach((t=>{e?t.maxFramerate&&t.maxFramerate>e&&(e=t.maxFramerate):e=t.maxFramerate}));let t=!0;i.forEach((n=>{var i;n.maxFramerate!=e&&(t&&(t=!1,f.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),f.info('Setting framerate of encoding "'.concat(null!==(i=n.rid)&&void 0!==i?i:"",'" to ').concat(e)),n.maxFramerate=e)}))}return i}function ua(e){if(e)return e.sort(((e,t)=>{const{encoding:n}=e,{encoding:i}=t;return n.maxBitrate>i.maxBitrate?1:n.maxBitrate<i.maxBitrate?-1:n.maxBitrate===i.maxBitrate&&n.maxFramerate&&i.maxFramerate?n.maxFramerate>i.maxFramerate?1:-1:0}))}class da{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat(null!==(e=this.suffix)&&void 0!==e?e:"")}}class ha extends so{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;super(e,vr.Kind.Video,t,n,i),this.simulcastCodecs=new Map,this.monitorSender=()=>Ct(this,void 0,void 0,(function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(n){return void this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:n}))}const t=new Map(e.map((e=>[e.rid,e])));if(this.prevStats){let e=0;t.forEach(((t,n)=>{var i;const r=null===(i=this.prevStats)||void 0===i?void 0:i.get(n);e+=Xo(t,r)})),this._currentBitrate=e}this.prevStats=t})),this.senderLock=new no}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!jr())return;const n=null===(t=this.sender)||void 0===t?void 0:t.getParameters();n&&(this.encodings=n.encodings),this.monitorInterval||(this.monitorInterval=setInterval((()=>{this.monitorSender()}),Yo))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach((e=>{e.mediaStreamTrack.stop()})),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var t,n,i,r,o;return Ct(this,void 0,void 0,(function*(){yield e.pauseUpstream.call(this);try{for(var a,s=!0,c=Et(this.simulcastCodecs.values());a=yield c.next(),!(t=a.done);s=!0){r=a.value,s=!1;const e=r;yield null===(o=e.sender)||void 0===o?void 0:o.replaceTrack(null)}}catch(l){n={error:l}}finally{try{s||t||!(i=c.return)||(yield i.call(c))}finally{if(n)throw n.error}}}))}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var t,n,i,r,o;return Ct(this,void 0,void 0,(function*(){yield e.resumeUpstream.call(this);try{for(var a,s=!0,c=Et(this.simulcastCodecs.values());a=yield c.next(),!(t=a.done);s=!0){r=a.value,s=!1;const e=r;yield null===(o=e.sender)||void 0===o?void 0:o.replaceTrack(e.mediaStreamTrack)}}catch(l){n={error:l}}finally{try{s||t||!(i=c.return)||(yield i.call(c))}finally{if(n)throw n.error}}}))}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return Ct(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{return this.source!==vr.Source.Camera||this.isUserProvided||(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{t()}}))}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return Ct(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{return this.source!==vr.Source.Camera||this.isUserProvided||(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}}))}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return Ct(this,void 0,void 0,(function*(){if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return[];const t=[],n=yield this.sender.getStats();return n.forEach((e=>{var i;if("outbound-rtp"===e.type){const r={type:"video",streamId:e.id,frameHeight:e.frameHeight,frameWidth:e.frameWidth,firCount:e.firCount,pliCount:e.pliCount,nackCount:e.nackCount,packetsSent:e.packetsSent,bytesSent:e.bytesSent,framesSent:e.framesSent,timestamp:e.timestamp,rid:null!==(i=e.rid)&&void 0!==i?i:e.id,retransmittedPacketsSent:e.retransmittedPacketsSent,qualityLimitationReason:e.qualityLimitationReason,qualityLimitationResolutionChanges:e.qualityLimitationResolutionChanges},o=n.get(e.remoteId);o&&(r.jitter=o.jitter,r.packetsLost=o.packetsLost,r.roundTripTime=o.roundTripTime),t.push(r)}})),t}))}setPublishingQuality(e){const t=[];for(let n=Be.LOW;n<=Be.HIGH;n+=1)t.push(new nr({quality:n,enabled:n<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(t)}setDeviceId(e){return Ct(this,void 0,void 0,(function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===io(e)||(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||io(e)===this._mediaStreamTrack.getSettings().deviceId)}))}restartTrack(e){var t,n,i,r;return Ct(this,void 0,void 0,(function*(){let o;if(e){const t=wr({video:e});"boolean"!==typeof t.video&&(o=t.video)}yield this.restart(o);try{for(var a,s=!0,c=Et(this.simulcastCodecs.values());a=yield c.next(),!(t=a.done);s=!0){r=a.value,s=!1;const e=r;e.sender&&(e.mediaStreamTrack=this.mediaStreamTrack.clone(),yield e.sender.replaceTrack(e.mediaStreamTrack))}}catch(l){n={error:l}}finally{try{s||t||!(i=c.return)||(yield i.call(c))}finally{if(n)throw n.error}}}))}setProcessor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,r,o,a,s,c;return Ct(this,void 0,void 0,(function*(){if(yield n.setProcessor.call(this,e,t),null===(s=this.processor)||void 0===s?void 0:s.processedTrack)try{for(var l,u=!0,d=Et(this.simulcastCodecs.values());l=yield d.next(),!(i=l.done);u=!0){a=l.value,u=!1;const e=a;yield null===(c=e.sender)||void 0===c?void 0:c.replaceTrack(this.processor.processedTrack)}}catch(h){r={error:h}}finally{try{u||i||!(o=d.return)||(yield o.call(d))}finally{if(r)throw r.error}}}))}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const n={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,n),n}setSimulcastTrackSender(e,t){const n=this.simulcastCodecs.get(e);n&&(n.sender=t,setTimeout((()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)}),5e3))}setPublishingCodecs(e){var t,n,i,r,o,a,s;return Ct(this,void 0,void 0,(function*(){if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const c=[];try{for(t=!0,n=Et(e);i=yield n.next(),!(r=i.done);t=!0){s=i.value,t=!1;const e=s;if(this.codec&&this.codec!==e.codec){const t=this.simulcastCodecs.get(e.codec);if(this.log.debug("try setPublishingCodec for ".concat(e.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:t})),t&&t.sender)t.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(e.codec),this.logContext),yield pa(t.sender,t.encodings,e.qualities,this.senderLock,this.log,this.logContext));else for(const n of e.qualities)if(n.enabled){c.push(e.codec);break}}else yield this.setPublishingLayers(e.qualities)}}catch(l){o={error:l}}finally{try{t||r||!(a=n.return)||(yield a.call(n))}finally{if(o)throw o.error}}return c}))}setPublishingLayers(e){return Ct(this,void 0,void 0,(function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),this.sender&&this.encodings&&(yield pa(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))}))}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Ct(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),Fr()&&this.isInBackground&&this.source===vr.Source.Camera&&(this._mediaStreamTrack.enabled=!1)}))}}function pa(e,t,n,i,r,o){return Ct(this,void 0,void 0,(function*(){const a=yield i.lock();r.debug("setPublishingLayersForSender",Object.assign(Object.assign({},o),{sender:e,qualities:n,senderEncodings:t}));try{const i=e.getParameters(),{encodings:a}=i;if(!a)return;if(a.length!==t.length)return void r.warn("cannot set publishing layers, encodings mismatch");let s=!1;!1&&a[0].scalabilityMode||a.forEach(((e,i)=>{var a;let c=null!==(a=e.rid)&&void 0!==a?a:"";""===c&&(c="q");const l=fa(c),u=n.find((e=>e.quality===l));u&&e.active!==u.enabled&&(s=!0,e.active=u.enabled,r.debug("setting layer ".concat(u.quality," to ").concat(e.active?"enabled":"disabled"),o),Lr()&&(u.enabled?(e.scaleResolutionDownBy=t[i].scaleResolutionDownBy,e.maxBitrate=t[i].maxBitrate,e.maxFrameRate=t[i].maxFrameRate):(e.scaleResolutionDownBy=4,e.maxBitrate=10,e.maxFrameRate=2)))})),s&&(i.encodings=a,r.debug("setting encodings",Object.assign(Object.assign({},o),{encodings:i.encodings})),yield e.setParameters(i))}finally{a()}}))}function fa(e){switch(e){case"f":default:return Be.HIGH;case"h":return Be.MEDIUM;case"q":return Be.LOW}}function ma(e,t,n,i){if(!n)return[new st({quality:Be.HIGH,width:e,height:t,bitrate:0,ssrc:0})];if(i){const i=n[0].scalabilityMode,r=new da(i),o=[];for(let a=0;a<r.spatial;a+=1)o.push(new st({quality:Be.HIGH-a,width:Math.ceil(e/Math.pow(2,a)),height:Math.ceil(t/Math.pow(2,a)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return o}return n.map((n=>{var i,r,o;const a=null!==(i=n.scaleResolutionDownBy)&&void 0!==i?i:1;let s=fa(null!==(r=n.rid)&&void 0!==r?r:"");return new st({quality:s,width:Math.ceil(e/a),height:Math.ceil(t/a),bitrate:null!==(o=n.maxBitrate)&&void 0!==o?o:0,ssrc:0})}))}class ga extends vr{constructor(e,t,n,i,r){super(e,n,r),this.sid=t,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?pi.Muted:pi.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=n=>{n.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver=void 0,this._currentBitrate=0,this.emit(pi.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return Ct(this,void 0,void 0,(function*(){if(!(null===(e=this.receiver)||void 0===e?void 0:e.getStats))return;return yield this.receiver.getStats()}))}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval((()=>this.monitorReceiver()),Yo))}}class va extends ga{constructor(e,t,n,i,r,o){super(e,t,vr.Kind.Audio,n,o),this.monitorReceiver=()=>Ct(this,void 0,void 0,(function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=Xo(e,this.prevStats)),this.prevStats=e})),this.audioContext=i,this.webAudioPluginNodes=[],r&&(this.sinkId=r.deviceId)}setVolume(e){var t;for(const n of this.attachedElements)this.audioContext?null===(t=this.gainNode)||void 0===t||t.gain.setTargetAtTime(e,0,.1):n.volume=e;Br()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Br())return 1;let e=0;return this.attachedElements.forEach((t=>{t.volume>e&&(e=t.volume)})),e}setSinkId(e){return Ct(this,void 0,void 0,(function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map((t=>{if(Dr(t))return t.setSinkId(e)})))}))}attach(e){const t=0===this.attachedElements.length;return e?super.attach(e):e=super.attach(),this.sinkId&&Dr(e)&&e.setSinkId(this.sinkId),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let n=this.sourceNode;this.webAudioPluginNodes.forEach((e=>{n.connect(e),n=e})),this.gainNode=e.createGain(),n.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),"running"!==e.state&&e.resume().then((()=>{"running"!==e.state&&this.emit(pi.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))})).catch((e=>{this.emit(pi.AudioPlaybackFailed,e)}))}disconnectWebAudio(){var e,t;null===(e=this.gainNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return Ct(this,void 0,void 0,(function*(){if(!this.receiver||!this.receiver.getStats)return;let e;return(yield this.receiver.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(e={type:"audio",timestamp:t.timestamp,jitter:t.jitter,bytesReceived:t.bytesReceived,concealedSamples:t.concealedSamples,concealmentEvents:t.concealmentEvents,silentConcealedSamples:t.silentConcealedSamples,silentConcealmentEvents:t.silentConcealmentEvents,totalAudioEnergy:t.totalAudioEnergy,totalSamplesDuration:t.totalSamplesDuration})})),e}))}}class ya extends ga{constructor(e,t,n,i,r){super(e,t,vr.Kind.Video,n,r),this.elementInfos=[],this.monitorReceiver=()=>Ct(this,void 0,void 0,(function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=Xo(e,this.prevStats)),this.prevStats=e})),this.debouncedHandleResize=fi((()=>{this.updateDimensions()}),100),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return void 0!==this.adaptiveStreamSettings}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach((t=>{e?br(this._mediaStreamTrack,t):yr(this._mediaStreamTrack,t)}))}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&void 0===this.elementInfos.find((t=>t.element===e))){const t=new ba(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&void 0===this.elementInfos.find((t=>t===e))?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream)return void this.log.warn("stopObservingElementInfo ignored",this.logContext);const t=this.elementInfos.filter((t=>t===e));for(const n of t)n.stopObserving();this.elementInfos=this.elementInfos.filter((t=>t!==e)),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const n of t)this.stopObservingElement(n);return t}getDecoderImplementation(){var e;return null===(e=this.prevStats)||void 0===e?void 0:e.decoderImplementation}getReceiverStats(){return Ct(this,void 0,void 0,(function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,n="",i=new Map;return e.forEach((e=>{"inbound-rtp"===e.type?(n=e.codecId,t={type:"video",framesDecoded:e.framesDecoded,framesDropped:e.framesDropped,framesReceived:e.framesReceived,packetsReceived:e.packetsReceived,packetsLost:e.packetsLost,frameWidth:e.frameWidth,frameHeight:e.frameHeight,pliCount:e.pliCount,firCount:e.firCount,nackCount:e.nackCount,jitter:e.jitter,timestamp:e.timestamp,bytesReceived:e.bytesReceived,decoderImplementation:e.decoderImplementation}):"codec"===e.type&&i.set(e.id,e)})),t&&""!==n&&i.get(n)&&(t.mimeType=i.get(n).mimeType),t}))}stopObservingElement(e){const t=this.elementInfos.filter((t=>t.element===e));for(const n of t)this.stopObservingElementInfo(n)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Ct(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()}))}updateVisibility(){var e,t;const n=this.elementInfos.reduce(((e,t)=>Math.max(e,t.visibilityChangedAt||0)),0),i=!(null!==(t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pauseVideoInBackground)&&void 0!==t&&!t)&&this.isInBackground,r=this.elementInfos.some((e=>e.pictureInPicture)),o=this.elementInfos.some((e=>e.visible))&&!i||r;this.lastVisible!==o&&(!o&&Date.now()-n<100?ki.setTimeout((()=>{this.updateVisibility()}),100):(this.lastVisible=o,this.emit(pi.VisibilityChanged,o,this)))}updateDimensions(){var e,t;let n=0,i=0;const r=this.getPixelDensity();for(const o of this.elementInfos){const e=o.width()*r,t=o.height()*r;e+t>n+i&&(n=e,i=t)}(null===(e=this.lastDimensions)||void 0===e?void 0:e.width)===n&&(null===(t=this.lastDimensions)||void 0===t?void 0:t.height)===i||(this.lastDimensions={width:n,height:i},this.emit(pi.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pixelDensity;if("screen"===t)return qr();if(!t){return qr()>2?2:1}return t}}class ba{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=e=>{var t;const{target:n,isIntersecting:i}=e;n===this.element&&(this.isIntersecting=i,this.visibilityChangedAt=Date.now(),null===(t=this.handleVisibilityChanged)||void 0===t||t.call(this))},this.onEnterPiP=()=>{var e;this.isPiP=!0,null===(e=this.handleVisibilityChanged)||void 0===e||e.call(this)},this.onLeavePiP=()=>{var e;this.isPiP=!1,null===(e=this.handleVisibilityChanged)||void 0===e||e.call(this)},this.element=e,this.isIntersecting=null!==t&&void 0!==t?t:ka(e),this.isPiP=jr()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=ka(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;null===(e=this.handleResize)||void 0===e||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,Yr().observe(this.element),Qr().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,t;null===(e=Yr())||void 0===e||e.unobserve(this.element),null===(t=Qr())||void 0===t||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function ka(e){let t=e.offsetTop,n=e.offsetLeft;const i=e.offsetWidth,r=e.offsetHeight,{hidden:o}=e,{opacity:a,display:s}=getComputedStyle(e);for(;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+r>window.pageYOffset&&n+i>window.pageXOffset&&!o&&(""===a||parseFloat(a)>0)&&"none"!==s}class Sa extends zt.EventEmitter{constructor(e,t,n,i){var r;super(),this.metadataMuted=!1,this.encryption=et.NONE,this.log=f,this.handleMuted=()=>{this.emit(pi.Muted)},this.handleUnmuted=()=>{this.emit(pi.Unmuted)},this.log=m(null!==(r=null===i||void 0===i?void 0:i.loggerName)&&void 0!==r?r:h.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=n,this.source=vr.Source.Unknown}setTrack(e){this.track&&(this.track.off(pi.Muted,this.handleMuted),this.track.off(pi.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(pi.Muted,this.handleMuted),e.on(pi.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),xr(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return void 0!==this.track}get isEncrypted(){return this.encryption!==et.NONE}get audioTrack(){if(this.track instanceof Zo||this.track instanceof va)return this.track}get videoTrack(){if(this.track instanceof ha||this.track instanceof ya)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=vr.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===vr.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}!function(e){var t,n;(t=e.SubscriptionStatus||(e.SubscriptionStatus={})).Desired="desired",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",(n=e.PermissionStatus||(e.PermissionStatus={})).Allowed="allowed",n.NotAllowed="not_allowed"}(Sa||(Sa={}));class wa extends Sa{get isUpstreamPaused(){var e;return null===(e=this.track)||void 0===e?void 0:e.isUpstreamPaused}constructor(e,t,n,i){super(e,t.sid,t.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(pi.Ended)},this.updateInfo(t),this.setTrack(n)}setTrack(e){this.track&&this.track.off(pi.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(pi.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return Ct(this,void 0,void 0,(function*(){return null===(e=this.track)||void 0===e?void 0:e.mute()}))}unmute(){var e;return Ct(this,void 0,void 0,(function*(){return null===(e=this.track)||void 0===e?void 0:e.unmute()}))}pauseUpstream(){var e;return Ct(this,void 0,void 0,(function*(){yield null===(e=this.track)||void 0===e?void 0:e.pauseUpstream()}))}resumeUpstream(){var e;return Ct(this,void 0,void 0,(function*(){yield null===(e=this.track)||void 0===e?void 0:e.resumeUpstream()}))}}var Ca,Ta;!function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Lost="lost",e.Unknown="unknown"}(Ca||(Ca={}));class Ea extends zt.EventEmitter{get logContext(){var e,t;return Object.assign(Object.assign({},null===(t=null===(e=this.loggerOptions)||void 0===e?void 0:e.loggerContextCb)||void 0===t?void 0:t.call(e)),{participantSid:this.sid,participantId:this.identity})}get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every((e=>e.isEncrypted))}get isAgent(){var e,t;return null!==(t=null===(e=this.permissions)||void 0===e?void 0:e.agent)&&void 0!==t&&t}constructor(e,t,n,i,r){var o;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Ca.Unknown,this.log=f,this.log=m(null!==(o=null===r||void 0===r?void 0:r.loggerName)&&void 0!==o?o:h.Participant),this.loggerOptions=r,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=n,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,t]of this.tracks)if(t.source===e)return t}getTrackByName(e){for(const[,t]of this.tracks)if(t.trackName===e)return t}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrack(vr.Source.Camera);return!(null===(e=null===t||void 0===t?void 0:t.isMuted)||void 0===e||e)}get isMicrophoneEnabled(){var e;const t=this.getTrack(vr.Source.Microphone);return!(null===(e=null===t||void 0===t?void 0:t.isMuted)||void 0===e||e)}get isScreenShareEnabled(){return!!this.getTrack(vr.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(1e3*Number.parseInt(this.participantInfo.joinedAt.toString())):new Date}updateInfo(e){return!(this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version)&&(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const t=this.metadata!==e,n=this.metadata;this.metadata=e,t&&this.emit(di.ParticipantMetadataChanged,n)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(di.ParticipantNameChanged,e)}setPermissions(e){var t,n,i,r,o;const a=this.permissions,s=e.canPublish!==(null===(t=this.permissions)||void 0===t?void 0:t.canPublish)||e.canSubscribe!==(null===(n=this.permissions)||void 0===n?void 0:n.canSubscribe)||e.canPublishData!==(null===(i=this.permissions)||void 0===i?void 0:i.canPublishData)||e.hidden!==(null===(r=this.permissions)||void 0===r?void 0:r.hidden)||e.recorder!==(null===(o=this.permissions)||void 0===o?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some(((e,t)=>{var n;return e!==(null===(n=this.permissions)||void 0===n?void 0:n.canPublishSources[t])}));return this.permissions=e,s&&this.emit(di.ParticipantPermissionsChanged,a),s}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(di.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=function(e){switch(e){case Ve.EXCELLENT:return Ca.Excellent;case Ve.GOOD:return Ca.Good;case Ve.POOR:return Ca.Poor;case Ve.LOST:return Ca.Lost;default:return Ca.Unknown}}(e),t!==this._connectionQuality&&this.emit(di.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach((t=>(t.track instanceof va||t.track instanceof Zo)&&t.track.setAudioContext(e)))}addTrackPublication(e){e.on(pi.Muted,(()=>{this.emit(di.TrackMuted,e)})),e.on(pi.Unmuted,(()=>{this.emit(di.TrackUnmuted,e)}));const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case vr.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case vr.Kind.Video:this.videoTracks.set(e.trackSid,e)}}}class Pa extends Sa{constructor(e,t,n,i){super(e,t.sid,t.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=Be.HIGH,this.handleEnded=e=>{this.setTrack(void 0),this.emit(pi.Ended,e)},this.handleVisibilityChange=e=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(e),this.logContext),this.disabled=!e,this.emitTrackUpdate()},this.handleVideoDimensionsChange=e=>{this.log.debug("adaptivestream video dimensions ".concat(e.width,"x").concat(e.height),this.logContext),this.videoDimensions=e,this.emitTrackUpdate()},this.subscribed=n,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new qi({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new ht({participantSid:"",trackSids:[this.trackSid]})]});this.emit(pi.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(n)}get subscriptionStatus(){return!1===this.subscribed?Sa.SubscriptionStatus.Unsubscribed:super.isSubscribed?Sa.SubscriptionStatus.Subscribed:Sa.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Sa.PermissionStatus.Allowed:Sa.PermissionStatus.NotAllowed}get isSubscribed(){return!1!==this.subscribed&&super.isSubscribed}get isDesired(){return!1!==this.subscribed}get isEnabled(){return!this.disabled}setEnabled(e){this.isManualOperationAllowed()&&this.disabled!==!e&&(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){this.isManualOperationAllowed()&&this.currentVideoQuality!==e&&(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,n;this.isManualOperationAllowed()&&((null===(t=this.videoDimensions)||void 0===t?void 0:t.width)===e.width&&(null===(n=this.videoDimensions)||void 0===n?void 0:n.height)===e.height||(this.track instanceof ya&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof ya&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const t=this.subscriptionStatus,n=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(pi.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(pi.VisibilityChanged,this.handleVisibilityChange),i.off(pi.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(pi.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(pi.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(pi.VisibilityChanged,this.handleVisibilityChange),e.on(pi.Ended,this.handleEnded),this.emit(pi.Subscribed,e)),this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(pi.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?pi.Muted:pi.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(pi.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(pi.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===vr.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):!!this.isDesired||(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof ya&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new Wi({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):void 0!==this.currentVideoQuality?e.quality=this.currentVideoQuality:e.quality=Be.HIGH,this.emit(pi.UpdateSettings,e)}}class xa extends Ea{static fromParticipantInfo(e,t){return new xa(e,t.sid,t.identity,t.name,t.metadata)}constructor(e,t,n,i,r,o){super(t,n||"",i,r,o),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(pi.UpdateSettings,(t=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),xr(e))),this.signalClient.sendUpdateTrackSettings(t)})),e.on(pi.UpdateSubscription,(e=>{e.participantTracks.forEach((e=>{e.participantSid=this.sid})),this.signalClient.sendUpdateSubscription(e)})),e.on(pi.SubscriptionPermissionChanged,(t=>{this.emit(di.TrackSubscriptionPermissionChanged,e,t)})),e.on(pi.SubscriptionStatusChanged,(t=>{this.emit(di.TrackSubscriptionStatusChanged,e,t)})),e.on(pi.Subscribed,(t=>{this.emit(di.TrackSubscribed,t,e)})),e.on(pi.Unsubscribed,(t=>{this.emit(di.TrackUnsubscribed,t,e)})),e.on(pi.SubscriptionFailed,(t=>{this.emit(di.TrackSubscriptionFailed,e.trackSid,t)}))}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vr.Source.Microphone;this.volumeMap.set(t,e);const n=this.getTrack(t);n&&n.track&&n.track.setVolume(e)}getVolume(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vr.Source.Microphone;const t=this.getTrack(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,n,i,r,o){let a=this.getTrackPublication(t);if(a||t.startsWith("TR")||this.tracks.forEach((t=>{a||e.kind!==t.kind.toString()||(a=t)})),!a)return 0===o?(this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),void this.emit(di.TrackSubscriptionFailed,t)):(void 0===o&&(o=20),void setTimeout((()=>{this.addSubscribedMediaTrack(e,t,n,i,r,o-1)}),150));if("ended"===e.readyState)return this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),xr(a))),void this.emit(di.TrackSubscriptionFailed,t);let s;return s="video"===e.kind?new ya(e,t,i,r):new va(e,t,i,this.audioContext,this.audioOutput),s.source=a.source,s.isMuted=a.isMuted,s.setMediaStream(n),s.start(),a.setTrack(s),this.volumeMap.has(a.source)&&s instanceof va&&s.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,n=new Map;return e.tracks.forEach((e=>{var i,r;let o=this.getTrackPublication(e.sid);if(o)o.updateInfo(e);else{const t=vr.kindFromProto(e.type);if(!t)return;o=new Pa(t,e,null===(i=this.signalClient.connectOptions)||void 0===i?void 0:i.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:null===(r=this.loggerOptions)||void 0===r?void 0:r.loggerName}),o.updateInfo(e),n.set(e.sid,o);const a=Array.from(this.tracks.values()).find((e=>e.source===(null===o||void 0===o?void 0:o.source)));a&&o.source!==vr.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(o.source),Object.assign(Object.assign({},this.logContext),{oldTrack:xr(a),newTrack:xr(o)})),this.addTrackPublication(o)}t.set(e.sid,o)})),this.tracks.forEach((e=>{t.has(e.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),xr(e))),this.unpublishTrack(e.trackSid,!0))})),n.forEach((e=>{this.emit(di.TrackPublished,e)})),!0}unpublishTrack(e,t){const n=this.tracks.get(e);if(!n)return;const{track:i}=n;switch(i&&(i.stop(),n.setTrack(void 0)),this.tracks.delete(e),n.kind){case vr.Kind.Audio:this.audioTracks.delete(e);break;case vr.Kind.Video:this.videoTracks.delete(e)}t&&this.emit(di.TrackUnpublished,n)}setAudioOutput(e){return Ct(this,void 0,void 0,(function*(){this.audioOutput=e;const t=[];this.audioTracks.forEach((n=>{var i;n.track instanceof va&&t.push(n.track.setSinkId(null!==(i=e.deviceId)&&void 0!==i?i:"default"))})),yield Promise.all(t)}))}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:n})),super.emit(e,...n)}}class Ra extends Ea{constructor(e,t,n,i){super(e,t,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=et.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new to)},this.handleReconnected=()=>{var e,t;null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var e,t;this.reconnectFuture&&(this.reconnectFuture.promise.catch((e=>this.log.warn(e.message,this.logContext))),null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.reject)||void 0===t||t.call(e,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map((e=>function(e){var t,n,i;if(!e.participantSid&&!e.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new or({participantIdentity:null!==(t=e.participantIdentity)&&void 0!==t?t:"",participantSid:null!==(n=e.participantSid)&&void 0!==n?n:"",allTracks:null!==(i=e.allowAll)&&void 0!==i&&i,trackSids:e.allowedTrackSids||[]})}(e))))},this.onTrackUnmuted=e=>{this.onTrackMuted(e,e.isUpstreamPaused)},this.onTrackMuted=(e,t)=>{void 0===t&&(t=!0),e.sid?this.engine.updateMuteStatus(e.sid,t):this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),xr(e)))},this.onTrackUpstreamPaused=e=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),xr(e))),this.onTrackMuted(e,!0)},this.onTrackUpstreamResumed=e=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),xr(e))),this.onTrackMuted(e,e.isMuted)},this.handleSubscribedQualityUpdate=e=>Ct(this,void 0,void 0,(function*(){var t,n,i,r,o,a;if(!(null===(o=this.roomOptions)||void 0===o?void 0:o.dynacast))return;const s=this.videoTracks.get(e.trackSid);if(s)if(e.subscribedCodecs.length>0){if(!s.videoTrack)return;const o=yield s.videoTrack.setPublishingCodecs(e.subscribedCodecs);try{for(var c,l=!0,u=Et(o);!(t=(c=yield u.next()).done);l=!0){r=c.value,l=!1;const e=r;Ti(e)&&(this.log.debug("publish ".concat(e," for ").concat(s.videoTrack.sid),Object.assign(Object.assign({},this.logContext),xr(s))),yield this.publishAdditionalCodecForTrack(s.videoTrack,e,s.options))}}catch(d){n={error:d}}finally{try{l||t||!(i=u.return)||(yield i.call(u))}finally{if(n)throw n.error}}}else e.subscribedQualities.length>0&&(yield null===(a=s.videoTrack)||void 0===a?void 0:a.setPublishingLayers(e.subscribedQualities));else this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:e.trackSid}))})),this.handleLocalTrackUnpublished=e=>{const t=this.tracks.get(e.trackSid);t?this.unpublishTrack(t.track):this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:e.trackSid}))},this.handleTrackEnded=e=>Ct(this,void 0,void 0,(function*(){if(e.source===vr.Source.ScreenShare||e.source===vr.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),xr(e))),this.unpublishTrack(e);else if(e.isUserProvided)yield e.mute();else if(e instanceof Zo||e instanceof ha)try{if(jr())try{const t=yield null===navigator||void 0===navigator?void 0:navigator.permissions.query({name:e.source===vr.Source.Camera?"camera":"microphone"});if(t&&"denied"===t.state)throw this.log.warn("user has revoked access to ".concat(e.source),Object.assign(Object.assign({},this.logContext),xr(e))),t.onchange=()=>{"denied"!==t.state&&(e.isMuted||e.restartTrack(),t.onchange=null)},new Error("GetUserMedia Permission denied")}catch(t){}e.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),xr(e))),yield e.restartTrack())}catch(t){this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),xr(e))),yield e.mute()}})),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=n,this.roomOptions=i,this.setupEngine(n),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==et.NONE}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setupEngine(e){this.engine=e,this.engine.on(hi.RemoteMute,((e,t)=>{const n=this.tracks.get(e);n&&n.track&&(t?n.mute():n.unmute())})),this.engine.on(hi.Connected,this.handleReconnected).on(hi.SignalRestarted,this.handleReconnected).on(hi.SignalResumed,this.handleReconnected).on(hi.Restarting,this.handleReconnecting).on(hi.Resuming,this.handleReconnecting).on(hi.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(hi.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(hi.Disconnected,this.handleDisconnected)}setMetadata(e){var t;this.engine.client.sendUpdateLocalMetadata(e,null!==(t=this.name)&&void 0!==t?t:"")}setName(e){var t;this.engine.client.sendUpdateLocalMetadata(null!==(t=this.metadata)&&void 0!==t?t:"",e)}setCameraEnabled(e,t,n){return this.setTrackEnabled(vr.Source.Camera,e,t,n)}setMicrophoneEnabled(e,t,n){return this.setTrackEnabled(vr.Source.Microphone,e,t,n)}setScreenShareEnabled(e,t,n){return this.setTrackEnabled(vr.Source.ScreenShare,e,t,n)}setPermissions(e){const t=this.permissions,n=super.setPermissions(e);return n&&t&&this.emit(di.ParticipantPermissionsChanged,t),n}setE2EEEnabled(e){return Ct(this,void 0,void 0,(function*(){this.encryptionType=e?et.GCM:et.NONE,yield this.republishAllTracks(void 0,!1)}))}setTrackEnabled(e,t,n,i){var r,o;return Ct(this,void 0,void 0,(function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t}));let a=this.getTrack(e);if(t)if(a)yield a.unmute();else{let t;if(this.pendingPublishing.has(e))return void this.log.info("skipping duplicate published source",Object.assign(Object.assign({},this.logContext),{source:e}));this.pendingPublishing.add(e);try{switch(e){case vr.Source.Camera:t=yield this.createTracks({video:null===(r=n)||void 0===r||r});break;case vr.Source.Microphone:t=yield this.createTracks({audio:null===(o=n)||void 0===o||o});break;case vr.Source.ScreenShare:t=yield this.createScreenTracks(Object.assign({},n));break;default:throw new oi(e)}const s=[];for(const e of t)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),xr(e))),s.push(this.publishTrack(e,i));const c=yield Promise.all(s);[a]=c}catch(s){throw null===t||void 0===t||t.forEach((e=>{e.stop()})),s instanceof Error&&!(s instanceof oi)&&this.emit(di.MediaDevicesError,s),s}finally{this.pendingPublishing.delete(e)}}else if(a&&a.track)if(e===vr.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const e=this.getTrack(vr.Source.ScreenShareAudio);e&&e.track&&this.unpublishTrack(e.track)}else yield a.mute();return a}))}enableCameraAndMicrophone(){return Ct(this,void 0,void 0,(function*(){if(!this.pendingPublishing.has(vr.Source.Camera)&&!this.pendingPublishing.has(vr.Source.Microphone)){this.pendingPublishing.add(vr.Source.Camera),this.pendingPublishing.add(vr.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map((e=>this.publishTrack(e))))}finally{this.pendingPublishing.delete(vr.Source.Camera),this.pendingPublishing.delete(vr.Source.Microphone)}}}))}createTracks(e){var t,n;return Ct(this,void 0,void 0,(function*(){const i=wr(kr(e,null===(t=this.roomOptions)||void 0===t?void 0:t.audioCaptureDefaults,null===(n=this.roomOptions)||void 0===n?void 0:n.videoCaptureDefaults));let r;try{r=yield navigator.mediaDevices.getUserMedia(i)}catch(o){throw o instanceof Error&&(i.audio&&(this.microphoneError=o),i.video&&(this.cameraError=o)),o}return i.audio&&(this.microphoneError=void 0,this.emit(di.AudioStreamAcquired)),i.video&&(this.cameraError=void 0),r.getTracks().map((t=>{const n="audio"===t.kind;let o;n?e.audio:e.video;const a=n?i.audio:i.video;"boolean"!==typeof a&&(o=a);const s=ea(t,o,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return s.kind===vr.Kind.Video?s.source=vr.Source.Camera:s.kind===vr.Kind.Audio&&(s.source=vr.Source.Microphone),s.mediaStream=r,s}))}))}createScreenTracks(e){return Ct(this,void 0,void 0,(function*(){if(void 0===e&&(e={}),void 0===navigator.mediaDevices.getDisplayMedia)throw new ri("getDisplayMedia not supported");void 0!==e.resolution||Ur()||(e.resolution=Ri.h1080fps30.resolution);const t=Tr(e),n=yield navigator.mediaDevices.getDisplayMedia(t),i=n.getVideoTracks();if(0===i.length)throw new oi("no video track found");const r=new ha(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});r.source=vr.Source.ScreenShare,e.contentHint&&(r.mediaStreamTrack.contentHint=e.contentHint);const o=[r];if(n.getAudioTracks().length>0){this.emit(di.AudioStreamAcquired);const e=new Zo(n.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e.source=vr.Source.ScreenShareAudio,o.push(e)}return o}))}publishTrack(e,t){var n,i,r,o;return Ct(this,void 0,void 0,(function*(){let a,s;if(yield null===(n=this.reconnectFuture)||void 0===n?void 0:n.promise,e instanceof so&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e)),e instanceof MediaStreamTrack)a=e.getConstraints();else{let t;switch(a=e.constraints,e.source){case vr.Source.Microphone:t="audioinput";break;case vr.Source.Camera:t="videoinput"}t&&this.activeDeviceMap.has(t)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(t)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new Zo(e,a,!0,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;case"video":e=new ha(e,a,!0,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;default:throw new oi("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(e instanceof Zo&&e.setAudioContext(this.audioContext),this.tracks.forEach((t=>{t.track&&t.track===e&&(s=t)})),s)return this.log.warn("track has already been published, skipping",Object.assign(Object.assign({},this.logContext),xr(s))),s;const c="channelCount"in e.mediaStreamTrack.getSettings()&&2===e.mediaStreamTrack.getSettings().channelCount||2===e.mediaStreamTrack.getConstraints().channelCount,l=null!==(i=null===t||void 0===t?void 0:t.forceStereo)&&void 0!==i?i:c;l&&(t||(t={}),void 0===t.dtx&&this.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},this.logContext),xr(e))),void 0===t.red&&this.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),null!==(r=t.dtx)&&void 0!==r||(t.dtx=!1),null!==(o=t.red)&&void 0!==o||(t.red=!1));const u=Object.assign(Object.assign({},this.roomOptions.publishDefaults),t);Ar()&&this.roomOptions.e2ee&&(this.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari",Object.assign({},this.logContext)),u.simulcast=!1),u.source&&(e.source=u.source);const d=this.publish(e,u,l);this.pendingPublishPromises.set(e,d);try{return yield d}catch(h){throw h}finally{this.pendingPublishPromises.delete(e)}}))}publish(e,t,n){var i,r,o,a,s,c,l,u,d,h,p,f,m;return Ct(this,void 0,void 0,(function*(){Array.from(this.tracks.values()).find((t=>e instanceof so&&t.source===e.source))&&e.source!==vr.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),xr(e))),t.stopMicTrackOnMute&&e instanceof Zo&&(e.stopOnMute=!0),e.source===vr.Source.ScreenShare&&Lr()&&(t.simulcast=!1),"av1"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(Ar())return!1;const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/AV1"===n.mimeType){t=!0;break}return t}()||(t.videoCodec=void 0),"vp9"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(Lr())return!1;if(Ar()){const e=vi();if((null===e||void 0===e?void 0:e.version)&&Wr(e.version,"16")<0)return!1}const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/VP9"===n.mimeType){t=!0;break}return t}()||(t.videoCodec=void 0),void 0===t.videoCodec&&(t.videoCodec=Ao);const g=t.videoCodec;e.on(pi.Muted,this.onTrackMuted),e.on(pi.Unmuted,this.onTrackUnmuted),e.on(pi.Ended,this.handleTrackEnded),e.on(pi.UpstreamPaused,this.onTrackUpstreamPaused),e.on(pi.UpstreamResumed,this.onTrackUpstreamResumed);const v=new Li({cid:e.mediaStreamTrack.id,name:t.name,type:vr.kindToProto(e.kind),muted:e.isMuted,source:vr.sourceToProto(e.source),disableDtx:!(null===(i=t.dtx)||void 0===i||i),encryption:this.encryptionType,stereo:n,disableRed:this.isE2EEEnabled||!(null===(r=t.red)||void 0===r||r),stream:null===t||void 0===t?void 0:t.stream});let y;if(e.kind===vr.Kind.Video){let n={width:0,height:0};try{n=yield e.waitForDimensions()}catch(w){const t=null!==(a=null===(o=this.roomOptions.videoCaptureDefaults)||void 0===o?void 0:o.resolution)&&void 0!==a?a:Pi.h720.resolution;n={width:t.width,height:t.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),xr(e)),{dims:n}))}v.width=n.width,v.height=n.height,e instanceof ha&&(Ir(g)&&(e.source===vr.Source.ScreenShare&&"vp9"===g&&(t.scalabilityMode="L1T3"),t.scalabilityMode=null!==(s=t.scalabilityMode)&&void 0!==s?s:"L3T3_KEY"),v.simulcastCodecs=[new Mi({codec:g,cid:e.mediaStreamTrack.id})],!0===t.backupCodec&&(t.backupCodec={codec:Ao}),t.backupCodec&&g!==t.backupCodec.codec&&v.encryption===et.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),v.simulcastCodecs.push(new Mi({codec:t.backupCodec.codec,cid:""})))),y=sa(e.source===vr.Source.ScreenShare,v.width,v.height,t),v.layers=ma(v.width,v.height,y,Ir(t.videoCodec))}else e.kind===vr.Kind.Audio&&(y=[{maxBitrate:null!==(l=null===(c=t.audioPreset)||void 0===c?void 0:c.maxBitrate)&&void 0!==l?l:t.audioBitrate,priority:null!==(d=null===(u=t.audioPreset)||void 0===u?void 0:u.priority)&&void 0!==d?d:"high",networkPriority:null!==(p=null===(h=t.audioPreset)||void 0===h?void 0:h.priority)&&void 0!==p?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new si("cannot publish track when not connected");const b=yield this.engine.addTrack(v);let k;if(b.codecs.forEach((e=>{void 0===k&&(k=e.mimeType)})),k&&e.kind===vr.Kind.Video){const n=Er(k);n!==g&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),xr(e)),{codec:n})),t.videoCodec=n,y=sa(e.source===vr.Source.ScreenShare,v.width,v.height,t))}const S=new wa(e.kind,b,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(S.options=t,e.sid=b.sid,!this.engine.pcManager)throw new si("pcManager is not ready");if(this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:y,trackInfo:b})),e.sender=yield this.engine.createSender(e,t,y),y)if(Lr()&&e.kind===vr.Kind.Audio){let t;for(const n of this.engine.pcManager.publisher.getTransceivers())if(n.sender===e.sender){t=n;break}t&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:t,codec:"opus",maxbr:(null===(f=y[0])||void 0===f?void 0:f.maxBitrate)?y[0].maxBitrate/1e3:0})}else e.codec&&Ir(e.codec)&&(null===(m=y[0])||void 0===m?void 0:m.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:v.cid,codec:e.codec,maxbr:y[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof ha?e.startMonitor(this.engine.client):e instanceof Zo&&e.startMonitor(),this.addTrackPublication(S),this.emit(di.LocalTrackPublished,S),S}))}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,n){var i;return Ct(this,void 0,void 0,(function*(){if(this.encryptionType!==et.NONE)return;let r;if(this.tracks.forEach((t=>{t.track&&t.track===e&&(r=t)})),!r)throw new oi("track is not published");if(!(e instanceof ha))throw new oi("track is not a video track");const o=Object.assign(Object.assign({},null===(i=this.roomOptions)||void 0===i?void 0:i.publishDefaults),n),a=function(e,t,n){var i,r,o,a;if(!n.backupCodec||!0===n.backupCodec||n.backupCodec.codec===n.videoCodec)return;t!==n.backupCodec.codec&&f.warn("requested a different codec than specified as backup",{serverRequested:t,backup:n.backupCodec.codec}),n.videoCodec=t,n.videoEncoding=n.backupCodec.encoding;const s=e.mediaStreamTrack.getSettings(),c=null!==(i=s.width)&&void 0!==i?i:null===(r=e.dimensions)||void 0===r?void 0:r.width,l=null!==(o=s.height)&&void 0!==o?o:null===(a=e.dimensions)||void 0===a?void 0:a.height;return sa(e.source===vr.Source.ScreenShare,c,l,n)}(e,t,o);if(!a)return void this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),xr(e)));const s=e.addSimulcastTrack(t,a),c=new Li({cid:s.mediaStreamTrack.id,type:vr.kindToProto(e.kind),muted:e.isMuted,source:vr.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:s.mediaStreamTrack.id}]});if(c.layers=ma(c.width,c.height,a),!this.engine||this.engine.isClosed)throw new si("cannot publish track when not connected");const l=yield this.engine.addTrack(c);yield this.engine.createSimulcastSender(e,s,o,a),yield this.engine.negotiate(),this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:l}))}))}unpublishTrack(e,t){var n,i;return Ct(this,void 0,void 0,(function*(){const r=this.getPublicationForTrack(e),o=r?xr(r):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),o)),!r||!r.track)return void this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),o));(e=r.track).off(pi.Muted,this.onTrackMuted),e.off(pi.Unmuted,this.onTrackUnmuted),e.off(pi.Ended,this.handleTrackEnded),e.off(pi.UpstreamPaused,this.onTrackUpstreamPaused),e.off(pi.UpstreamResumed,this.onTrackUpstreamResumed),void 0===t&&(t=null===(i=null===(n=this.roomOptions)||void 0===n?void 0:n.stopLocalTrackOnUnpublish)||void 0===i||i),t&&e.stop();let a=!1;const s=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<zo.FAILED&&s)try{for(const e of this.engine.pcManager.publisher.getTransceivers())e.sender===s&&(e.direction="inactive",a=!0);if(this.engine.removeTrack(s)&&(a=!0),e instanceof ha){for(const[,t]of e.simulcastCodecs)t.sender&&(this.engine.removeTrack(t.sender)&&(a=!0),t.sender=void 0);e.simulcastCodecs.clear()}}catch(c){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),o),{error:c}))}switch(this.tracks.delete(r.trackSid),r.kind){case vr.Kind.Audio:this.audioTracks.delete(r.trackSid);break;case vr.Kind.Video:this.videoTracks.delete(r.trackSid)}return this.emit(di.LocalTrackUnpublished,r),r.setTrack(void 0),a&&(yield this.engine.negotiate()),r}))}unpublishTracks(e){return Ct(this,void 0,void 0,(function*(){return(yield Promise.all(e.map((e=>this.unpublishTrack(e))))).filter((e=>e instanceof wa))}))}republishAllTracks(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Ct(this,void 0,void 0,(function*(){const n=[];this.tracks.forEach((t=>{t.track&&(e&&(t.options=Object.assign(Object.assign({},t.options),e)),n.push(t))})),yield Promise.all(n.map((e=>Ct(this,void 0,void 0,(function*(){const n=e.track;yield this.unpublishTrack(n,!1),t&&!n.isMuted&&n.source!==vr.Source.ScreenShare&&n.source!==vr.Source.ScreenShareAudio&&(n instanceof Zo||n instanceof ha)&&!n.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:e.trackSid})),yield n.restartTrack()),yield this.publishTrack(n,e.options)})))))}))}publishData(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Ct(this,void 0,void 0,(function*(){const i=Array.isArray(n)?n:null===n||void 0===n?void 0:n.destination,r=[],o=Array.isArray(n)?void 0:n.topic;void 0!==i&&i.forEach((e=>{e instanceof xa?r.push(e.sid):r.push(e)}));const a=new ct({kind:t,value:{case:"user",value:new dt({participantSid:this.sid,payload:e,destinationSids:r,topic:o})}});yield this.engine.sendDataPacket(a,t)}))}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid===this.sid&&(!!super.updateInfo(e)&&(e.tracks.forEach((e=>{var t,n;const i=this.tracks.get(e.sid);if(i){const r=i.isMuted||null!==(n=null===(t=i.track)||void 0===t?void 0:t.isUpstreamPaused)&&void 0!==n&&n;r!==e.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),xr(i)),{mutedOnServer:r})),this.engine.client.sendMuteTrack(e.sid,r))}})),!0))}getPublicationForTrack(e){let t;return this.tracks.forEach((n=>{const i=n.track;i&&(e instanceof MediaStreamTrack?(i instanceof Zo||i instanceof ha)&&i.mediaStreamTrack===e&&(t=n):e===i&&(t=n))})),t}}!function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Reconnecting="reconnecting"}(Ta||(Ta={}));class Na extends zt.EventEmitter{constructor(e){var t,n,i;super(),t=this,this.state=Ta.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=f,this.bufferedEvents=[],this.connect=(e,t,n)=>Ct(this,void 0,void 0,(function*(){var i;const r=yield this.disconnectLock.lock();if(this.state===Ta.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),r(),Promise.resolve();if(this.connectFuture)return r(),this.connectFuture.promise;this.setAndEmitConnectionState(Ta.Connecting),(null===(i=this.regionUrlProvider)||void 0===i?void 0:i.getServerUrl().toString())!==e&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Vr(new URL(e))&&(void 0===this.regionUrlProvider?this.regionUrlProvider=new $o(e,t):this.regionUrlProvider.updateToken(t),this.regionUrlProvider.fetchRegionSettings().catch((e=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:e}))})));const o=(i,a,s)=>Ct(this,void 0,void 0,(function*(){var c;this.abortController&&this.abortController.abort();const l=new AbortController;this.abortController=l,null===r||void 0===r||r();try{yield this.attemptConnection(null!==s&&void 0!==s?s:e,t,n,l),this.abortController=void 0,i()}catch(u){if(this.regionUrlProvider&&u instanceof ii&&3!==u.reason&&0!==u.reason){let e=null;try{e=yield this.regionUrlProvider.getNextBestRegionUrl(null===(c=this.abortController)||void 0===c?void 0:c.signal)}catch(d){if(d instanceof ii&&(401===d.status||3===d.reason))return this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),void a(d)}e?(this.log.info("Initial connection failed with ConnectionError: ".concat(u.message,". Retrying with another region: ").concat(e),this.logContext),yield o(i,a,e)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),a(u))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),a(u)}})),a=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new to(((e,t)=>{o(e,t,a)}),(()=>{this.clearConnectionFutures()})),this.connectFuture.promise})),this.connectSignal=(e,t,n,i,r,o)=>Ct(this,void 0,void 0,(function*(){var a,s,c;const l=yield n.join(e,t,{autoSubscribe:i.autoSubscribe,publishOnly:i.publishOnly,adaptiveStream:"object"===typeof r.adaptiveStream||r.adaptiveStream,maxRetries:i.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:i.websocketTimeout},o.signal);let u=l.serverInfo;if(u||(u={version:l.serverVersion,region:l.serverRegion}),this.log.debug("connected to Livekit Server ".concat(Object.entries(u).map((e=>{let[t,n]=e;return"".concat(t,": ").concat(n)})).join(", ")),{room:null===(a=l.room)||void 0===a?void 0:a.name,roomSid:null===(s=l.room)||void 0===s?void 0:s.sid,identity:null===(c=l.participant)||void 0===c?void 0:c.identity}),!l.serverVersion)throw new ai("unknown server version");return"0.15.1"===l.serverVersion&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),r.dynacast=!1),l})),this.applyJoinResponse=e=>{const t=e.participant;this.localParticipant.sid=t.sid,this.localParticipant.identity=t.identity,this.handleParticipantUpdates([t,...e.otherParticipants]),e.room&&this.handleRoomUpdate(e.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(e.sifTrailer)},this.attemptConnection=(e,t,n,i)=>Ct(this,void 0,void 0,(function*(){var r,o;this.state===Ta.Reconnecting?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),(null===(r=this.regionUrlProvider)||void 0===r?void 0:r.isCloud())&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Vo),n),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const n=yield this.connectSignal(e,t,this.engine,this.connOptions,this.options,i);this.applyJoinResponse(n),this.setupLocalParticipantEvents(),this.emit(ui.SignalConnected)}catch(a){yield this.engine.close(),this.recreateEngine();const e=new ii("could not establish signal connection");throw a instanceof Error&&(e.message="".concat(e.message,": ").concat(a.message)),a instanceof ii&&(e.reason=a.reason,e.status=a.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:a})),e}if(i.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new ii("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,i)}catch(s){throw yield this.engine.close(),this.recreateEngine(),s}jr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),jr()&&(document.addEventListener("freeze",this.onPageLeave),null===(o=navigator.mediaDevices)||void 0===o||o.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(Ta.Connected),this.emit(ui.Connected),this.registerConnectionReconcile()})),this.disconnect=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Ct(t,void 0,void 0,(function*(){var t,n,i,r;const o=yield this.disconnectLock.lock();try{if(this.state===Ta.Disconnected)return void this.log.debug("already disconnected",this.logContext);this.log.info("disconnect from room",Object.assign({},this.logContext)),this.state!==Ta.Connecting&&this.state!==Ta.Reconnecting||(this.log.warn("abort connection attempt",this.logContext),null===(t=this.abortController)||void 0===t||t.abort(),null===(i=null===(n=this.connectFuture)||void 0===n?void 0:n.reject)||void 0===i||i.call(n,new ii("Client initiated disconnect")),this.connectFuture=void 0),(null===(r=this.engine)||void 0===r?void 0:r.client.isDisconnected)||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(e,Je.CLIENT_INITIATED),this.engine=void 0}finally{o()}}))},this.onPageLeave=()=>Ct(this,void 0,void 0,(function*(){yield this.disconnect()})),this.startAudio=()=>Ct(this,void 0,void 0,(function*(){const e=[],t=vi();if(t&&"iOS"===t.os){const t="livekit-dummy-audio-el";let n=document.getElementById(t);if(!n){n=document.createElement("audio"),n.id=t,n.autoplay=!0,n.hidden=!0;const e=eo();e.enabled=!0;const i=new MediaStream([e]);n.srcObject=i,document.addEventListener("visibilitychange",(()=>{n&&(n.srcObject=document.hidden?null:i,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))})),document.body.append(n),this.once(ui.Disconnected,(()=>{null===n||void 0===n||n.remove(),n=null}))}e.push(n)}this.participants.forEach((t=>{t.audioTracks.forEach((t=>{t.track&&t.track.attachedElements.forEach((t=>{e.push(t)}))}))}));try{yield Promise.all([this.acquireAudioContext(),...e.map((e=>(e.muted=!1,e.play())))]),this.handleAudioPlaybackStarted()}catch(n){throw this.handleAudioPlaybackFailed(n),n}})),this.startVideo=()=>Ct(this,void 0,void 0,(function*(){const e=[];for(const t of this.participants.values())t.videoTracks.forEach((t=>{var n;null===(n=t.track)||void 0===n||n.attachedElements.forEach((t=>{e.includes(t)||e.push(t)}))}));yield Promise.all(e.map((e=>e.play()))).then((()=>{this.handleVideoPlaybackStarted()})).catch((e=>{"NotAllowedError"===e.name?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)}))})),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const e of this.participants.values())this.handleParticipantDisconnected(e.sid,e);this.setAndEmitConnectionState(Ta.Reconnecting)&&this.emit(ui.Reconnecting)},this.handleSignalRestarted=e=>Ct(this,void 0,void 0,(function*(){this.log.debug("signal reconnected to server, region ".concat(e.serverRegion),Object.assign(Object.assign({},this.logContext),{region:e.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(e);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(t){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:t}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:e.serverRegion}))}catch(n){return}this.setAndEmitConnectionState(Ta.Connected),this.emit(ui.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()})),this.handleParticipantUpdates=e=>{e.forEach((e=>{if(e.identity===this.localParticipant.identity)return void this.localParticipant.updateInfo(e);const t=this.identityToSid.get(e.identity);t&&t!==e.sid&&this.handleParticipantDisconnected(t,this.participants.get(t));let n=this.participants.get(e.sid);const i=!n;e.state===Ze.DISCONNECTED?this.handleParticipantDisconnected(e.sid,n):(n=this.getOrCreateParticipant(e.sid,e),i||n.updateInfo(e))}))},this.handleActiveSpeakersUpdate=e=>{const t=[],n={};e.forEach((e=>{if(n[e.sid]=!0,e.sid===this.localParticipant.sid)this.localParticipant.audioLevel=e.level,this.localParticipant.setIsSpeaking(!0),t.push(this.localParticipant);else{const n=this.participants.get(e.sid);n&&(n.audioLevel=e.level,n.setIsSpeaking(!0),t.push(n))}})),n[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach((e=>{n[e.sid]||(e.audioLevel=0,e.setIsSpeaking(!1))})),this.activeSpeakers=t,this.emitWhenConnected(ui.ActiveSpeakersChanged,t)},this.handleSpeakersChanged=e=>{const t=new Map;this.activeSpeakers.forEach((e=>{t.set(e.sid,e)})),e.forEach((e=>{let n=this.participants.get(e.sid);e.sid===this.localParticipant.sid&&(n=this.localParticipant),n&&(n.audioLevel=e.level,n.setIsSpeaking(e.active),e.active?t.set(e.sid,n):t.delete(e.sid))}));const n=Array.from(t.values());n.sort(((e,t)=>t.audioLevel-e.audioLevel)),this.activeSpeakers=n,this.emitWhenConnected(ui.ActiveSpeakersChanged,n)},this.handleStreamStateUpdate=e=>{e.streamStates.forEach((e=>{const t=this.participants.get(e.participantSid);if(!t)return;const n=t.getTrackPublication(e.trackSid);n&&n.track&&(n.track.streamState=vr.streamStateFromProto(e.state),t.emit(di.TrackStreamStateChanged,n,n.track.streamState),this.emitWhenConnected(ui.TrackStreamStateChanged,n,n.track.streamState,t))}))},this.handleSubscriptionPermissionUpdate=e=>{const t=this.participants.get(e.participantSid);if(!t)return;const n=t.getTrackPublication(e.trackSid);n&&n.setAllowed(e.allowed)},this.handleSubscriptionError=e=>{const t=Array.from(this.participants.values()).find((t=>t.tracks.has(e.trackSid)));if(!t)return;const n=t.getTrackPublication(e.trackSid);n&&n.setSubscriptionError(e.err)},this.handleDataPacket=(e,t)=>{const n=this.participants.get(e.participantSid);this.emit(ui.DataReceived,e.payload,n,t,e.topic),null===n||void 0===n||n.emit(di.DataReceived,e.payload,t)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(ui.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=e=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:e})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(ui.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(ui.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(ui.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>Ct(this,void 0,void 0,(function*(){this.emit(ui.MediaDevicesChanged)})),this.handleRoomUpdate=e=>{const t=this.roomInfo;this.roomInfo=e,t&&t.metadata!==e.metadata&&this.emitWhenConnected(ui.RoomMetadataChanged,e.metadata),(null===t||void 0===t?void 0:t.activeRecording)!==e.activeRecording&&this.emitWhenConnected(ui.RecordingStatusChanged,e.activeRecording)},this.handleConnectionQualityUpdate=e=>{e.updates.forEach((e=>{if(e.participantSid===this.localParticipant.sid)return void this.localParticipant.setConnectionQuality(e.quality);const t=this.participants.get(e.participantSid);t&&t.setConnectionQuality(e.quality)}))},this.onLocalParticipantMetadataChanged=e=>{this.emit(ui.ParticipantMetadataChanged,e,this.localParticipant)},this.onLocalParticipantNameChanged=e=>{this.emit(ui.ParticipantNameChanged,e,this.localParticipant)},this.onLocalTrackMuted=e=>{this.emit(ui.TrackMuted,e,this.localParticipant)},this.onLocalTrackUnmuted=e=>{this.emit(ui.TrackUnmuted,e,this.localParticipant)},this.onLocalTrackPublished=e=>Ct(this,void 0,void 0,(function*(){var t;if(this.emit(ui.LocalTrackPublished,e,this.localParticipant),e.track instanceof Zo){(yield e.track.checkForSilence())&&this.emit(ui.LocalAudioSilenceDetected,e)}const n=yield null===(t=e.track)||void 0===t?void 0:t.getDeviceId(),i=(r=e.source)===vr.Source.Microphone?"audioinput":r===vr.Source.Camera?"videoinput":void 0;var r;i&&n&&n!==this.localParticipant.activeDeviceMap.get(i)&&(this.localParticipant.activeDeviceMap.set(i,n),this.emit(ui.ActiveDeviceChanged,i,n))})),this.onLocalTrackUnpublished=e=>{this.emit(ui.LocalTrackUnpublished,e,this.localParticipant)},this.onLocalConnectionQualityChanged=e=>{this.emit(ui.ConnectionQualityChanged,e,this.localParticipant)},this.onMediaDevicesError=e=>{this.emit(ui.MediaDevicesError,e)},this.onLocalParticipantPermissionsChanged=e=>{this.emit(ui.ParticipantPermissionsChanged,e,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=Object.assign(Object.assign({},Bo),e),this.log=m(null!==(n=this.options.loggerName)&&void 0!==n?n:h.Room),this.options.audioCaptureDefaults=Object.assign(Object.assign({},Fo),null===e||void 0===e?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},jo),null===e||void 0===e?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},Uo),null===e||void 0===e?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new no,this.localParticipant=new Ra("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",io(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",io(this.options.audioCaptureDefaults.deviceId)),(null===(i=this.options.audioOutput)||void 0===i?void 0:i.deviceId)&&this.switchActiveDevice("audiooutput",io(this.options.audioOutput.deviceId)).catch((e=>this.log.warn("Could not set audio output: ".concat(e.message),this.logContext))),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return Ct(this,void 0,void 0,(function*(){if(!this.e2eeManager)throw Error("e2ee not configured, please set e2ee settings within the room options");yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),""!==this.localParticipant.identity&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity)}))}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new co(this.options.e2ee),this.e2eeManager.on(Xn.ParticipantEncryptionStatusChanged,((e,t)=>{t instanceof Ra&&(this.isE2EEEnabled=e),this.emit(ui.ParticipantEncryptionStatusChanged,e,t)})),this.e2eeManager.on(Xn.EncryptionError,(e=>this.emit(ui.EncryptionError,e))),null===(e=this.e2eeManager)||void 0===e||e.setup(this))}get logContext(){return{room:this.name,roomSid:this.sid,identity:this.localParticipant.identity}}get isRecording(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.activeRecording)&&void 0!==t&&t}get sid(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.sid)&&void 0!==t?t:""}get name(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.name)&&void 0!==t?t:""}get metadata(){var e;return null===(e=this.roomInfo)||void 0===e?void 0:e.metadata}get numParticipants(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numParticipants)&&void 0!==t?t:0}get numPublishers(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numPublishers)&&void 0!==t?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new Go(this.options),this.engine.on(hi.ParticipantUpdate,this.handleParticipantUpdates).on(hi.RoomUpdate,this.handleRoomUpdate).on(hi.SpeakersChanged,this.handleSpeakersChanged).on(hi.StreamStateChanged,this.handleStreamStateUpdate).on(hi.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(hi.SubscriptionError,this.handleSubscriptionError).on(hi.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(hi.MediaTrackAdded,((e,t,n)=>{this.onTrackAdded(e,t,n)})).on(hi.Disconnected,(e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)})).on(hi.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(hi.DataPacketReceived,this.handleDataPacket).on(hi.Resuming,(()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(Ta.Reconnecting)&&this.emit(ui.Reconnecting)})).on(hi.Resumed,(()=>{this.setAndEmitConnectionState(Ta.Connected),this.emit(ui.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),this.emitBufferedEvents()})).on(hi.SignalResumed,(()=>{this.bufferedEvents=[],this.state===Ta.Reconnecting&&this.sendSyncState()})).on(hi.Restarting,this.handleRestarting).on(hi.SignalRestarted,this.handleSignalRestarted).on(hi.DCBufferStatusChanged,((e,t)=>{this.emit(ui.DCBufferStatusChanged,e,t)})),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return ao.getInstance().getDevices(e,t)}prepareConnection(e,t){return Ct(this,void 0,void 0,(function*(){if(this.state===Ta.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Vr(new URL(e))&&t){this.regionUrlProvider=new $o(e,t);const n=yield this.regionUrlProvider.getNextBestRegionUrl();n&&this.state===Ta.Disconnected&&(this.regionUrl=n,yield fetch(ro(n),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(n),this.logContext))}else yield fetch(ro(e),{method:"HEAD"})}catch(n){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:n}))}}}))}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const t=this.identityToSid.get(e);return t?this.participants.get(t):void 0}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return Ct(this,void 0,void 0,(function*(){let n,i=()=>{};switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":n=new ur({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":n=new ur({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":n=new ur({scenario:{case:"serverLeave",value:!0}});break;case"migration":n=new ur({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":i=()=>Ct(this,void 0,void 0,(function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")})),n=new ur({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":i=()=>Ct(this,void 0,void 0,(function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")})),n=new ur({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":n=new ur({scenario:{case:"switchCandidateProtocol",value:"force-tls"===e?2:1}}),i=()=>Ct(this,void 0,void 0,(function*(){const e=this.engine.client.onLeave;e&&e(new Hi({reason:Je.CLIENT_INITIATED,canReconnect:!0}))}));break;case"subscriber-bandwidth":if(void 0===t||"number"!==typeof t)throw new Error("subscriber-bandwidth requires a number as argument");n=new ur({scenario:{case:"subscriberBandwidth",value:BigInt(t)}})}n&&(yield this.engine.client.sendSimulateScenario(n),yield i())}))}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,t;return null!==(t=null===(e=this.options.audioOutput)||void 0===e?void 0:e.deviceId)&&void 0!==t?t:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var i,r,o;return Ct(this,void 0,void 0,(function*(){let a=!1,s=!0;const c=n?{exact:t}:t;if("audioinput"===e){const e=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=c,a=e!==c;const t=Array.from(this.localParticipant.audioTracks.values()).filter((e=>e.source===vr.Source.Microphone));try{s=(yield Promise.all(t.map((e=>{var t;return null===(t=e.audioTrack)||void 0===t?void 0:t.setDeviceId(c)})))).every((e=>!0===e))}catch(l){throw this.options.audioCaptureDefaults.deviceId=e,l}}else if("videoinput"===e){const e=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=c,a=e!==c;const t=Array.from(this.localParticipant.videoTracks.values()).filter((e=>e.source===vr.Source.Camera));try{s=(yield Promise.all(t.map((e=>{var t;return null===(t=e.videoTrack)||void 0===t?void 0:t.setDeviceId(c)})))).every((e=>!0===e))}catch(l){throw this.options.videoCaptureDefaults.deviceId=e,l}}else if("audiooutput"===e){if(!Dr()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");null!==(i=(o=this.options).audioOutput)&&void 0!==i||(o.audioOutput={});const e=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=t,a=e!==c;try{this.options.expWebAudioMix?null===(r=this.audioContext)||void 0===r||r.setSinkId(t):yield Promise.all(Array.from(this.participants.values()).map((e=>e.setAudioOutput({deviceId:t}))))}catch(l){throw this.options.audioOutput.deviceId=e,l}}return a&&s&&(this.localParticipant.activeDeviceMap.set(e,t),this.emit(ui.ActiveDeviceChanged,e,t)),s}))}setupLocalParticipantEvents(){this.localParticipant.on(di.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(di.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(di.TrackMuted,this.onLocalTrackMuted).on(di.TrackUnmuted,this.onLocalTrackUnmuted).on(di.LocalTrackPublished,this.onLocalTrackPublished).on(di.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(di.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(di.MediaDevicesError,this.onMediaDevicesError).on(di.AudioStreamAcquired,this.startAudio).on(di.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;null===(e=this.engine)||void 0===e||e.close(),this.engine=void 0,this.participants.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,n){if(this.state===Ta.Connecting||this.state===Ta.Reconnecting){const i=()=>{this.onTrackAdded(e,t,n),r()},r=()=>{this.off(ui.Reconnected,i),this.off(ui.Connected,i),this.off(ui.Disconnected,r)};return this.once(ui.Reconnected,i),this.once(ui.Connected,i),void this.once(ui.Disconnected,r)}if(this.state===Ta.Disconnected)return void this.log.warn("skipping incoming track after Room disconnected",this.logContext);const i=function(e){const t=e.split("|");return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]}(t.id),r=i[0];let o=i[1],a=e.id;if(o&&o.startsWith("TR")&&(a=o),r===this.localParticipant.sid)return void this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);const s=this.participants.get(r);if(!s)return void this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(r),this.logContext);let c;this.options.adaptiveStream&&(c="object"===typeof this.options.adaptiveStream?this.options.adaptiveStream:{}),s.addSubscribedMediaTrack(e,a,t,n,c)}handleDisconnect(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;var n;if(this.clearConnectionReconcile(),this.bufferedEvents=[],this.state!==Ta.Disconnected){this.regionUrl=void 0;try{this.participants.forEach((e=>{e.tracks.forEach((t=>{e.unpublishTrack(t.trackSid)}))})),this.localParticipant.tracks.forEach((t=>{var n,i;t.track&&this.localParticipant.unpublishTrack(t.track,e),e&&(null===(n=t.track)||void 0===n||n.detach(),null===(i=t.track)||void 0===i||i.stop())})),this.localParticipant.off(di.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(di.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(di.TrackMuted,this.onLocalTrackMuted).off(di.TrackUnmuted,this.onLocalTrackUnmuted).off(di.LocalTrackPublished,this.onLocalTrackPublished).off(di.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(di.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(di.MediaDevicesError,this.onMediaDevicesError).off(di.AudioStreamAcquired,this.startAudio).off(di.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&"boolean"===typeof this.options.expWebAudioMix&&(this.audioContext.close(),this.audioContext=void 0),jr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),null===(n=navigator.mediaDevices)||void 0===n||n.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ta.Disconnected),this.emit(ui.Disconnected,t)}}}handleParticipantDisconnected(e,t){this.participants.delete(e),t&&(this.identityToSid.delete(t.identity),t.tracks.forEach((e=>{t.unpublishTrack(e.trackSid,!0)})),this.emit(ui.ParticipantDisconnected,t))}acquireAudioContext(){var e,t;return Ct(this,void 0,void 0,(function*(){if("boolean"!==typeof this.options.expWebAudioMix&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:this.audioContext&&"closed"!==this.audioContext.state||(this.audioContext=null!==(e=Cr())&&void 0!==e?e:void 0),this.audioContext&&"suspended"===this.audioContext.state)try{yield this.audioContext.resume()}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}this.options.expWebAudioMix&&this.participants.forEach((e=>e.setAudioContext(this.audioContext))),this.localParticipant.setAudioContext(this.audioContext);const n="running"===(null===(t=this.audioContext)||void 0===t?void 0:t.state);n!==this.canPlaybackAudio&&(this.audioEnabled=n,this.emit(ui.AudioPlaybackStatusChanged,n))}))}createParticipant(e,t){var n;let i;return i=t?xa.fromParticipantInfo(this.engine.client,t):new xa(this.engine.client,e,"",void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),(null===(n=this.options.audioOutput)||void 0===n?void 0:n.deviceId)&&i.setAudioOutput(this.options.audioOutput).catch((e=>this.log.warn("Could not set audio output: ".concat(e.message),this.logContext))),i}getOrCreateParticipant(e,t){if(this.participants.has(e))return this.participants.get(e);const n=this.createParticipant(e,t);return this.participants.set(e,n),this.identityToSid.set(t.identity,t.sid),this.emitWhenConnected(ui.ParticipantConnected,n),n.on(di.TrackPublished,(e=>{this.emitWhenConnected(ui.TrackPublished,e,n)})).on(di.TrackSubscribed,((e,t)=>{e.kind===vr.Kind.Audio?(e.on(pi.AudioPlaybackStarted,this.handleAudioPlaybackStarted),e.on(pi.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):e.kind===vr.Kind.Video&&(e.on(pi.VideoPlaybackFailed,this.handleVideoPlaybackFailed),e.on(pi.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(ui.TrackSubscribed,e,t,n)})).on(di.TrackUnpublished,(e=>{this.emit(ui.TrackUnpublished,e,n)})).on(di.TrackUnsubscribed,((e,t)=>{this.emit(ui.TrackUnsubscribed,e,t,n)})).on(di.TrackSubscriptionFailed,(e=>{this.emit(ui.TrackSubscriptionFailed,e,n)})).on(di.TrackMuted,(e=>{this.emitWhenConnected(ui.TrackMuted,e,n)})).on(di.TrackUnmuted,(e=>{this.emitWhenConnected(ui.TrackUnmuted,e,n)})).on(di.ParticipantMetadataChanged,(e=>{this.emitWhenConnected(ui.ParticipantMetadataChanged,e,n)})).on(di.ParticipantNameChanged,(e=>{this.emitWhenConnected(ui.ParticipantNameChanged,e,n)})).on(di.ConnectionQualityChanged,(e=>{this.emitWhenConnected(ui.ConnectionQualityChanged,e,n)})).on(di.ParticipantPermissionsChanged,(e=>{this.emitWhenConnected(ui.ParticipantPermissionsChanged,e,n)})).on(di.TrackSubscriptionStatusChanged,((e,t)=>{this.emitWhenConnected(ui.TrackSubscriptionStatusChanged,e,t,n)})).on(di.TrackSubscriptionFailed,((e,t)=>{this.emit(ui.TrackSubscriptionFailed,e,n,t)})).on(di.TrackSubscriptionPermissionChanged,((e,t)=>{this.emitWhenConnected(ui.TrackSubscriptionPermissionChanged,e,t,n)})),t&&n.updateInfo(t),n}sendSyncState(){const e=Array.from(this.participants.values()).reduce(((e,t)=>(e.push(...t.getTracks()),e)),[]),t=this.localParticipant.getTracks();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.participants.values())for(const t of e.videoTracks.values())t.isSubscribed&&t instanceof Pa&&t.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=ki.setInterval((()=>{this.engine&&!this.engine.isClosed&&this.engine.verifyTransport()?e=0:(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Je.STATE_MISMATCH)))}),2e3)}clearConnectionReconcile(){this.connectionReconcileInterval&&ki.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e!==this.state&&(this.state=e,this.emit(ui.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach((e=>{let[t,n]=e;this.emit(t,...n)})),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.state===Ta.Connected?this.emit(e,...n):(this.state===Ta.Reconnecting&&this.bufferedEvents.push([e,n]),!1)}simulateParticipants(e){var t,n;return Ct(this,void 0,void 0,(function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),r=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Ge({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:j.parse((new Date).getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Xe({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(ui.SignalConnected),this.emit(ui.Connected),this.setAndEmitConnectionState(Ta.Connected),i.video){const e=new wa(vr.Kind.Video,new at({source:je.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:Fe.AUDIO,name:"video-dummy"}),new ha(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Zr(160*(null!==(t=r.aspectRatios[0])&&void 0!==t?t:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(e),this.localParticipant.emit(di.LocalTrackPublished,e)}if(i.audio){const e=new wa(vr.Kind.Audio,new at({source:je.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:Fe.AUDIO}),new Zo(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:eo(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(e),this.localParticipant.emit(di.LocalTrackPublished,e)}for(let e=0;e<r.count-1;e+=1){let t=new Xe({sid:Math.floor(1e4*Math.random()).toString(),identity:"simulated-".concat(e),state:Ze.ACTIVE,tracks:[],joinedAt:j.parse(Date.now())});const i=this.getOrCreateParticipant(t.identity,t);if(r.video){const o=Zr(160*(null!==(n=r.aspectRatios[e%r.aspectRatios.length])&&void 0!==n?n:1),160,!1,!0),a=new at({source:je.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:Fe.AUDIO});i.addSubscribedMediaTrack(o,a.sid,new MediaStream([o])),t.tracks=[...t.tracks,a]}if(r.audio){const e=eo(),n=new at({source:je.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:Fe.AUDIO});i.addSubscribedMediaTrack(e,n.sid,new MediaStream([e])),t.tracks=[...t.tracks,n]}i.updateInfo(t)}}))}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e!==ui.ActiveSpeakersChanged){const t=Oa(n).filter((e=>void 0!==e));this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:t}))}return super.emit(e,...n)}}function Oa(e){return e.map((e=>{if(e)return Array.isArray(e)?Oa(e):"object"===typeof e?"logContext"in e&&e.logContext:e}))}var _a;!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.SKIPPED=2]="SKIPPED",e[e.SUCCESS=3]="SUCCESS",e[e.FAILED=4]="FAILED"}(_a||(_a={}));zt.EventEmitter;zt.EventEmitter;function Ia(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;const i=e instanceof so?e.mediaStreamTrack:e,r=i.getSettings();let o={facingMode:null!==(n=t.defaultFacingMode)&&void 0!==n?n:"user",confidence:"low"};if("facingMode"in r){const e=r.facingMode;f.debug("rawFacingMode",{rawFacingMode:e}),e&&"string"===typeof e&&function(e){const t=["user","environment","left","right"];return void 0===e||t.includes(e)}(e)&&(o={facingMode:e,confidence:"high"})}if(["low","medium"].includes(o.confidence)){f.debug("Try to get facing mode from device label: (".concat(i.label,")"));const e=function(e){var t;const n=e.trim().toLowerCase();if(""===n)return;if(Da.has(n))return Da.get(n);return null===(t=Array.from(Ma.entries()).find((e=>{let[t]=e;return n.includes(t)})))||void 0===t?void 0:t[1]}(i.label);void 0!==e&&(o=e)}return o}const Da=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),Ma=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);const La=Math.min,Aa=Math.max,Ua=Math.round,Fa=(Math.floor,e=>({x:e,y:e})),ja={left:"right",right:"left",bottom:"top",top:"bottom"},Ba={start:"end",end:"start"};function Va(e,t,n){return Aa(e,La(t,n))}function za(e,t){return"function"===typeof e?e(t):e}function Ja(e){return e.split("-")[0]}function qa(e){return e.split("-")[1]}function Wa(e){return"x"===e?"y":"x"}function Ha(e){return"y"===e?"height":"width"}function Ka(e){return["top","bottom"].includes(Ja(e))?"y":"x"}function Ga(e){return Wa(Ka(e))}function Qa(e){return e.replace(/start|end/g,(e=>Ba[e]))}function $a(e){return e.replace(/left|right|bottom|top/g,(e=>ja[e]))}function Ya(e){const{x:t,y:n,width:i,height:r}=e;return{width:i,height:r,top:n,left:t,right:t+i,bottom:n+r,x:t,y:n}}function Xa(e,t,n){let{reference:i,floating:r}=e;const o=Ka(t),a=Ga(t),s=Ha(a),c=Ja(t),l="y"===o,u=i.x+i.width/2-r.width/2,d=i.y+i.height/2-r.height/2,h=i[s]/2-r[s]/2;let p;switch(c){case"top":p={x:u,y:i.y-r.height};break;case"bottom":p={x:u,y:i.y+i.height};break;case"right":p={x:i.x+i.width,y:d};break;case"left":p={x:i.x-r.width,y:d};break;default:p={x:i.x,y:i.y}}switch(qa(t)){case"start":p[a]-=h*(n&&l?-1:1);break;case"end":p[a]+=h*(n&&l?-1:1)}return p}async function Za(e,t){var n;void 0===t&&(t={});const{x:i,y:r,platform:o,rects:a,elements:s,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=za(t,e),f=function(e){return"number"!==typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}(p),m=s[h?"floating"===d?"reference":"floating":d],g=Ya(await o.getClippingRect({element:null==(n=await(null==o.isElement?void 0:o.isElement(m)))||n?m:m.contextElement||await(null==o.getDocumentElement?void 0:o.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),v="floating"===d?{x:i,y:r,width:a.floating.width,height:a.floating.height}:a.reference,y=await(null==o.getOffsetParent?void 0:o.getOffsetParent(s.floating)),b=await(null==o.isElement?void 0:o.isElement(y))&&await(null==o.getScale?void 0:o.getScale(y))||{x:1,y:1},k=Ya(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:v,offsetParent:y,strategy:c}):v);return{top:(g.top-k.top+f.top)/b.y,bottom:(k.bottom-g.bottom+f.bottom)/b.y,left:(g.left-k.left+f.left)/b.x,right:(k.right-g.right+f.right)/b.x}}const es=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:r,y:o,placement:a,middlewareData:s}=t,c=await async function(e,t){const{placement:n,platform:i,elements:r}=e,o=await(null==i.isRTL?void 0:i.isRTL(r.floating)),a=Ja(n),s=qa(n),c="y"===Ka(n),l=["left","top"].includes(a)?-1:1,u=o&&c?-1:1,d=za(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:f}="number"===typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return s&&"number"===typeof f&&(p="end"===s?-1*f:f),c?{x:p*u,y:h*l}:{x:h*l,y:p*u}}(t,e);return a===(null==(n=s.offset)?void 0:n.placement)&&null!=(i=s.arrow)&&i.alignmentOffset?{}:{x:r+c.x,y:o+c.y,data:{...c,placement:a}}}}};function ts(){return"undefined"!==typeof window}function ns(e){return os(e)?(e.nodeName||"").toLowerCase():"#document"}function is(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function rs(e){var t;return null==(t=(os(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function os(e){return!!ts()&&(e instanceof Node||e instanceof is(e).Node)}function as(e){return!!ts()&&(e instanceof Element||e instanceof is(e).Element)}function ss(e){return!!ts()&&(e instanceof HTMLElement||e instanceof is(e).HTMLElement)}function cs(e){return!(!ts()||"undefined"===typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof is(e).ShadowRoot)}function ls(e){const{overflow:t,overflowX:n,overflowY:i,display:r}=ms(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!["inline","contents"].includes(r)}function us(e){return["table","td","th"].includes(ns(e))}function ds(e){return[":popover-open",":modal"].some((t=>{try{return e.matches(t)}catch(n){return!1}}))}function hs(e){const t=ps(),n=as(e)?ms(e):e;return["transform","translate","scale","rotate","perspective"].some((e=>!!n[e]&&"none"!==n[e]))||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","translate","scale","rotate","perspective","filter"].some((e=>(n.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(n.contain||"").includes(e)))}function ps(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function fs(e){return["html","body","#document"].includes(ns(e))}function ms(e){return is(e).getComputedStyle(e)}function gs(e){return as(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function vs(e){if("html"===ns(e))return e;const t=e.assignedSlot||e.parentNode||cs(e)&&e.host||rs(e);return cs(t)?t.host:t}function ys(e){const t=vs(e);return fs(t)?e.ownerDocument?e.ownerDocument.body:e.body:ss(t)&&ls(t)?t:ys(t)}function bs(e,t,n){var i;void 0===t&&(t=[]),void 0===n&&(n=!0);const r=ys(e),o=r===(null==(i=e.ownerDocument)?void 0:i.body),a=is(r);if(o){const e=function(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}(a);return t.concat(a,a.visualViewport||[],ls(r)?r:[],e&&n?bs(e):[])}return t.concat(r,bs(r,[],n))}function ks(e){const t=ms(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const r=ss(e),o=r?e.offsetWidth:n,a=r?e.offsetHeight:i,s=Ua(n)!==o||Ua(i)!==a;return s&&(n=o,i=a),{width:n,height:i,$:s}}function Ss(e){return as(e)?e:e.contextElement}function ws(e){const t=Ss(e);if(!ss(t))return Fa(1);const n=t.getBoundingClientRect(),{width:i,height:r,$:o}=ks(t);let a=(o?Ua(n.width):n.width)/i,s=(o?Ua(n.height):n.height)/r;return a&&Number.isFinite(a)||(a=1),s&&Number.isFinite(s)||(s=1),{x:a,y:s}}const Cs=Fa(0);function Ts(e){const t=is(e);return ps()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Cs}function Es(e,t,n,i){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=e.getBoundingClientRect(),o=Ss(e);let a=Fa(1);t&&(i?as(i)&&(a=ws(i)):a=ws(e));const s=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==is(e))&&t}(o,n,i)?Ts(o):Fa(0);let c=(r.left+s.x)/a.x,l=(r.top+s.y)/a.y,u=r.width/a.x,d=r.height/a.y;if(o){const e=is(o),t=i&&as(i)?is(i):i;let n=e.frameElement;for(;n&&i&&t!==e;){const e=ws(n),t=n.getBoundingClientRect(),i=ms(n),r=t.left+(n.clientLeft+parseFloat(i.paddingLeft))*e.x,o=t.top+(n.clientTop+parseFloat(i.paddingTop))*e.y;c*=e.x,l*=e.y,u*=e.x,d*=e.y,c+=r,l+=o,n=is(n).frameElement}}return Ya({width:u,height:d,x:c,y:l})}function Ps(e){return Es(rs(e)).left+gs(e).scrollLeft}function xs(e,t,n){let i;if("viewport"===t)i=function(e,t){const n=is(e),i=rs(e),r=n.visualViewport;let o=i.clientWidth,a=i.clientHeight,s=0,c=0;if(r){o=r.width,a=r.height;const e=ps();(!e||e&&"fixed"===t)&&(s=r.offsetLeft,c=r.offsetTop)}return{width:o,height:a,x:s,y:c}}(e,n);else if("document"===t)i=function(e){const t=rs(e),n=gs(e),i=e.ownerDocument.body,r=Aa(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),o=Aa(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let a=-n.scrollLeft+Ps(e);const s=-n.scrollTop;return"rtl"===ms(i).direction&&(a+=Aa(t.clientWidth,i.clientWidth)-r),{width:r,height:o,x:a,y:s}}(rs(e));else if(as(t))i=function(e,t){const n=Es(e,!0,"fixed"===t),i=n.top+e.clientTop,r=n.left+e.clientLeft,o=ss(e)?ws(e):Fa(1);return{width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:r*o.x,y:i*o.y}}(t,n);else{const n=Ts(e);i={...t,x:t.x-n.x,y:t.y-n.y}}return Ya(i)}function Rs(e,t){const n=vs(e);return!(n===t||!as(n)||fs(n))&&("fixed"===ms(n).position||Rs(n,t))}function Ns(e,t,n){const i=ss(t),r=rs(t),o="fixed"===n,a=Es(e,!0,o,t);let s={scrollLeft:0,scrollTop:0};const c=Fa(0);if(i||!i&&!o)if(("body"!==ns(t)||ls(r))&&(s=gs(t)),i){const e=Es(t,!0,o,t);c.x=e.x+t.clientLeft,c.y=e.y+t.clientTop}else r&&(c.x=Ps(r));return{x:a.left+s.scrollLeft-c.x,y:a.top+s.scrollTop-c.y,width:a.width,height:a.height}}function Os(e,t){return ss(e)&&"fixed"!==ms(e).position?t?t(e):e.offsetParent:null}function _s(e,t){const n=is(e);if(!ss(e))return n;let i=Os(e,t);for(;i&&us(i)&&"static"===ms(i).position;)i=Os(i,t);return i&&("html"===ns(i)||"body"===ns(i)&&"static"===ms(i).position&&!hs(i))?n:i||function(e){let t=vs(e);for(;ss(t)&&!fs(t);){if(hs(t))return t;if(ds(t))return null;t=vs(t)}return null}(e)||n}const Is={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:i}=e;const r=ss(n),o=rs(n);if(n===o)return t;let a={scrollLeft:0,scrollTop:0},s=Fa(1);const c=Fa(0);if((r||!r&&"fixed"!==i)&&(("body"!==ns(n)||ls(o))&&(a=gs(n)),ss(n))){const e=Es(n);s=ws(n),c.x=e.x+n.clientLeft,c.y=e.y+n.clientTop}return{width:t.width*s.x,height:t.height*s.y,x:t.x*s.x-a.scrollLeft*s.x+c.x,y:t.y*s.y-a.scrollTop*s.y+c.y}},getDocumentElement:rs,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:i,strategy:r}=e;const o=[..."clippingAncestors"===n?function(e,t){const n=t.get(e);if(n)return n;let i=bs(e,[],!1).filter((e=>as(e)&&"body"!==ns(e))),r=null;const o="fixed"===ms(e).position;let a=o?vs(e):e;for(;as(a)&&!fs(a);){const t=ms(a),n=hs(a);n||"fixed"!==t.position||(r=null),(o?!n&&!r:!n&&"static"===t.position&&r&&["absolute","fixed"].includes(r.position)||ls(a)&&!n&&Rs(e,a))?i=i.filter((e=>e!==a)):r=t,a=vs(a)}return t.set(e,i),i}(t,this._c):[].concat(n),i],a=o[0],s=o.reduce(((e,n)=>{const i=xs(t,n,r);return e.top=Aa(i.top,e.top),e.right=La(i.right,e.right),e.bottom=La(i.bottom,e.bottom),e.left=Aa(i.left,e.left),e}),xs(t,a,r));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}},getOffsetParent:_s,getElementRects:async function(e){let{reference:t,floating:n,strategy:i}=e;const r=this.getOffsetParent||_s,o=this.getDimensions;return{reference:Ns(t,await r(n),i),floating:{x:0,y:0,...await o(n)}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=ks(e);return{width:t,height:n}},getScale:ws,isElement:as,isRTL:function(e){return"rtl"===ms(e).direction}};const Ds=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:r}=t,{mainAxis:o=!0,crossAxis:a=!1,limiter:s={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...c}=za(e,t),l={x:n,y:i},u=await Za(t,c),d=Ka(Ja(r)),h=Wa(d);let p=l[h],f=l[d];if(o){const e="y"===h?"bottom":"right";p=Va(p+u["y"===h?"top":"left"],p,p-u[e])}if(a){const e="y"===d?"bottom":"right";f=Va(f+u["y"===d?"top":"left"],f,f-u[e])}const m=s.fn({...t,[h]:p,[d]:f});return{...m,data:{x:m.x-n,y:m.y-i,enabled:{[h]:o,[d]:a}}}}}},Ms=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:r,middlewareData:o,rects:a,initialPlacement:s,platform:c,elements:l}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:m=!0,...g}=za(e,t);if(null!=(n=o.arrow)&&n.alignmentOffset)return{};const v=Ja(r),y=Ka(s),b=Ja(s)===s,k=await(null==c.isRTL?void 0:c.isRTL(l.floating)),S=h||(b||!m?[$a(s)]:function(e){const t=$a(e);return[Qa(e),t,Qa(t)]}(s)),w="none"!==f;!h&&w&&S.push(...function(e,t,n,i){const r=qa(e);let o=function(e,t,n){const i=["left","right"],r=["right","left"],o=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?r:i:t?i:r;case"left":case"right":return t?o:a;default:return[]}}(Ja(e),"start"===n,i);return r&&(o=o.map((e=>e+"-"+r)),t&&(o=o.concat(o.map(Qa)))),o}(s,m,f,k));const C=[s,...S],T=await Za(t,g),E=[];let P=(null==(i=o.flip)?void 0:i.overflows)||[];if(u&&E.push(T[v]),d){const e=function(e,t,n){void 0===n&&(n=!1);const i=qa(e),r=Ga(e),o=Ha(r);let a="x"===r?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return t.reference[o]>t.floating[o]&&(a=$a(a)),[a,$a(a)]}(r,a,k);E.push(T[e[0]],T[e[1]])}if(P=[...P,{placement:r,overflows:E}],!E.every((e=>e<=0))){var x,R;const e=((null==(x=o.flip)?void 0:x.index)||0)+1,t=C[e];if(t)return{data:{index:e,overflows:P},reset:{placement:t}};let n=null==(R=P.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:R.placement;if(!n)switch(p){case"bestFit":{var N;const e=null==(N=P.filter((e=>{if(w){const t=Ka(e.placement);return t===y||"y"===t}return!0})).map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:N[0];e&&(n=e);break}case"initialPlacement":n=s}if(r!==n)return{reset:{placement:n}}}return{}}}},Ls=(e,t,n)=>{const i=new Map,r={platform:Is,...n},o={...r.platform,_c:i};return(async(e,t,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:o=[],platform:a}=n,s=o.filter(Boolean),c=await(null==a.isRTL?void 0:a.isRTL(t));let l=await a.getElementRects({reference:e,floating:t,strategy:r}),{x:u,y:d}=Xa(l,i,c),h=i,p={},f=0;for(let m=0;m<s.length;m++){const{name:n,fn:o}=s[m],{x:g,y:v,data:y,reset:b}=await o({x:u,y:d,initialPlacement:i,placement:h,strategy:r,middlewareData:p,rects:l,platform:a,elements:{reference:e,floating:t}});u=null!=g?g:u,d=null!=v?v:d,p={...p,[n]:{...p[n],...y}},b&&f<=50&&(f++,"object"===typeof b&&(b.placement&&(h=b.placement),b.rects&&(l=!0===b.rects?await a.getElementRects({reference:e,floating:t,strategy:r}):b.rects),({x:u,y:d}=Xa(l,h,c))),m=-1)}return{x:u,y:d,placement:h,strategy:r,middlewareData:p}})(e,t,{...r,platform:o})};var As=n(318);function Us(e){return"function"===typeof e}function Fs(e){return function(t){if(function(e){return Us(null===e||void 0===e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(n){this.error(n)}}));throw new TypeError("Unable to lift unknown Observable type")}}var js=function(e,t){return js=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},js(e,t)};function Bs(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}js(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function Vs(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(t){o(t)}}function s(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))}function zs(e,t){var n,i,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(c){s=[6,c],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}Object.create;function Js(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function qs(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(s){r={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function Ws(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function Hs(e){return this instanceof Hs?(this.v=e,this):new Hs(e)}function Ks(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i=Object.create(("function"===typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",(function(e){return function(t){return Promise.resolve(t).then(e,l)}})),i[Symbol.asyncIterator]=function(){return this},i;function a(e,t){r[e]&&(i[e]=function(t){return new Promise((function(n,i){o.push([e,t,n,i])>1||s(e,t)}))},t&&(i[e]=t(i[e])))}function s(e,t){try{!function(e){e.value instanceof Hs?Promise.resolve(e.value.v).then(c,l):u(o[0][2],e)}(r[e](t))}catch(n){u(o[0][3],n)}}function c(e){s("next",e)}function l(e){s("throw",e)}function u(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function Gs(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Js(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){(function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)})(i,r,(t=e[n](t)).done,t.value)}))}}}Object.create;"function"===typeof SuppressedError&&SuppressedError;function Qs(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var $s=Qs((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function Ys(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Xs=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,i,r;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=Js(o),s=a.next();!s.done;s=a.next()){s.value.remove(this)}}catch(p){e={error:p}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else o.remove(this);var c=this.initialTeardown;if(Us(c))try{c()}catch(f){r=f instanceof $s?f.errors:[f]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var u=Js(l),d=u.next();!d.done;d=u.next()){var h=d.value;try{tc(h)}catch(m){r=null!==r&&void 0!==r?r:[],m instanceof $s?r=Ws(Ws([],qs(r)),qs(m.errors)):r.push(m)}}}catch(g){n={error:g}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}if(r)throw new $s(r)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)tc(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Ys(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&Ys(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),Zs=Xs.EMPTY;function ec(e){return e instanceof Xs||e&&"closed"in e&&Us(e.remove)&&Us(e.add)&&Us(e.unsubscribe)}function tc(e){Us(e)?e():e.unsubscribe()}var nc={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ic={setTimeout:function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=ic.delegate;return(null===r||void 0===r?void 0:r.setTimeout)?r.setTimeout.apply(r,Ws([e,t],qs(n))):setTimeout.apply(void 0,Ws([e,t],qs(n)))},clearTimeout:function(e){var t=ic.delegate;return((null===t||void 0===t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function rc(e){ic.setTimeout((function(){var t=nc.onUnhandledError;if(!t)throw e;t(e)}))}function oc(){}var ac=sc("C",void 0,void 0);function sc(e,t,n){return{kind:e,value:t,error:n}}var cc=null;function lc(e){if(nc.useDeprecatedSynchronousErrorHandling){var t=!cc;if(t&&(cc={errorThrown:!1,error:null}),e(),t){var n=cc,i=n.errorThrown,r=n.error;if(cc=null,i)throw r}}else e()}var uc=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,ec(t)&&t.add(n)):n.destination=vc,n}return Bs(t,e),t.create=function(e,t,n){return new fc(e,t,n)},t.prototype.next=function(e){this.isStopped?gc(function(e){return sc("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?gc(sc("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?gc(ac,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Xs),dc=Function.prototype.bind;function hc(e,t){return dc.call(e,t)}var pc=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){mc(n)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){mc(n)}else mc(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){mc(t)}},e}(),fc=function(e){function t(t,n,i){var r,o,a=e.call(this)||this;Us(t)||!t?r={next:null!==t&&void 0!==t?t:void 0,error:null!==n&&void 0!==n?n:void 0,complete:null!==i&&void 0!==i?i:void 0}:a&&nc.useDeprecatedNextContext?((o=Object.create(t)).unsubscribe=function(){return a.unsubscribe()},r={next:t.next&&hc(t.next,o),error:t.error&&hc(t.error,o),complete:t.complete&&hc(t.complete,o)}):r=t;return a.destination=new pc(r),a}return Bs(t,e),t}(uc);function mc(e){var t;nc.useDeprecatedSynchronousErrorHandling?(t=e,nc.useDeprecatedSynchronousErrorHandling&&cc&&(cc.errorThrown=!0,cc.error=t)):rc(e)}function gc(e,t){var n=nc.onStoppedNotification;n&&ic.setTimeout((function(){return n(e,t)}))}var vc={closed:!0,next:oc,error:function(e){throw e},complete:oc};function yc(e,t,n,i,r){return new bc(e,t,n,i,r)}var bc=function(e){function t(t,n,i,r,o,a){var s=e.call(this,t)||this;return s.onFinalize=o,s.shouldUnsubscribe=a,s._next=n?function(e){try{n(e)}catch(i){t.error(i)}}:e.prototype._next,s._error=r?function(e){try{r(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=i?function(){try{i()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return Bs(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(uc);function kc(e,t){return Fs((function(n,i){var r=0;n.subscribe(yc(i,(function(n){i.next(e.call(t,n,r++))})))}))}var Sc=function(e){return e&&"number"===typeof e.length&&"function"!==typeof e};function wc(e){return Us(null===e||void 0===e?void 0:e.then)}var Cc="function"===typeof Symbol&&Symbol.observable||"@@observable";function Tc(e){return e}function Ec(e){return 0===e.length?Tc:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Pc=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var i,r=this,o=(i=e)&&i instanceof uc||function(e){return e&&Us(e.next)&&Us(e.error)&&Us(e.complete)}(i)&&ec(i)?e:new fc(e,t,n);return lc((function(){var e=r,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?r._subscribe(o):r._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=xc(t))((function(t,i){var r=new fc({next:function(t){try{e(t)}catch(n){i(n),r.unsubscribe()}},error:i,complete:t});n.subscribe(r)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[Cc]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ec(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=xc(e))((function(e,n){var i;t.subscribe((function(e){return i=e}),(function(e){return n(e)}),(function(){return e(i)}))}))},e.create=function(t){return new e(t)},e}();function xc(e){var t;return null!==(t=null!==e&&void 0!==e?e:nc.Promise)&&void 0!==t?t:Promise}function Rc(e){return Us(e[Cc])}function Nc(e){return Symbol.asyncIterator&&Us(null===e||void 0===e?void 0:e[Symbol.asyncIterator])}function Oc(e){return new TypeError("You provided "+(null!==e&&"object"===typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var _c="function"===typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ic(e){return Us(null===e||void 0===e?void 0:e[_c])}function Dc(e){return Ks(this,arguments,(function(){var t,n,i;return zs(this,(function(r){switch(r.label){case 0:t=e.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,Hs(t.read())];case 3:return n=r.sent(),i=n.value,n.done?[4,Hs(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,Hs(i)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function Mc(e){return Us(null===e||void 0===e?void 0:e.getReader)}function Lc(e){if(e instanceof Pc)return e;if(null!=e){if(Rc(e))return r=e,new Pc((function(e){var t=r[Cc]();if(Us(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(Sc(e))return i=e,new Pc((function(e){for(var t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()}));if(wc(e))return n=e,new Pc((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,rc)}));if(Nc(e))return Ac(e);if(Ic(e))return t=e,new Pc((function(e){var n,i;try{for(var r=Js(t),o=r.next();!o.done;o=r.next()){var a=o.value;if(e.next(a),e.closed)return}}catch(s){n={error:s}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}e.complete()}));if(Mc(e))return Ac(Dc(e))}var t,n,i,r;throw Oc(e)}function Ac(e){return new Pc((function(t){(function(e,t){var n,i,r,o;return Vs(this,void 0,void 0,(function(){var a,s;return zs(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=Gs(e),c.label=1;case 1:return[4,n.next()];case 2:if((i=c.sent()).done)return[3,4];if(a=i.value,t.next(a),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=c.sent(),r={error:s},[3,11];case 6:return c.trys.push([6,,9,10]),i&&!i.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function Uc(e,t,n,i,r){void 0===i&&(i=0),void 0===r&&(r=!1);var o=t.schedule((function(){n(),r?e.add(this.schedule(null,i)):this.unsubscribe()}),i);if(e.add(o),!r)return o}function Fc(e,t,n){return void 0===n&&(n=1/0),Us(t)?Fc((function(n,i){return kc((function(e,r){return t(n,e,i,r)}))(Lc(e(n,i)))}),n):("number"===typeof t&&(n=t),Fs((function(t,i){return function(e,t,n,i,r,o,a,s){var c=[],l=0,u=0,d=!1,h=function(){!d||c.length||l||t.complete()},p=function(e){return l<i?f(e):c.push(e)},f=function(e){o&&t.next(e),l++;var s=!1;Lc(n(e,u++)).subscribe(yc(t,(function(e){null===r||void 0===r||r(e),o?p(e):t.next(e)}),(function(){s=!0}),void 0,(function(){if(s)try{l--;for(var e=function(){var e=c.shift();a?Uc(t,a,(function(){return f(e)})):f(e)};c.length&&l<i;)e();h()}catch(n){t.error(n)}})))};return e.subscribe(yc(t,p,(function(){d=!0,h()}))),function(){null===s||void 0===s||s()}}(t,i,e,n)})))}function jc(){return void 0===(e=1)&&(e=1/0),Fc(Tc,e);var e}function Bc(e){return e[e.length-1]}function Vc(e){return(t=Bc(e))&&Us(t.schedule)?e.pop():void 0;var t}function zc(e,t){return void 0===t&&(t=0),Fs((function(n,i){n.subscribe(yc(i,(function(n){return Uc(i,e,(function(){return i.next(n)}),t)}),(function(){return Uc(i,e,(function(){return i.complete()}),t)}),(function(n){return Uc(i,e,(function(){return i.error(n)}),t)})))}))}function Jc(e,t){return void 0===t&&(t=0),Fs((function(n,i){i.add(e.schedule((function(){return n.subscribe(i)}),t))}))}function qc(e,t){if(!e)throw new Error("Iterable cannot be null");return new Pc((function(n){Uc(n,t,(function(){var i=e[Symbol.asyncIterator]();Uc(n,t,(function(){i.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function Wc(e,t){if(null!=e){if(Rc(e))return function(e,t){return Lc(e).pipe(Jc(t),zc(t))}(e,t);if(Sc(e))return function(e,t){return new Pc((function(n){var i=0;return t.schedule((function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())}))}))}(e,t);if(wc(e))return function(e,t){return Lc(e).pipe(Jc(t),zc(t))}(e,t);if(Nc(e))return qc(e,t);if(Ic(e))return function(e,t){return new Pc((function(n){var i;return Uc(n,t,(function(){i=e[_c](),Uc(n,t,(function(){var e,t,r;try{t=(e=i.next()).value,r=e.done}catch(o){return void n.error(o)}r?n.complete():n.next(t)}),0,!0)})),function(){return Us(null===i||void 0===i?void 0:i.return)&&i.return()}}))}(e,t);if(Mc(e))return function(e,t){return qc(Dc(e),t)}(e,t)}throw Oc(e)}function Hc(e,t){return t?Wc(e,t):Lc(e)}function Kc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return jc()(Hc(e,Vc(e)))}function Gc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Vc(e);return Fs((function(t,i){(n?Kc(e,t,n):Kc(e,t)).subscribe(i)}))}var Qc=Qs((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),$c=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return Bs(t,e),t.prototype.lift=function(e){var t=new Yc(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new Qc},t.prototype.next=function(e){var t=this;lc((function(){var n,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var r=Js(t.currentObservers),o=r.next();!o.done;o=r.next()){o.value.next(e)}}catch(a){n={error:a}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;lc((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;lc((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,i=n.hasError,r=n.isStopped,o=n.observers;return i||r?Zs:(this.currentObservers=null,o.push(e),new Xs((function(){t.currentObservers=null,Ys(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,i=t.thrownError,r=t.isStopped;n?e.error(i):r&&e.complete()},t.prototype.asObservable=function(){var e=new Pc;return e.source=this,e},t.create=function(e,t){return new Yc(e,t)},t}(Pc),Yc=function(e){function t(t,n){var i=e.call(this)||this;return i.destination=t,i.source=n,i}return Bs(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Zs},t}($c);function Xc(e,t){return Fs((function(n,i){var r=0;n.subscribe(yc(i,(function(n){return e.call(t,n,r++)&&i.next(n)})))}))}var Zc=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return Bs(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,i=e._value;if(t)throw n;return this._throwIfClosed(),i},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}($c);function el(e){return Fs((function(t,n){Lc(e).subscribe(yc(n,(function(){return n.complete()}),oc)),!n.closed&&t.subscribe(n)}))}function tl(e,t){return Fs(function(e,t,n,i,r){return function(o,a){var s=n,c=t,l=0;o.subscribe(yc(a,(function(t){var n=l++;c=s?e(c,t,n):(s=!0,t),i&&a.next(c)}),r&&function(){s&&a.next(c),a.complete()}))}}(e,t,arguments.length>=2,!0))}function nl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Hc(e,Vc(e))}var il=Array.isArray;function rl(e){return kc((function(t){return function(e,t){return il(t)?e.apply(void 0,Ws([],qs(t))):e(t)}(e,t)}))}var ol=["addListener","removeListener"],al=["addEventListener","removeEventListener"],sl=["on","off"];function cl(e,t,n,i){if(Us(n)&&(i=n,n=void 0),i)return cl(e,t,n).pipe(rl(i));var r=qs(function(e){return Us(e.addEventListener)&&Us(e.removeEventListener)}(e)?al.map((function(i){return function(r){return e[i](t,r,n)}})):function(e){return Us(e.addListener)&&Us(e.removeListener)}(e)?ol.map(ll(e,t)):function(e){return Us(e.on)&&Us(e.off)}(e)?sl.map(ll(e,t)):[],2),o=r[0],a=r[1];if(!o&&Sc(e))return Fc((function(e){return cl(e,t,n)}))(Lc(e));if(!o)throw new TypeError("Invalid event target");return new Pc((function(e){var t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1<t.length?t:t[0])};return o(t),function(){return a(t)}}))}function ll(e,t){return function(n){return function(i){return e[n](t,i)}}}var ul=function(e){function t(t,n){return e.call(this)||this}return Bs(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(Xs),dl={setInterval:function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=dl.delegate;return(null===r||void 0===r?void 0:r.setInterval)?r.setInterval.apply(r,Ws([e,t],qs(n))):setInterval.apply(void 0,Ws([e,t],qs(n)))},clearInterval:function(e){var t=dl.delegate;return((null===t||void 0===t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},hl=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return Bs(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),dl.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&dl.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,i=!1;try{this.work(e)}catch(r){i=!0,n=r||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,i=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Ys(i,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(ul),pl={now:function(){return(pl.delegate||Date).now()},delegate:void 0},fl=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=pl.now,e}(),ml=new(function(e){function t(t,n){void 0===n&&(n=fl.now);var i=e.call(this,t,n)||this;return i.actions=[],i._active=!1,i}return Bs(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(fl))(hl);var gl=Qs((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));function vl(e,t){var n,i=(n=e)instanceof Date&&!isNaN(n)?{first:e}:"number"===typeof e?{each:e}:e,r=i.first,o=i.each,a=i.with,s=void 0===a?yl:a,c=i.scheduler,l=void 0===c?null!==t&&void 0!==t?t:ml:c,u=i.meta,d=void 0===u?null:u;if(null==r&&null==o)throw new TypeError("No timeout provided.");return Fs((function(e,t){var n,i,a=null,c=0,u=function(e){i=Uc(t,l,(function(){try{n.unsubscribe(),Lc(s({meta:d,lastValue:a,seen:c})).subscribe(t)}catch(e){t.error(e)}}),e)};n=e.subscribe(yc(t,(function(e){null===i||void 0===i||i.unsubscribe(),c++,t.next(a=e),o>0&&u(o)}),void 0,void 0,(function(){(null===i||void 0===i?void 0:i.closed)||null===i||void 0===i||i.unsubscribe(),a=null}))),!c&&u(null!=r?"number"===typeof r?r:+r-l.now():o)}))}function yl(e){throw new gl(e)}function bl(e,t){return e===t}var kl=Object.defineProperty,Sl=Object.defineProperties,wl=Object.getOwnPropertyDescriptors,Cl=Object.getOwnPropertySymbols,Tl=Object.prototype.hasOwnProperty,El=Object.prototype.propertyIsEnumerable,Pl=(e,t,n)=>t in e?kl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xl=(e,t)=>{for(var n in t||(t={}))Tl.call(t,n)&&Pl(e,n,t[n]);if(Cl)for(var n of Cl(t))El.call(t,n)&&Pl(e,n,t[n]);return e},Rl=(e,t,n)=>new Promise(((i,r)=>{var o=e=>{try{s(n.next(e))}catch(t){r(t)}},a=e=>{try{s(n.throw(e))}catch(t){r(t)}},s=e=>e.done?i(e.value):Promise.resolve(e.value).then(o,a);s((n=n.apply(e,t)).next())}));function Nl(e){return"undefined"!==typeof e&&(function(e){var t;if(!e)return!1;return e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("track")&&"undefined"!==typeof(null==(t=e.publication)?void 0:t.track)}(e)||function(e){if(!e)return!1;return e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("publication")&&"undefined"!==typeof e.publication}(e))}function Ol(e){return!!e&&(e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&"undefined"===typeof e.publication)}function _l(e){if("string"===typeof e||"number"===typeof e)return`${e}`;if(Ol(e))return`${e.participant.identity}_${e.source}_placeholder`;if(Nl(e))return`${e.participant.identity}_${e.publication.source}_${e.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${e}`)}function Il(e,t){return void 0!==e&&void 0!==t&&(Nl(e)&&Nl(t)?e.publication.trackSid===t.publication.trackSid:_l(e)===_l(t))}function Dl(e,t){return"undefined"!==typeof t&&(Nl(e)?t.some((t=>t.participant.identity===e.participant.identity&&Nl(t)&&t.publication.trackSid===e.publication.trackSid)):!!Ol(e)&&t.some((t=>t.participant.identity===e.participant.identity&&Ol(t)&&t.source===e.source)))}function Ml(e){return e instanceof Ra}function Ll(){return"undefined"!==typeof document}var Al=[...[ui.ConnectionStateChanged,ui.RoomMetadataChanged,ui.ActiveSpeakersChanged,ui.ConnectionQualityChanged,ui.ParticipantConnected,ui.ParticipantDisconnected,ui.ParticipantPermissionsChanged,ui.ParticipantMetadataChanged,ui.TrackMuted,ui.TrackUnmuted,ui.TrackPublished,ui.TrackUnpublished,ui.TrackStreamStateChanged,ui.TrackSubscriptionFailed,ui.TrackSubscriptionPermissionChanged,ui.TrackSubscriptionStatusChanged],ui.LocalTrackPublished,ui.LocalTrackUnpublished],Ul=(di.ConnectionQualityChanged,di.IsSpeakingChanged,di.ParticipantMetadataChanged,di.ParticipantPermissionsChanged,di.TrackMuted,di.TrackUnmuted,di.TrackPublished,di.TrackUnpublished,di.TrackStreamStateChanged,di.TrackSubscriptionFailed,di.TrackSubscriptionPermissionChanged,di.TrackSubscriptionStatusChanged,di.LocalTrackPublished,di.LocalTrackUnpublished,As.getLogger("lk-components-js"));Ul.setDefaultLevel("WARN");var Fl=[{columns:1,rows:1,name:"1x1",minTiles:1,maxTiles:1,minWidth:0,minHeight:0},{columns:1,rows:2,name:"1x2",minTiles:2,maxTiles:2,minWidth:0,minHeight:0},{columns:2,rows:1,name:"2x1",minTiles:2,maxTiles:2,minWidth:900,minHeight:0},{columns:2,rows:2,name:"2x2",minTiles:3,maxTiles:4,minWidth:560,minHeight:0},{columns:3,rows:3,name:"3x3",minTiles:5,maxTiles:9,minWidth:700,minHeight:0},{columns:4,rows:4,name:"4x4",minTiles:10,maxTiles:16,minWidth:960,minHeight:0},{columns:5,rows:5,name:"5x5",minTiles:17,maxTiles:25,minWidth:1100,minHeight:0}];function jl(e,t,n,i){let r=0,o=e.find(((e,n,i)=>{r=n;const o=-1!==i.findIndex(((t,i)=>{const r=i>n,o=t.maxTiles===e.maxTiles;return r&&o}));return e.maxTiles>=t&&!o}));if(void 0===o){if(o=e[e.length-1],!o)throw new Error("No layout or fallback layout found.");Ul.warn(`No layout found for: participantCount: ${t}, width/height: ${n}/${i} fallback to biggest available layout (${o.name}).`)}if((n<o.minWidth||i<o.minHeight)&&r>0){const t=e[r-1];o=jl(e.slice(0,r),t.maxTiles,n,i)}return o}var Bl=[],Vl={showChat:!1,unreadMessages:0};function zl(e){return"object"===typeof e}function Jl(e){return Array.isArray(e)&&e.filter(zl).length>0}function ql(e,t){return t.audioLevel-e.audioLevel}function Wl(e,t){return e.isSpeaking===t.isSpeaking?0:e.isSpeaking?-1:1}function Hl(e,t){var n,i,r,o;return void 0!==e.lastSpokeAt||void 0!==t.lastSpokeAt?(null!=(i=null==(n=t.lastSpokeAt)?void 0:n.getTime())?i:0)-(null!=(o=null==(r=e.lastSpokeAt)?void 0:r.getTime())?o:0):0}function Kl(e,t){var n,i,r,o;return(null!=(i=null==(n=e.joinedAt)?void 0:n.getTime())?i:0)-(null!=(o=null==(r=t.joinedAt)?void 0:r.getTime())?o:0)}function Gl(e){const t=[],n=[],i=[],r=[];e.forEach((e=>{e.participant.isLocal&&e.source===vr.Source.Camera?t.push(e):e.source===vr.Source.ScreenShare?n.push(e):e.source===vr.Source.Camera?i.push(e):r.push(e)}));const o=function(e){const t=[],n=[];e.forEach((e=>{e.participant.isLocal?t.push(e):n.push(e)})),t.sort(((e,t)=>Kl(e.participant,t.participant))),n.sort(((e,t)=>Kl(e.participant,t.participant)));return[...n,...t]}(n),a=function(e){const t=[],n=[];return e.forEach((e=>{e.participant.isLocal?t.push(e):n.push(e)})),n.sort(((e,t)=>e.participant.isSpeaking&&t.participant.isSpeaking?ql(e.participant,t.participant):e.participant.isSpeaking!==t.participant.isSpeaking?Wl(e.participant,t.participant):e.participant.lastSpokeAt!==t.participant.lastSpokeAt?Hl(e.participant,t.participant):Nl(e)!==Nl(t)?function(e,t){return Nl(e)?Nl(t)?0:-1:Nl(t)?1:0}(e,t):e.participant.isCameraEnabled!==t.participant.isCameraEnabled?function(e,t){const n=e.participant.isCameraEnabled;return n!==t.participant.isCameraEnabled?n?-1:1:0}(e,t):Kl(e.participant,t.participant))),[...t,...n]}(i);return[...t,...o,...a,...r]}function Ql(e,t){const n=Math.max(e.length,t.length);return new Array(n).fill([]).map(((n,i)=>[e[i],t[i]]))}function $l(e,t,n){return e.filter((e=>!t.map((e=>n(e))).includes(n(e))))}function Yl(e){return e.map((e=>"string"===typeof e||"number"===typeof e?`${e}`:_l(e)))}function Xl(e,t){const n=t.findIndex((t=>_l(t)===_l(e)));if(-1===n)throw new Error(`Element not part of the array: ${_l(e)} not in ${Yl(t)}`);return n}function Zl(e,t){const n=function(e,t){return e.reduce(((e,n,i)=>i%t===0?[...e,[n]]:[...e.slice(0,-1),[...e.slice(-1)[0],n]]),[])}(e,t);return n}function eu(e,t,n){let i=function(e,t){return e.map((e=>{const n=t.find((t=>{return _l(e)===_l(t)||"number"!==typeof e&&Ol(e)&&Nl(t)&&(i=t,Ol(n=e)&&Nl(i)&&i.participant.identity===n.participant.identity&&i.source===n.source);var n,i}));return null!=n?n:e}))}(e,t);if(i.length<t.length){const e=$l(t,i,_l);i=[...i,...e]}if(Ql(Zl(i,n),Zl(t,n)).forEach(((e,t)=>{let[r,o]=e;if(r&&o){const e=Zl(i,n)[t],c={dropped:$l(a=e,s=o,_l),added:$l(s,a,_l)};(function(e){return 0!==e.added.length||0!==e.dropped.length})(c)&&(Ul.debug(`Detected visual changes on page: ${t}, current: ${Yl(r)}, next: ${Yl(o)}`,{changes:c}),c.added.length===c.dropped.length&&Ql(c.added,c.dropped).forEach((e=>{let[t,n]=e;if(!t||!n)throw new Error(`For a swap action we need a addition and a removal one is missing: ${t}, ${n}`);i=function(e,t,n){const i=Xl(e,n),r=Xl(t,n);return n.splice(i,1,t),n.splice(r,1,e),n}(t,n,i)})),0===c.added.length&&c.dropped.length>0&&c.dropped.forEach((e=>{i=function(e,t){const n=Xl(e,t);return t.splice(n,1),t}(e,i)})),c.added.length>0&&0===c.dropped.length&&c.added.forEach((e=>{var t,n;t=e,n=i,i=[...n,t]})))}var a,s})),i.length>t.length){const e=$l(i,t,_l);i=i.filter((t=>!e.map(_l).includes(_l(t))))}return i}function tu(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new Pc((t=>{const i=()=>{t.next(e)};n.forEach((t=>{e.on(t,i)}));return()=>{n.forEach((t=>{e.off(t,i)}))}})).pipe(Gc(e))}function nu(e,t){const n=new Pc((n=>{const i=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.next(t)};e.on(t,i);return()=>{e.off(t,i)}}));return n}function iu(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var i;const r=()=>Rl(this,null,(function*(){try{const t=yield Na.getLocalDevices(e,n);o.next(t)}catch(i){null==t||t(i)}})),o=new $c,a=o.pipe((s=()=>{var e;null==(e=null==navigator?void 0:navigator.mediaDevices)||e.removeEventListener("devicechange",r)},Fs((function(e,t){try{e.subscribe(t)}finally{t.add(s)}}))));var s;if("undefined"!==typeof window){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");null==(i=null==navigator?void 0:navigator.mediaDevices)||i.addEventListener("devicechange",r)}return Kc(Na.getLocalDevices(e,n).catch((e=>null==t?void 0:t(e))),a)}function ru(e){return tu(e,ui.AudioPlaybackStatusChanged).pipe(kc((e=>({canPlayAudio:e.canPlaybackAudio}))))}function ou(e){return tu(e,ui.VideoPlaybackStatusChanged).pipe(kc((e=>({canPlayVideo:e.canPlaybackVideo}))))}function au(e){return`lk-${e}`}function su(e){if(Nl(e))return e.publication;{const{source:t,name:n,participant:i}=e;if(t&&n)return i.getTracks().find((e=>e.source===t&&e.trackName===n));if(n)return i.getTrackByName(n);if(t)return i.getTrack(t);throw new Error("At least one of source and name needs to be defined")}}function cu(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new Pc((t=>{const i=()=>{t.next(e)};n.forEach((t=>{e.on(t,i)}));return()=>{n.forEach((t=>{e.off(t,i)}))}})).pipe(Gc(e))}function lu(e){return cu(e,di.TrackMuted,di.TrackUnmuted,di.ParticipantPermissionsChanged,di.TrackPublished,di.TrackUnpublished,di.LocalTrackPublished,di.LocalTrackUnpublished,di.MediaDevicesError,di.TrackSubscriptionStatusChanged).pipe(kc((e=>{const{isMicrophoneEnabled:t,isCameraEnabled:n,isScreenShareEnabled:i}=e,r=e.getTrack(vr.Source.Microphone);return{isCameraEnabled:n,isMicrophoneEnabled:t,isScreenShareEnabled:i,cameraTrack:e.getTrack(vr.Source.Camera),microphoneTrack:r,participant:e}})))}function uu(e,t){const n=new Pc((n=>{const i=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.next(t)};e.on(t,i);return()=>{e.off(t,i)}}));return n}function du(e){var t,n,i,r;return cu(e.participant,di.TrackMuted,di.TrackUnmuted,di.TrackSubscribed,di.TrackUnsubscribed,di.LocalTrackPublished,di.LocalTrackUnpublished).pipe(kc((t=>{var n,i;const r=null!=(n=e.publication)?n:t.getTrack(e.source);return null==(i=null==r?void 0:r.isMuted)||i})),Gc(null==(r=null!=(i=null==(t=e.publication)?void 0:t.isMuted)?i:null==(n=e.participant.getTrack(e.source))?void 0:n.isMuted)||r))}function hu(e,t,n){var i=this;const r=new Zc(void 0),o=t?function(e,t){return nu(e,ui.ActiveDeviceChanged).pipe(Xc((e=>{let[n]=e;return n===t})),kc((e=>{let[t,n]=e;return Ul.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:t,deviceId:n}),n})),Gc(e.getActiveDevice(t)))}(t,e):r.asObservable();return{className:au("media-device-select"),activeDeviceObservable:o,setActiveMediaDevice:function(o){for(var a=arguments.length,s=new Array(a>1?a-1:0),c=1;c<a;c++)s[c-1]=arguments[c];return Rl(i,[o,...s],(function(i){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var a,s,c;if(t){Ul.debug(`Switching active device of kind "${e}" with id ${i}.`),yield t.switchActiveDevice(e,i,o.exact);const n=null!=(a=t.getActiveDevice(e))?a:i;let l;n!==i&&"default"!==i&&Ul.info(`We tried to select the device with id (${i}), but the browser decided to select the device with id (${n}) instead.`),"audioinput"===e?l=null==(s=t.localParticipant.getTrack(vr.Source.Microphone))?void 0:s.track:"videoinput"===e&&(l=null==(c=t.localParticipant.getTrack(vr.Source.Camera))?void 0:c.track);const u="default"===i&&!l||"default"===i&&(null==l?void 0:l.mediaStreamTrack.label.startsWith("Default"));r.next(u?i:n)}else if(n){yield n.setDeviceId(o.exact?{exact:i}:i);const e=yield n.getDeviceId();r.next("default"===i&&n.mediaStreamTrack.label.startsWith("Default")?i:e)}else r.value!==i&&(Ul.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(i))}()}))}}}function pu(e){const t=au("connection-quality"),n=function(e){return uu(e,di.ConnectionQualityChanged).pipe(kc((e=>{let[t]=e;return t})),Gc(e.connectionQuality))}(e);return{className:t,connectionQualityObserver:n}}function fu(e){const t=function(e){const t=cu(e,di.ParticipantMetadataChanged).pipe(kc((e=>{let{name:t,identity:n,metadata:i}=e;return{name:t,identity:n,metadata:i}})),Gc({name:e.name,identity:e.identity,metadata:e.metadata}));return t}(e);return{className:"lk-participant-name",infoObserver:t}}var mu="lk-chat-topic";function gu(e,t,n){return Rl(this,arguments,(function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function*(){const{kind:r,destination:o}=i;yield e.publishData(t,null!=r?r:tt.RELIABLE,{destination:o,topic:n})}()}))}function vu(e,t,n){var i=this;const r=function(e){return nu(e,ui.DataReceived)}(e).pipe(Xc((e=>{let[,,,n]=e;return void 0===t||n===t})),kc((e=>{let[t,i,,r]=e;const o={payload:t,topic:r,from:i};return null==n||n(o),o})));let o;return{messageObservable:r,isSendingObservable:new Pc((e=>{o=e})),send:function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return Rl(i,[n,...a],(function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){o.next(!0);try{yield gu(e.localParticipant,n,t,i)}finally{o.next(!1)}}()}))}}}var yu=new TextEncoder,bu=new TextDecoder,ku=new Map,Su=e=>yu.encode(JSON.stringify({message:e.message,timestamp:e.timestamp})),wu=e=>JSON.parse(bu.decode(e));function Cu(e,t){var n,i;const r=new $c,{messageDecoder:o,messageEncoder:a,channelTopic:s}=null!=t?t:{},c=null!=s?s:mu;let l=!1;ku.has(e)||(l=!0);const u=null!=(n=ku.get(e))?n:new Map,d=null!=(i=u.get(c))?i:new $c;if(u.set(c,d),ku.set(e,u),l){const{messageObservable:t}=vu(e,c);t.pipe(el(r)).subscribe(d)}const h=null!=o?o:wu,p=d.pipe(kc((e=>{const t=h(e.payload);var n,i;return n=xl({},t),i={from:e.from},Sl(n,wl(i))})),tl(((e,t)=>[...e,t]),[]),el(r)),f=new Zc(!1),m=null!=a?a:Su;return e.once(ui.Disconnected,(function(){r.next(),r.complete(),ku.clear()})),{messageObservable:p,isSendingObservable:f,send:t=>Rl(this,null,(function*(){const n=Date.now(),i=m({message:t,timestamp:n});f.next(!0);try{yield gu(e.localParticipant,i,c,{kind:tt.RELIABLE}),d.next({payload:i,topic:c,from:e.localParticipant})}finally{f.next(!1)}}))}}function Tu(){return{className:au("start-audio-button"),roomVideoPlaybackAllowedObservable:ou,handleStartVideoPlayback:e=>Rl(this,null,(function*(){Ul.info("Start Video for room: ",e),yield e.startVideo()}))}}function Eu(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=[e.localParticipant,...Array.from(e.participants.values())],r=[];return i.forEach((e=>{t.forEach((t=>{const i=Array.from(e.tracks.values()).filter((e=>e.source===t&&(!n||e.track))).map((t=>({participant:e,publication:t,source:t.source})));r.push(...i)}))})),{trackReferences:r,participants:i}}function Pu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(null===e)return nl(!1);const n=cl(e,"mousemove",{passive:!0}).pipe(kc((()=>!0))),i=n.pipe(vl({each:t,with:()=>{return Kc(nl(!1),i.pipe((e=n,Fs((function(t,n){var i=!1,r=yc(n,(function(){null===r||void 0===r||r.unsubscribe(),i=!0}),oc);Lc(e).subscribe(r),t.subscribe(yc(n,(function(e){return i&&n.next(e)})))})))));var e}}),(void 0===o&&(o=Tc),r=null!==r&&void 0!==r?r:bl,Fs((function(e,t){var n,i=!0;e.subscribe(yc(t,(function(e){var a=o(e);!i&&r(n,a)||(i=!1,n=a,t.next(e))})))}))));var r,o;return i}var xu,Ru=!0,Nu=!0,Ou="",_u="",Iu="",Du=!1,Mu="",{load:Lu,save:Au}=(xu="lk-user-choices",{load:()=>function(e){if("undefined"!==typeof localStorage)try{const t=localStorage.getItem(e);return t?JSON.parse(t):void Ul.warn(`Item with key ${e} does not exist in local storage.`)}catch(t){return void Ul.error(`Error getting item from local storage: ${t}`)}else Ul.error("Local storage is not available.")}(xu),save:e=>function(e,t){if("undefined"!==typeof localStorage)try{localStorage.setItem(e,JSON.stringify(t))}catch(n){Ul.error(`Error setting item to local storage: ${n}`)}else Ul.error("Local storage is not available.")}(xu,e)});function Uu(e){if(!0===(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return;const t=e,{e2ee:n,sharedPassphrase:i}=t,r=((e,t)=>{var n={};for(var i in e)Tl.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&Cl)for(var i of Cl(e))t.indexOf(i)<0&&El.call(e,i)&&(n[i]=e[i]);return n})(t,["e2ee","sharedPassphrase"]);Au(r)}function Fu(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=Fu(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}const ju=function(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=Fu(e))&&(i&&(i+=" "),i+=t);return i};const Bu=function(t,n){const[i,r]=(0,e.useState)(t);return(0,e.useEffect)((()=>{const e=setTimeout((()=>r(t)),n||500);return()=>{clearTimeout(e)}}),[t,n]),i};const Vu=function(t,n){let{threshold:i=0,root:r=null,rootMargin:o="0%",freezeOnceVisible:a=!1}=n;const[s,c]=(0,e.useState)(),l=(null===s||void 0===s?void 0:s.isIntersecting)&&a,u=e=>{let[t]=e;c(t)};return(0,e.useEffect)((()=>{const e=null===t||void 0===t?void 0:t.current;if(!!!window.IntersectionObserver||l||!e)return;const n=new IntersectionObserver(u,{threshold:i,root:r,rootMargin:o});return n.observe(e),()=>n.disconnect()}),[null===t||void 0===t?void 0:t.current,JSON.stringify(i),r,o,l]),s};"undefined"!==typeof window?e.useLayoutEffect:e.useEffect;var zu,Ju=Object.defineProperty,qu=Object.defineProperties,Wu=Object.getOwnPropertyDescriptors,Hu=Object.getOwnPropertySymbols,Ku=Object.prototype.hasOwnProperty,Gu=Object.prototype.propertyIsEnumerable,Qu=(e,t,n)=>t in e?Ju(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$u=(e,t)=>{for(var n in t||(t={}))Ku.call(t,n)&&Qu(e,n,t[n]);if(Hu)for(var n of Hu(t))Gu.call(t,n)&&Qu(e,n,t[n]);return e},Yu=(e,t)=>qu(e,Wu(t)),Xu=(e,t)=>{var n={};for(var i in e)Ku.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&Hu)for(var i of Hu(e))t.indexOf(i)<0&&Gu.call(e,i)&&(n[i]=e[i]);return n},Zu=(e,t,n)=>new Promise(((i,r)=>{var o=e=>{try{s(n.next(e))}catch(t){r(t)}},a=e=>{try{s(n.throw(e))}catch(t){r(t)}},s=e=>e.done?i(e.value):Promise.resolve(e.value).then(o,a);s((n=n.apply(e,t)).next())}));var ed=()=>zu||(zu=function(){let e=!1,t=[];const n=new Map;if("undefined"===typeof window)return;const i=new ResizeObserver(((i,r)=>{t=t.concat(i),e||window.requestAnimationFrame((()=>{const i=new Set;for(let e=0;e<t.length;e++){if(i.has(t[e].target))continue;i.add(t[e].target);const o=n.get(t[e].target);null==o||o.forEach((n=>n(t[e],r)))}t=[],e=!1})),e=!0}));return{observer:i,subscribe(e,t){var r;i.observe(e);const o=null!=(r=n.get(e))?r:[];o.push(t),n.set(e,o)},unsubscribe(e,t){var r;const o=null!=(r=n.get(e))?r:[];if(1===o.length)return i.unobserve(e),void n.delete(e);const a=o.indexOf(t);-1!==a&&o.splice(a,1),n.set(e,o)}}}()),td=t=>{const[n,i]=e.useState({width:0,height:0});e.useLayoutEffect((()=>{if(t.current){const{width:e,height:n}=t.current.getBoundingClientRect();i({width:e,height:n})}}),[t.current]);const r=e.useCallback((e=>i(e.contentRect)),[]);return function(t,n){const i=ed(),r=o(n);e.useLayoutEffect((()=>{let e=!1;const n=t.current;if(n)return null==i||i.subscribe(n,o),()=>{e=!0,null==i||i.unsubscribe(n,o)};function o(t,n){e||r.current(t,n)}}),[t.current,i,r]),null==i||i.observer}(t,r),n};function nd(t,n){const[i,r]=e.useState(n);return e.useEffect((()=>{if("undefined"===typeof window||!t)return;const e=t.subscribe(r);return()=>e.unsubscribe()}),[t]),i}function id(e,t){if("show_chat"===t.msg)return Yu($u({},e),{showChat:!0,unreadMessages:0});if("hide_chat"===t.msg)return Yu($u({},e),{showChat:!1});if("toggle_chat"===t.msg){const t=Yu($u({},e),{showChat:!e.showChat});return!0===t.showChat&&(t.unreadMessages=0),t}return"unread_msg"===t.msg?Yu($u({},e),{unreadMessages:t.count}):$u({},e)}function rd(e,t){return"set_pin"===t.msg?[t.trackReference]:"clear_pin"===t.msg?[]:$u({},e)}var od=e.createContext(void 0);function ad(){const t=e.useContext(od);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function sd(){return e.useContext(od)}var cd=e.createContext(void 0);function ld(){return e.useContext(cd)}var ud=e.createContext(void 0);function dd(){return e.useContext(ud)}function hd(e){var t;const n=dd(),i=ld(),r=null!=(t=null!=e?e:n)?t:null==i?void 0:i.participant;if(!r)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return r}var pd=e.createContext(void 0);function fd(){const t=e.useContext(pd);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function md(){return e.useContext(pd)}function gd(e){const t=md(),n=null!=e?e:t;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var vd=e.createContext(void 0);function yd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(const e of t)"function"===typeof e&&e(...arguments)}}function bd(){const e=$u({},arguments.length<=0?void 0:arguments[0]);for(let t=1;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];for(const t in n){const i=e[t],r=n[t];"function"===typeof i&&"function"===typeof r&&"o"===t[0]&&"n"===t[1]&&t.charCodeAt(2)>=65&&t.charCodeAt(2)<=90?e[t]=yd(i,r):e[t]="className"!==t&&"UNSAFE_className"!==t||"string"!==typeof i||"string"!==typeof r?void 0!==r?r:i:ju(i,r)}}return e}function kd(t){const n=gd(t),i=e.useMemo((()=>function(e){return nu(e,ui.ConnectionStateChanged).pipe(kc((e=>{let[t]=e;return t})),Gc(e.state))}(n)),[n]);return nd(i,n.state)}function Sd(t){const n=fd(),i=kd(n),r=e.useMemo((()=>{const{className:e,disconnect:r}=function(e){return{className:au("disconnect-button"),disconnect:t=>{e.disconnect(t)}}}(n);return bd(t,{className:e,onClick:()=>{var e;return r(null==(e=t.stopTracks)||e)},disabled:i===Ta.Disconnected})}),[n,t,i]);return{buttonProps:r}}function wd(t){let{trackRef:n,trackSource:i,participant:r,props:o}=t;const a=hd(r);if(!n&&!i)throw new Error("trackRef or trackSource must be defined.");const s=sd(),{className:c}=e.useMemo((()=>({className:[au("button"),au("focus-toggle-button")].join(" ")})),[]),l=e.useMemo((()=>{if(n)return Dl(n,null==s?void 0:s.pin.state);if(i){const e=a.getTrack(i);return!(!(null==s?void 0:s.pin.state)||!e)&&Dl({participant:a,source:i,publication:e},s.pin.state)}throw new Error("trackRef or trackSource and participant must be defined.")}),[n,null==s?void 0:s.pin.state,a,i]);return{mergedProps:e.useMemo((()=>bd(o,{className:c,onClick:e=>{var t,r,c,u,d;if(null==(t=o.onClick)||t.call(o,e),n)l?null==(c=null==s?void 0:(r=s.pin).dispatch)||c.call(r,{msg:"clear_pin"}):null==(d=null==s?void 0:(u=s.pin).dispatch)||d.call(u,{msg:"set_pin",trackReference:n});else if(i){const e=a.getTrack(i);(null==s?void 0:s.pin.dispatch)&&e&&(l?s.pin.dispatch({msg:"clear_pin"}):s.pin.dispatch({msg:"set_pin",trackReference:{participant:a,publication:e,source:e.source}}))}}})),[o,c,n,i,l,null==s?void 0:s.pin,a]),inFocus:l}}function Cd(t,n){const{width:i,height:r}=td(t),o=i>0&&r>0?jl(Fl,n,i,r):Fl[0];return e.useEffect((()=>{t.current&&o&&(t.current.style.setProperty("--lk-col-count",null==o?void 0:o.columns.toString()),t.current.style.setProperty("--lk-row-count",null==o?void 0:o.rows.toString()))}),[t,o]),{layout:o}}function Td(t){var n,i;const r=hd("string"===typeof t?(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).participant:t.participant),o="string"===typeof t?{participant:r,source:t}:t,[a,s]=e.useState(!(!(null==(n=o.publication)?void 0:n.isMuted)&&!(null==(i=r.getTrack(o.source))?void 0:i.isMuted)));return e.useEffect((()=>{const e=du(o).subscribe(s);return()=>e.unsubscribe()}),[_l(o)]),a}function Ed(t){const n=hd(t),i=e.useMemo((()=>function(e){return uu(e,di.IsSpeakingChanged).pipe(kc((e=>{let[t]=e;return t})))}(n)),[n]);return nd(i,n.isSpeaking)}var Pd={connect:!0,audio:!1,video:!1};function xd(){const t=fd();return nd(e.useMemo((()=>{return uu(e=t.localParticipant,di.ParticipantPermissionsChanged).pipe(kc((()=>e.permissions)),Gc(e.permissions));var e}),[t]),t.localParticipant.permissions)}function Rd(e){return void 0!==e}function Nd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return bd(...t.filter(Rd))}function Od(t,n,i){return e.Children.map(t,(r=>e.isValidElement(r)&&e.Children.only(t)?e.cloneElement(r,Yu($u({},n),{key:i})):r))}function _d(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i;const[r,o]=e.useState(su(t)),[a,s]=e.useState(null==r?void 0:r.isMuted),[c,l]=e.useState(null==r?void 0:r.isSubscribed),[u,d]=e.useState(null==r?void 0:r.track),[h,p]=e.useState("landscape"),f=e.useRef(),{className:m,trackObserver:g}=e.useMemo((()=>function(e){const t=su(e),n=lu(e.participant).pipe(kc((()=>su(e))),Gc(t));return{className:au(e.source===vr.Source.Camera||e.source===vr.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}(t)),[null!=(i=t.participant.sid)?i:t.participant.identity,t.source,Nl(t)&&t.publication.trackSid]);return e.useEffect((()=>{const e=g.subscribe((e=>{Ul.debug("update track",e),o(e),s(null==e?void 0:e.isMuted),l(null==e?void 0:e.isSubscribed),d(null==e?void 0:e.track)}));return()=>null==e?void 0:e.unsubscribe()}),[g]),e.useEffect((()=>{var e,i;return u&&(f.current&&u.detach(f.current),!(null==(e=n.element)?void 0:e.current)||Ml(t.participant)&&"audio"===(null==u?void 0:u.kind)||u.attach(n.element.current)),f.current=null==(i=n.element)?void 0:i.current,()=>{f.current&&(null==u||u.detach(f.current))}}),[u,n.element]),e.useEffect((()=>{var e,t;if("number"===typeof(null==(e=null==r?void 0:r.dimensions)?void 0:e.width)&&"number"===typeof(null==(t=null==r?void 0:r.dimensions)?void 0:t.height)){const e=r.dimensions.width>r.dimensions.height?"landscape":"portrait";p(e)}}),[r]),{publication:r,isMuted:a,isSubscribed:c,track:u,elementProps:Nd(n.props,$u({className:m,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":null==r?void 0:r.source},"video"===(null==r?void 0:r.kind)&&{"data-lk-orientation":h}))}}function Id(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.useRef([]),o=e.useRef(-1),a=n!==o.current,s="function"===typeof i.customSortFunction?i.customSortFunction(t):Gl(t);let c=[...s];if(!1===a)try{c=eu(r.current,s,n)}catch(l){Ul.error("Error while running updatePages(): ",l)}return r.current=a?s:c,o.current=n,c}function Dd(t){let{trackRef:n,participant:i,source:r,publication:o,onParticipantClick:a,disableSpeakingIndicator:s,htmlProps:c}=t;const l=ld(),u=hd(i),d=e.useMemo((()=>{var e,t,i,a,s,c;const d=null!=(t=null!=(e=null==n?void 0:n.source)?e:null==l?void 0:l.source)?t:r;if(void 0===d)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:null!=(a=null!=(i=null==n?void 0:n.participant)?i:null==l?void 0:l.participant)?a:u,publication:null!=(c=null!=(s=null==n?void 0:n.publication)?s:null==l?void 0:l.publication)?c:o,source:d}}),[null==n?void 0:n.participant,null==n?void 0:n.source,null==n?void 0:n.publication,null==l?void 0:l.participant,null==l?void 0:l.source,null==l?void 0:l.publication,u,r,o]),h=e.useMemo((()=>{const{className:e}={className:au("participant-tile")};return bd(c,{className:e,onClick:e=>{var t,n;if(null==(t=c.onClick)||t.call(c,e),"function"===typeof a){const e=null!=(n=d.publication)?n:d.participant.getTrack(d.source);a({participant:d.participant,track:e})}}})}),[c,a,d.publication,d.source,d.participant]),p=Td(vr.Source.Camera,{participant:d.participant}),f=Td(vr.Source.Microphone,{participant:d.participant}),m=Ed(d.participant),g=function(e){if(e.publication instanceof wa){const t=e.publication.track;if(t){const{facingMode:e}=Ia(t);return e}}return"undefined"}(d);return{elementProps:$u({"data-lk-audio-muted":f,"data-lk-video-muted":p,"data-lk-speaking":!0!==s&&m,"data-lk-local-participant":d.participant.isLocal,"data-lk-source":d.source,"data-lk-facing-mode":g},h)}}function Md(t){return t=function(e){const t=sd();if(null!=e||(e=t),!e)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return e}(t),e.useMemo((()=>void 0!==(null==t?void 0:t.pin.state)&&t.pin.state.length>=1?t.pin.state:[]),[t.pin.state])}function Ld(t){let{room:n,props:i}=t;const r=gd(n),{className:o,roomAudioPlaybackAllowedObservable:a,handleStartAudioPlayback:s}=e.useMemo((()=>function(){return{className:au("start-audio-button"),roomAudioPlaybackAllowedObservable:ru,handleStartAudioPlayback:e=>Rl(this,null,(function*(){Ul.info("Start Audio for room: ",e),yield e.startAudio()}))}}()),[]),c=e.useMemo((()=>a(r)),[r,a]),{canPlayAudio:l}=nd(c,{canPlayAudio:r.canPlaybackAudio});return{mergedProps:e.useMemo((()=>bd(i,{className:o,onClick:()=>{s(r)},style:{display:l?"none":"block"}})),[i,o,l,s,r]),canPlayAudio:l}}function Ad(t){let{props:n}=t;const{dispatch:i,state:r}=ad().widget,{className:o}=e.useMemo((()=>({className:[au("button"),au("chat-toggle")].join(" ")})),[]);return{mergedProps:e.useMemo((()=>bd(n,{className:o,onClick:()=>{i&&i({msg:"toggle_chat"})},"aria-pressed":(null==r?void 0:r.showChat)?"true":"false","data-lk-unread-msgs":r?r.unreadMessages<10?r.unreadMessages.toFixed(0):"9+":"0"})),[n,o,i,r])}}function Ud(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i,r,o,a;let s=ld();const c=null!=(r=null!=(i=dd())?i:n.participant)?r:null==s?void 0:s.participant;if("string"===typeof t){if(!c)throw Error("Participant missing, either provide it via context or pass it in directly");s={participant:c,source:t}}else{if(!t)throw Error("No track reference found, either provide it via context or pass it in directly");s=t}const{className:l,mediaMutedObserver:u}=e.useMemo((()=>function(e){let t="track-muted-indicator-camera";switch(e.source){case vr.Source.Camera:t="track-muted-indicator-camera";break;case vr.Source.Microphone:t="track-muted-indicator-microphone"}return{className:au(t),mediaMutedObserver:du(e)}}(s)),[_l(s)]);return{isMuted:nd(u,!(!(null==(o=s.publication)?void 0:o.isMuted)&&!(null==(a=s.participant.getTrack(s.source))?void 0:a.isMuted))),className:l}}function Fd(t){var n,i=t,{source:r,onChange:o,initialState:a,captureOptions:s}=i,c=Xu(i,["source","onChange","initialState","captureOptions"]);const l=md(),u=null==(n=null==l?void 0:l.localParticipant)?void 0:n.getTrack(r),d=e.useRef(!1),{toggle:h,className:p,pendingObserver:f,enabledObserver:m}=e.useMemo((()=>l?function(e,t,n){const{localParticipant:i}=t,r=(e,t)=>{let n=!1;switch(e){case vr.Source.Camera:n=t.isCameraEnabled;break;case vr.Source.Microphone:n=t.isMicrophoneEnabled;break;case vr.Source.ScreenShare:n=t.isScreenShareEnabled}return n},o=lu(i).pipe(kc((t=>r(e,t.participant))),Gc(r(e,i))),a=new $c;return{className:au("button"),toggle:(t,r)=>Rl(this,null,(function*(){try{switch(null!=r||(r=n),a.next(!0),e){case vr.Source.Camera:yield i.setCameraEnabled(null!=t?t:!i.isCameraEnabled,r);break;case vr.Source.Microphone:yield i.setMicrophoneEnabled(null!=t?t:!i.isMicrophoneEnabled,r);break;case vr.Source.ScreenShare:yield i.setScreenShareEnabled(null!=t?t:!i.isScreenShareEnabled,r)}}finally{a.next(!1)}})),enabledObserver:o,pendingObserver:a.asObservable()}}(r,l,s):function(){let e=!1;const t=new $c,n=new $c;return{className:au("button"),toggle:i=>Rl(this,null,(function*(){n.next(!0),e=null!=i?i:!e,t.next(e),n.next(!1)})),enabledObserver:t.asObservable(),pendingObserver:n.asObservable()}}()),[l,r,JSON.stringify(s)]),g=nd(f,!1),v=nd(m,null!=a?a:!!(null==u?void 0:u.isEnabled));e.useEffect((()=>{null==o||o(v,d.current),d.current=!1}),[v,o]),e.useEffect((()=>{void 0!==a&&(Ul.debug("forcing initial toggle state",r,a),h(a))}),[]);const y=e.useMemo((()=>bd(c,{className:p})),[c,p]),b=e.useCallback((e=>{var t;d.current=!0,h().finally((()=>d.current=!1)),null==(t=c.onClick)||t.call(c,e)}),[c,h]);return{toggle:h,enabled:v,pending:g,track:u,buttonProps:Yu($u({},y),{"aria-pressed":v,"data-lk-source":r,"data-lk-enabled":v,disabled:g,onClick:b})}}function jd(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[vr.Source.Camera,vr.Source.Microphone,vr.Source.ScreenShare,vr.Source.ScreenShareAudio,vr.Source.Unknown],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=gd(n.room),[r,o]=e.useState([]),[a,s]=e.useState([]),c=e.useMemo((()=>t.map((e=>zl(e)?e.source:e))),[JSON.stringify(t)]);e.useEffect((()=>{const e=function(e,t,n){var i,r;const o=null!=(i=n.additionalRoomEvents)?i:Al,a=null==(r=n.onlySubscribed)||r;return tu(e,...Array.from(new Set([ui.ParticipantConnected,ui.ParticipantDisconnected,ui.ConnectionStateChanged,ui.LocalTrackPublished,ui.LocalTrackUnpublished,ui.TrackPublished,ui.TrackUnpublished,ui.TrackSubscriptionStatusChanged,...o]).values())).pipe(kc((e=>{const n=Eu(e,t,a);return Ul.debug(`TrackReference[] was updated. (length ${n.trackReferences.length})`,n),n})),Gc(Eu(e,t,a)))}(i,c,{additionalRoomEvents:n.updateOnlyOn,onlySubscribed:n.onlySubscribed}).subscribe((e=>{let{trackReferences:t,participants:n}=e;Ul.debug("setting track bundles",t,n),o(t),s(n)}));return()=>e.unsubscribe()}),[i,JSON.stringify(n.updateOnlyOn),JSON.stringify(t)]);const l=e.useMemo((()=>{if(Jl(t)){const e=function(e,t){const n=new Map;if(Jl(e)){const i=e.filter((e=>e.withPlaceholder)).map((e=>e.source));t.forEach((e=>{const t=e.getTracks().map((e=>{var t;return null==(t=e.track)?void 0:t.source})).filter((e=>void 0!==e)),r=Array.from(function(e,t){const n=new Set(e);for(const i of t)n.delete(i);return n}(new Set(i),new Set(t)));r.length>0&&n.set(e.identity,r)}))}return n}(t,a),n=Array.from(r);return a.forEach((t=>{var i;if(e.has(t.identity)){(null!=(i=e.get(t.identity))?i:[]).forEach((e=>{if(r.find((n=>{let{participant:i,publication:r}=n;return t.identity===i.identity&&r.source===e})))return;Ul.debug(`Add ${e} placeholder for participant ${t.identity}.`);const i={participant:t,source:e};n.push(i)}))}})),n}return r}),[r,a,t]);return l}function Bd(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var n;const[i,r]=e.useState(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var n,i,r,o,a,s,c;const l={videoEnabled:null!=(n=null==e?void 0:e.videoEnabled)?n:Ru,audioEnabled:null!=(i=null==e?void 0:e.audioEnabled)?i:Nu,videoDeviceId:null!=(r=null==e?void 0:e.videoDeviceId)?r:Ou,audioDeviceId:null!=(o=null==e?void 0:e.audioDeviceId)?o:_u,username:null!=(a=null==e?void 0:e.username)?a:Iu,e2ee:null!=(s=null==e?void 0:e.e2ee)?s:Du,sharedPassphrase:null!=(c=null==e?void 0:e.sharedPassphrase)?c:Mu};if(t)return l;{const e=Lu();return xl(xl({},l),null!=e?e:{})}}(t.defaults,null!=(n=t.preventLoad)&&n)),o=e.useCallback((e=>{r((t=>Yu($u({},t),{audioEnabled:e})))}),[]),a=e.useCallback((e=>{r((t=>Yu($u({},t),{videoEnabled:e})))}),[]),s=e.useCallback((e=>{r((t=>Yu($u({},t),{audioDeviceId:e})))}),[]),c=e.useCallback((e=>{r((t=>Yu($u({},t),{videoDeviceId:e})))}),[]),l=e.useCallback((e=>{r((t=>Yu($u({},t),{username:e})))}),[]);return e.useEffect((()=>{var e;Uu(i,null!=(e=t.preventSave)&&e)}),[i,t.preventSave]),{userChoices:i,saveAudioInputEnabled:o,saveVideoInputEnabled:a,saveAudioInputDeviceId:s,saveVideoInputDeviceId:c,saveUsername:l}}function Vd(t){const n=hd(t),i=gd(),r=e.useMemo((()=>function(e,t){return nu(e,ui.ParticipantEncryptionStatusChanged).pipe(Xc((n=>{let[,i]=n;return t.identity===(null==i?void 0:i.identity)||!i&&t.identity===e.localParticipant.identity})),kc((e=>{let[t]=e;return t})),Gc(t instanceof Ra?t.isE2EEEnabled:t.isEncrypted))}(i,n)),[i,n]);return nd(r,n instanceof Ra?n.isE2EEEnabled:n.isEncrypted)}function zd(t){const{mergedProps:n}=Ad({props:t});return e.createElement("button",$u({},n),t.children)}function Jd(t){const{buttonProps:n}=Sd(t);return e.createElement("button",$u({},n),t.children)}var qd=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),e.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),e.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),Wd=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),e.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),Hd=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 24 24"},t),e.createElement("path",{fill:"#FFF",d:"M4.99 3.99a1 1 0 0 0-.697 1.717L10.586 12l-6.293 6.293a1 1 0 1 0 1.414 1.414L12 13.414l6.293 6.293a1 1 0 1 0 1.414-1.414L13.414 12l6.293-6.293a1 1 0 0 0-.727-1.717 1 1 0 0 0-.687.303L12 10.586 5.707 4.293a1 1 0 0 0-.717-.303z"})),Kd=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},t),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),Gd=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),e.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M5.293 2.293a1 1 0 0 1 1.414 0l4.823 4.823a1.25 1.25 0 0 1 0 1.768l-4.823 4.823a1 1 0 0 1-1.414-1.414L9.586 8 5.293 3.707a1 1 0 0 1 0-1.414z",clipRule:"evenodd"})),Qd=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),e.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},e.createElement("path",{d:"M10 1.75h4.25m0 0V6m0-4.25L9 7M6 14.25H1.75m0 0V10m0 4.25L7 9"}))),$d=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),Yd=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),e.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M4 6.104V4a4 4 0 1 1 8 0v2.104c1.154.326 2 1.387 2 2.646v4.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-4.5c0-1.259.846-2.32 2-2.646ZM5.5 4a2.5 2.5 0 0 1 5 0v2h-5V4Z",clipRule:"evenodd"})),Xd=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),e.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),e.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),Zd=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),e.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),e.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),eh=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),th=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("g",{opacity:.25},e.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),nh=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("g",{opacity:.25},e.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),ih=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),e.createElement("g",{opacity:.25},e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),rh=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),oh=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),e.createElement("g",{fill:"currentColor"},e.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),e.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),ah=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 0a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 8 0Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 12a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5A.75.75 0 0 1 8 12Z",clipRule:"evenodd",opacity:.7}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 1.072a.75.75 0 0 1 .274 1.024l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 12 1.072Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 11.464a.75.75 0 0 1 .274 1.025l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 6 11.464Z",clipRule:"evenodd",opacity:.6}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.928 4a.75.75 0 0 1-.274 1.025l-2.165 1.25a.75.75 0 1 1-.75-1.3l2.165-1.25A.75.75 0 0 1 14.928 4Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.536 10a.75.75 0 0 1-.275 1.024l-2.165 1.25a.75.75 0 0 1-.75-1.298l2.165-1.25A.75.75 0 0 1 4.536 10Z",clipRule:"evenodd",opacity:.5}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M16 8a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 16 8Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4 8a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 4 8Z",clipRule:"evenodd",opacity:.4}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.928 12a.75.75 0 0 1-1.024.274l-2.165-1.25a.75.75 0 0 1 .75-1.299l2.165 1.25A.75.75 0 0 1 14.928 12Z",clipRule:"evenodd",opacity:.9}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.536 6a.75.75 0 0 1-1.025.275l-2.165-1.25a.75.75 0 1 1 .75-1.3l2.165 1.25A.75.75 0 0 1 4.536 6Z",clipRule:"evenodd",opacity:.3}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 14.928a.75.75 0 0 1-1.024-.274l-1.25-2.165a.75.75 0 0 1 1.298-.75l1.25 2.165A.75.75 0 0 1 12 14.928Z",clipRule:"evenodd",opacity:.8}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 4.536a.75.75 0 0 1-1.024-.275l-1.25-2.165a.75.75 0 1 1 1.299-.75l1.25 2.165A.75.75 0 0 1 6 4.536Z",clipRule:"evenodd",opacity:.2})),sh=t=>e.createElement("svg",$u({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),e.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},e.createElement("path",{d:"M13.25 7H9m0 0V2.75M9 7l5.25-5.25M2.75 9H7m0 0v4.25M7 9l-5.25 5.25"})));function ch(t){var n=t,{trackRef:i,trackSource:r,participant:o}=n,a=Xu(n,["trackRef","trackSource","participant"]);const s=ld(),{mergedProps:c,inFocus:l}=wd({trackRef:null!=i?i:s,trackSource:r,participant:o,props:a});return e.createElement(od.Consumer,null,(t=>void 0!==t&&e.createElement("button",$u({},c),a.children?a.children:l?e.createElement(sh,null):e.createElement(Qd,null))))}function lh(t){var n=t,{kind:i,initialSelection:r,onActiveDeviceChange:o,onDeviceListChange:a,onDeviceSelectError:s,exactMatch:c,track:l,requestPermissions:u,onError:d}=n,h=Xu(n,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const p=md(),f=e.useCallback((e=>{p&&p.emit(ui.MediaDevicesError,e),null==d||d(e)}),[p,d]),{devices:m,activeDeviceId:g,setActiveMediaDevice:v,className:y}=function(t){let{kind:n,room:i,track:r,requestPermissions:o,onError:a}=t;const s=md(),c=nd(e.useMemo((()=>iu(n,a,o)),[n,o,a]),[]),[l,u]=e.useState(""),{className:d,activeDeviceObservable:h,setActiveMediaDevice:p}=e.useMemo((()=>hu(n,null!=i?i:s,r)),[n,i,s,r]);return e.useEffect((()=>{const e=h.subscribe((e=>{Ul.info("setCurrentDeviceId",e),e&&u(e)}));return()=>{null==e||e.unsubscribe()}}),[h]),{devices:c,className:d,activeDeviceId:l,setActiveMediaDevice:p}}({kind:i,room:p,track:l,requestPermissions:u,onError:f});e.useEffect((()=>{void 0!==r&&v(r)}),[v]),e.useEffect((()=>{"function"===typeof a&&a(m)}),[a,m]),e.useEffect((()=>{g&&""!==g&&(null==o||o(g))}),[g]);const b=e=>Zu(this,null,(function*(){try{yield v(e,{exact:c})}catch(t){if(!(t instanceof Error))throw t;null==s||s(t)}})),k=e.useMemo((()=>Nd(h,{className:y},{className:"lk-list"})),[y,h]);function S(e,t,n){return e===t||0===n&&"default"===t}return e.createElement("ul",$u({},k),m.map(((t,n)=>e.createElement("li",{key:t.deviceId,id:t.deviceId,"data-lk-active":S(t.deviceId,g,n),"aria-selected":S(t.deviceId,g,n),role:"option"},e.createElement("button",{className:"lk-button",onClick:()=>b(t.deviceId)},t.label)))))}function uh(t,n){switch(t){case vr.Source.Microphone:return n?e.createElement(Zd,null):e.createElement(Xd,null);case vr.Source.Camera:return n?e.createElement(Wd,null):e.createElement(qd,null);case vr.Source.ScreenShare:return n?e.createElement(oh,null):e.createElement(rh,null);default:return}}function dh(t){var n=t,{showIcon:i}=n,r=Xu(n,["showIcon"]);const{buttonProps:o,enabled:a}=Fd(r);return e.createElement("button",$u({},o),(null==i||i)&&uh(r.source,a),r.children)}function hh(t){var n;const{className:i,quality:r}=function(){const t=hd((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).participant),{className:n,connectionQualityObserver:i}=e.useMemo((()=>pu(t)),[t]);return{className:n,quality:nd(i,Ca.Unknown)}}(t),o=e.useMemo((()=>Yu($u({},Nd(t,{className:i})),{"data-lk-quality":r})),[r,t,i]);return e.createElement("div",$u({},o),null!=(n=t.children)?n:function(t){switch(t){case Ca.Excellent:return e.createElement(eh,null);case Ca.Good:return e.createElement(th,null);case Ca.Poor:return e.createElement(nh,null);default:return e.createElement(ih,null)}}(r))}function ph(t){var n=t,{participant:i}=n,r=Xu(n,["participant"]);const o=hd(i),{className:a,infoObserver:s}=e.useMemo((()=>fu(o)),[o]),{identity:c,name:l}=nd(s,{name:o.name,identity:o.identity,metadata:o.metadata}),u=e.useMemo((()=>Nd(r,{className:a,"data-lk-participant-name":l})),[r,a,l]);return e.createElement("span",$u({},u),""!==l?l:c,r.children)}function fh(t){var n,i,r=t,{source:o,participant:a,trackRef:s,show:c="always"}=r,l=Xu(r,["source","participant","trackRef","show"]);const{className:u,isMuted:d}=Ud(null!=s?s:o,{participant:a}),h="always"===c||"muted"===c&&d||"unmuted"===c&&!d,p=e.useMemo((()=>Nd(l,{className:u})),[u,l]);return h?e.createElement("div",Yu($u({},p),{"data-lk-muted":d}),null!=(i=l.children)?i:uh(null!=(n=null==s?void 0:s.source)?n:o,!d)):null}var mh=t=>e.createElement("svg",$u({width:320,height:320,viewBox:"0 0 320 320",preserveAspectRatio:"xMidYMid meet",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),e.createElement("path",{d:"M160 180C204.182 180 240 144.183 240 100C240 55.8172 204.182 20 160 20C115.817 20 79.9997 55.8172 79.9997 100C79.9997 144.183 115.817 180 160 180Z",fill:"white",fillOpacity:.25}),e.createElement("path",{d:"M97.6542 194.614C103.267 191.818 109.841 192.481 115.519 195.141C129.025 201.466 144.1 205 159.999 205C175.899 205 190.973 201.466 204.48 195.141C210.158 192.481 216.732 191.818 222.345 194.614C262.703 214.719 291.985 253.736 298.591 300.062C300.15 310.997 291.045 320 280 320H39.9997C28.954 320 19.8495 310.997 21.4087 300.062C28.014 253.736 57.2966 214.72 97.6542 194.614Z",fill:"white",fillOpacity:.25}));function gh(t){var n,i,r,o,a,s,c,l,u,d,h=t,{onTrackClick:p,onClick:f,onSubscriptionStatusChanged:m,trackRef:g,name:v,publication:y,source:b,participant:k,manageSubscription:S}=h,w=Xu(h,["onTrackClick","onClick","onSubscriptionStatusChanged","trackRef","name","publication","source","participant","manageSubscription"]);const C=ld(),T=null!=(o=null!=(r=null==(n=null==g?void 0:g.publication)?void 0:n.trackName)?r:null==(i=null==C?void 0:C.publication)?void 0:i.trackName)?o:v,E=null!=(s=null!=(a=null==g?void 0:g.source)?a:null==C?void 0:C.source)?s:b,P=null!=(l=null!=(c=null==g?void 0:g.publication)?c:null==C?void 0:C.publication)?l:y,x=null!=(d=null!=(u=null==g?void 0:g.participant)?u:null==C?void 0:C.participant)?d:k;if(void 0===E)throw new Error("VideoTrack: You must provide a trackRef or source property.");const R=hd(x),N=e.useRef(null),O=Vu(N,{}),_=Bu(O,3e3);e.useEffect((()=>{S&&P instanceof Pa&&!1===(null==_?void 0:_.isIntersecting)&&!1===(null==O?void 0:O.isIntersecting)&&P.setSubscribed(!1)}),[_,P,S]),e.useEffect((()=>{S&&P instanceof Pa&&!0===(null==O?void 0:O.isIntersecting)&&P.setSubscribed(!0)}),[O,P,S]);const{elementProps:I,publication:D,isSubscribed:M}=_d({participant:R,name:T,source:E,publication:P},{element:N,props:w});e.useEffect((()=>{null==m||m(!!M)}),[M,m]);return e.createElement("video",Yu($u({ref:N},I),{muted:!0,onClick:e=>{null==f||f(e),null==p||p({participant:R,track:D})}}))}function vh(t){var n,i,r,o,a,s,c,l,u,d,h=t,{trackRef:p,onSubscriptionStatusChanged:f,volume:m,source:g,name:v,publication:y,participant:b}=h,k=Xu(h,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]);const S=ld(),w=null!=(o=null!=(r=null==(n=null==p?void 0:p.publication)?void 0:n.trackName)?r:null==(i=null==S?void 0:S.publication)?void 0:i.trackName)?o:v,C=null!=(s=null!=(a=null==p?void 0:p.source)?a:null==S?void 0:S.source)?s:g,T=null!=(l=null!=(c=null==p?void 0:p.publication)?c:null==S?void 0:S.publication)?l:y,E=null!=(d=null!=(u=null==p?void 0:p.participant)?u:null==S?void 0:S.participant)?d:b;if(void 0===C)throw new Error("The AudioTrack component expects a trackRef or source property.");const P=e.useRef(null),x=hd(E),{elementProps:R,isSubscribed:N,track:O,publication:_}=_d({source:C,name:w,participant:x,publication:T},{element:P,props:k});return e.useEffect((()=>{null==f||f(!!N)}),[N,f]),e.useEffect((()=>{void 0!==O&&void 0!==m&&(O instanceof va?O.setVolume(m):Ul.warn("Volume can only be set on remote audio tracks."))}),[m,O]),e.useEffect((()=>{void 0!==_&&void 0!==k.muted&&(_ instanceof Pa?_.setEnabled(!k.muted):Ul.warn("Can only call setEnabled on remote track publications."))}),[k.muted,_,O]),e.createElement("audio",$u({ref:P},R))}function yh(t){const n=!!dd();return t.participant&&!n?e.createElement(ud.Provider,{value:t.participant},t.children):e.createElement(e.Fragment,null,t.children)}function bh(t){const n=!!ld();return t.trackRef&&!n?e.createElement(cd.Provider,{value:t.trackRef},t.children):e.createElement(e.Fragment,null,t.children)}function kh(t){var n,i,r=t,{trackRef:o,participant:a,children:s,source:c=vr.Source.Camera,onParticipantClick:l,publication:u,disableSpeakingIndicator:d}=r,h=Xu(r,["trackRef","participant","children","source","onParticipantClick","publication","disableSpeakingIndicator"]);const p=ld(),f=hd(a),m=e.useMemo((()=>{var e,t,n,i,r,a;return{participant:null!=(t=null!=(e=null==o?void 0:o.participant)?e:null==p?void 0:p.participant)?t:f,source:null!=(i=null!=(n=null==o?void 0:o.source)?n:null==p?void 0:p.source)?i:c,publication:null!=(a=null!=(r=null==o?void 0:o.publication)?r:null==p?void 0:p.publication)?a:u}}),[p,f,u,c,o]),{elementProps:g}=Dd({participant:m.participant,htmlProps:h,source:m.source,publication:m.publication,disableSpeakingIndicator:d,onParticipantClick:l}),v=Vd(f),y=sd(),b=null==(n=function(t){const n=e.useContext(vd);if(!0===t){if(n)return n;throw Error("tried to access feature context, but none is present")}return n}())?void 0:n.autoSubscription,k=e.useCallback((e=>{m.source&&!e&&y&&y.pin.dispatch&&Dl(m,y.pin.state)&&y.pin.dispatch({msg:"clear_pin"})}),[m,y]);return e.createElement("div",$u({style:{position:"relative"}},g),e.createElement(bh,{trackRef:m},e.createElement(yh,{participant:m.participant},null!=s?s:e.createElement(e.Fragment,null,!Nl(m)||"video"!==(null==(i=m.publication)?void 0:i.kind)&&m.source!==vr.Source.Camera&&m.source!==vr.Source.ScreenShare?Nl(m)&&e.createElement(vh,{trackRef:m,onSubscriptionStatusChanged:k}):e.createElement(gh,{trackRef:m,onSubscriptionStatusChanged:k,manageSubscription:b}),e.createElement("div",{className:"lk-participant-placeholder"},e.createElement(mh,null)),e.createElement("div",{className:"lk-participant-metadata"},e.createElement("div",{className:"lk-participant-metadata-item"},m.source===vr.Source.Camera?e.createElement(e.Fragment,null,v&&e.createElement(Yd,{style:{marginRight:"0.25rem"}}),e.createElement(fh,{source:vr.Source.Microphone,show:"muted"}),e.createElement(ph,null)):e.createElement(e.Fragment,null,e.createElement(rh,{style:{marginRight:"0.25rem"}}),e.createElement(ph,null,"'s screen"))),e.createElement(hh,{className:"lk-participant-metadata-item"}))),e.createElement(ch,{trackRef:m}))))}function Sh(t){const n=Nd(t,{className:"lk-focus-layout"});return e.createElement("div",$u({},n),t.children)}function wh(t){var n=t,{trackRef:i,track:r}=n,o=Xu(n,["trackRef","track"]);const a=null!=i?i:r;return e.createElement(kh,$u($u({},a),o))}function Ch(t){var n=t,{tracks:i}=n,r=Xu(n,["tracks"]);return e.createElement(e.Fragment,null,i.map((t=>e.createElement(cd.Provider,{value:t,key:_l(t)},Od(r.children)))))}function Th(t){let{totalPageCount:n,nextPage:i,prevPage:r,currentPage:o,pagesContainer:a}=t;const[s,c]=e.useState(!1);return e.useEffect((()=>{let e;return a&&(e=Pu(a.current,2e3).subscribe(c)),()=>{e&&e.unsubscribe()}}),[a]),e.createElement("div",{className:"lk-pagination-control","data-lk-user-interaction":s},e.createElement("button",{className:"lk-button",onClick:r},e.createElement(Gd,null)),e.createElement("span",{className:"lk-pagination-count"},`${o} of ${n}`),e.createElement("button",{className:"lk-button",onClick:i},e.createElement(Gd,null)))}function Eh(t){let{totalPageCount:n,currentPage:i}=t;const r=new Array(n).fill("").map(((t,n)=>n+1===i?e.createElement("span",{"data-lk-active":!0,key:n}):e.createElement("span",{key:n})));return e.createElement("div",{className:"lk-pagination-indicator"},r)}function Ph(t){var n=t,{tracks:i}=n,r=Xu(n,["tracks"]);const o=e.createRef(),a=e.useMemo((()=>Nd(r,{className:"lk-grid-layout"})),[r]),{layout:s}=Cd(o,i.length),c=function(t,n){const[i,r]=e.useState(1),o=Math.max(Math.ceil(n.length/t),1);i>o&&r(o);const a=i*t,s=a-t,c=e=>{r((t=>"next"===e?t===o?t:t+1:1===t?t:t-1))},l=Id(n,t).slice(s,a);return{totalPageCount:o,nextPage:()=>c("next"),prevPage:()=>c("previous"),setPage:e=>{r(e>o?o:e<1?1:e)},firstItemIndex:s,lastItemIndex:a,tracks:l,currentPage:i}}(s.maxTiles,i);return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i;const r=e.useRef(null),o=e.useRef(null),a=null!=(i=n.minSwipeDistance)?i:50,s=e=>{o.current=null,r.current=e.targetTouches[0].clientX},c=e=>{o.current=e.targetTouches[0].clientX},l=e.useCallback((()=>{if(!r.current||!o.current)return;const e=r.current-o.current,t=e<-a;e>a&&n.onLeftSwipe&&n.onLeftSwipe(),t&&n.onRightSwipe&&n.onRightSwipe()}),[a,n]);e.useEffect((()=>{const e=t.current;return e&&(e.addEventListener("touchstart",s,{passive:!0}),e.addEventListener("touchmove",c,{passive:!0}),e.addEventListener("touchend",l,{passive:!0})),()=>{e&&(e.removeEventListener("touchstart",s),e.removeEventListener("touchmove",c),e.removeEventListener("touchend",l))}}),[t,l])}(o,{onLeftSwipe:c.nextPage,onRightSwipe:c.prevPage}),e.createElement("div",$u({ref:o,"data-lk-pagination":c.totalPageCount>1},a),e.createElement(Ch,{tracks:c.tracks},r.children),i.length>s.maxTiles&&e.createElement(e.Fragment,null,e.createElement(Eh,{totalPageCount:c.totalPageCount,currentPage:c.currentPage}),e.createElement(Th,$u({pagesContainer:o},c))))}var xh=-1*(1-1.6);function Rh(t){var n=t,{tracks:i,orientation:r}=n,o=Xu(n,["tracks","orientation"]);const a=e.useRef(null),[s,c]=e.useState(0),{width:l,height:u}=td(a),d=r||(u>=l?"vertical":"horizontal"),h="vertical"===d?Math.max(l*xh,130):Math.max(1.6*u,140),p=function(){const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);const n=e.offsetWidth;t.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=t.clientWidth),document.body.removeChild(t),n-i}(),f="vertical"===d?Math.max((u-p)/h,1):Math.max((l-p)/h,1);let m=Math.round(f);Math.abs(f-s)<.5?m=Math.round(s):s!==f&&c(f);const g=Id(i,m);return e.useLayoutEffect((()=>{a.current&&(a.current.dataset.lkOrientation=d,a.current.style.setProperty("--lk-max-visible-tiles",m.toString()))}),[m,d]),e.createElement("aside",$u({key:d,className:"lk-carousel",ref:a},o),e.createElement(Ch,{tracks:g},o.children))}function Nh(t){let{value:n,onPinChange:i,onWidgetChange:r,children:o}=t;const a=function(t){const[n,i]=e.useReducer(rd,Bl),[r,o]=e.useReducer(id,Vl);return null!=t?t:{pin:{dispatch:i,state:n},widget:{dispatch:o,state:r}}}(n);return e.useEffect((()=>{Ul.debug("PinState Updated",{state:a.pin.state}),i&&a.pin.state&&i(a.pin.state)}),[a.pin.state,i]),e.useEffect((()=>{Ul.debug("Widget Updated",{widgetState:a.widget.state}),r&&a.widget.state&&r(a.widget.state)}),[r,a.widget.state]),e.createElement(od.Provider,{value:a},o)}function Oh(t){const{room:n,htmlProps:i}=function(t){const n=$u($u({},Pd),t),{token:i,serverUrl:r,options:o,room:a,connectOptions:s,connect:c,audio:l,video:u,screen:d,onConnected:h,onDisconnected:p,onError:f,onMediaDeviceFailure:m,onEncryptionError:g,simulateParticipants:v}=n,y=Xu(n,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);o&&a&&Ul.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[b,k]=e.useState();e.useEffect((()=>{k(null!=a?a:new Na(o))}),[a]);const S=e.useMemo((()=>{const{className:e}={className:"lk-room-container"};return bd(y,{className:e})}),[y]);return e.useEffect((()=>{if(!b)return;const e=()=>{const e=b.localParticipant;Ul.debug("trying to publish local tracks"),Promise.all([e.setMicrophoneEnabled(!!l,"boolean"!==typeof l?l:void 0),e.setCameraEnabled(!!u,"boolean"!==typeof u?u:void 0),e.setScreenShareEnabled(!!d,"boolean"!==typeof d?d:void 0)]).catch((e=>{Ul.warn(e),null==f||f(e)}))},t=e=>{const t=li.getFailure(e);null==m||m(t)},n=e=>{null==g||g(e)};return b.on(ui.SignalConnected,e).on(ui.MediaDevicesError,t).on(ui.EncryptionError,n),()=>{b.off(ui.SignalConnected,e).off(ui.MediaDevicesError,t).off(ui.EncryptionError,n)}}),[b,l,u,d,f,g,m]),e.useEffect((()=>{if(b)if(v)b.simulateParticipants({participants:{count:v},publish:{audio:!0,useRealTracks:!0}});else{if(i)return r?void(c?(Ul.debug("connecting"),b.connect(r,i,s).catch((e=>{Ul.warn(e),null==f||f(e)}))):(Ul.debug("disconnecting because connect is false"),b.disconnect())):(Ul.warn("no livekit url provided"),void(null==f||f(Error("no livekit url provided"))));Ul.debug("no token yet")}}),[c,i,JSON.stringify(s),b,f,r,v]),e.useEffect((()=>{if(!b)return;const e=e=>{switch(e){case Ta.Disconnected:p&&p();break;case Ta.Connected:h&&h()}};return b.on(ui.ConnectionStateChanged,e),()=>{b.off(ui.ConnectionStateChanged,e)}}),[i,h,p,b]),e.useEffect((()=>{if(b)return()=>{Ul.info("disconnecting on onmount"),b.disconnect()}}),[b]),{room:b,htmlProps:S}}(t);return e.createElement("div",$u({},i),n&&e.createElement(pd.Provider,{value:n},e.createElement(vd.Provider,{value:t.featureFlags},t.children)))}function _h(t){let{volume:n,muted:i}=t;const r=jd([vr.Source.Microphone,vr.Source.ScreenShareAudio,vr.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!1}).filter((e=>!Ml(e.participant)&&e.publication.kind===vr.Kind.Audio));return e.useEffect((()=>{for(const e of r)e.publication.setSubscribed(!0)}),[r]),e.createElement("div",{style:{display:"none"}},r.map((t=>e.createElement(vh,{key:_l(t),trackRef:t,volume:n,muted:i}))))}function Ih(t){const n=e.useMemo((()=>Nd(t,{className:"lk-toast"})),[t]);return e.createElement("div",$u({},n),t.children)}function Dh(t){const[n,i]=e.useState(void 0),r=kd(t.room);return e.useEffect((()=>{switch(r){case Ta.Reconnecting:i(e.createElement(e.Fragment,null,e.createElement(ah,{className:"lk-spinner"})," Reconnecting"));break;case Ta.Connecting:i(e.createElement(e.Fragment,null,e.createElement(ah,{className:"lk-spinner"})," Connecting"));break;case Ta.Disconnected:i(e.createElement(e.Fragment,null,"Disconnected"));break;default:i(void 0)}}),[r]),n?e.createElement(Ih,{className:"lk-toast-connection-state"},n):e.createElement(e.Fragment,null)}function Mh(t){var n,i,r,o,a=t,{entry:s,hideName:c=!1,hideTimestamp:l=!1,messageFormatter:u}=a,d=Xu(a,["entry","hideName","hideTimestamp","messageFormatter"]);const h=e.useMemo((()=>u?u(s.message):s.message),[s.message,u]),p=!!s.editTimestamp,f=new Date(s.timestamp),m=navigator?navigator.language:"en-US";return e.createElement("li",$u({className:"lk-chat-entry",title:f.toLocaleTimeString(m,{timeStyle:"full"}),"data-lk-message-origin":(null==(n=s.from)?void 0:n.isLocal)?"local":"remote"},d),(!l||!c||p)&&e.createElement("span",{className:"lk-meta-data"},!c&&e.createElement("strong",{className:"lk-participant-name"},null!=(o=null==(i=s.from)?void 0:i.name)?o:null==(r=s.from)?void 0:r.identity),(!l||p)&&e.createElement("span",{className:"lk-timestamp"},p&&"edited ",f.toLocaleTimeString(m,{timeStyle:"short"}))),e.createElement("span",{className:"lk-message-body"},h))}function Lh(t){var n=t,{messageFormatter:i,messageDecoder:r,messageEncoder:o,channelTopic:a}=n,s=Xu(n,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const c=e.useRef(null),l=e.useRef(null),u=e.useMemo((()=>({messageDecoder:r,messageEncoder:o,channelTopic:a})),[r,o,a]),{send:d,chatMessages:h,isSending:p}=function(t){const n=fd(),[i,r]=e.useState(),o=nd(null==i?void 0:i.isSendingObservable,!1),a=nd(null==i?void 0:i.messageObservable,[]);return e.useEffect((()=>{const e=Cu(n,t);r(e)}),[n,t]),{send:null==i?void 0:i.send,update:null==i?void 0:i.update,chatMessages:a,isSending:o}}(u),f=sd(),m=e.useRef(0);return e.useEffect((()=>{var e;l&&(null==(e=l.current)||e.scrollTo({top:l.current.scrollHeight}))}),[l,h]),e.useEffect((()=>{var e,t,n,i,r;if(!f||0===h.length)return;if((null==(e=f.widget.state)?void 0:e.showChat)&&h.length>0&&m.current!==(null==(t=h[h.length-1])?void 0:t.timestamp))return void(m.current=null==(n=h[h.length-1])?void 0:n.timestamp);const o=h.filter((e=>!m.current||e.timestamp>m.current)).length,{widget:a}=f;o>0&&(null==(i=a.state)?void 0:i.unreadMessages)!==o&&(null==(r=a.dispatch)||r.call(a,{msg:"unread_msg",count:o}))}),[h,null==f?void 0:f.widget]),e.createElement("div",Yu($u({},s),{className:"lk-chat"}),e.createElement("div",{className:"lk-chat-header"},"Messages",e.createElement(zd,{className:"lk-close-button"},e.createElement(Hd,null))),e.createElement("ul",{className:"lk-list lk-chat-messages",ref:l},s.children?h.map(((e,t)=>{var n;return Od(s.children,{entry:e,key:null!=(n=e.id)?n:t,messageFormatter:i})})):h.map(((t,n,r)=>{var o;const a=n>=1&&r[n-1].from===t.from,s=n>=1&&t.timestamp-r[n-1].timestamp<6e4;return e.createElement(Mh,{key:null!=(o=t.id)?o:n,hideName:a,hideTimestamp:!1!==a&&s,entry:t,messageFormatter:i})}))),e.createElement("form",{className:"lk-chat-form",onSubmit:function(e){return Zu(this,null,(function*(){e.preventDefault(),c.current&&""!==c.current.value.trim()&&d&&(yield d(c.current.value),c.current.value="",c.current.focus())}))}},e.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:p,ref:c,type:"text",placeholder:"Enter a message..."}),e.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:p},"Send")))}function Ah(t){var n=t,{kind:i,initialSelection:r,onActiveDeviceChange:o,tracks:a,requestPermissions:s=!1}=n,c=Xu(n,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[l,u]=e.useState(!1),[d,h]=e.useState([]),[p,f]=e.useState(!0),m=(e,t)=>{Ul.debug("handle device change"),u(!1),null==o||o(e,t)},g=e.useRef(null),v=e.useRef(null);e.useLayoutEffect((()=>{g.current&&v.current&&(d||p)&&function(e,t){return Rl(this,null,(function*(){const{x:n,y:i}=yield Ls(e,t,{placement:"top",middleware:[es(6),Ms(),Ds({padding:5})]});return{x:n,y:i}}))}(g.current,v.current).then((e=>{let{x:t,y:n}=e;v.current&&Object.assign(v.current.style,{left:`${t}px`,top:`${n}px`})})),f(!1)}),[g,v,d,p]);const y=e.useCallback((e=>{v.current&&e.target!==g.current&&l&&function(e,t){return!e.contains(t.target)}(v.current,e)&&u(!1)}),[l,v,g]);return e.useEffect((()=>(document.addEventListener("click",y),window.addEventListener("resize",(()=>f(!0))),()=>{document.removeEventListener("click",y),window.removeEventListener("resize",(()=>f(!0)))})),[y,f]),e.createElement(e.Fragment,null,e.createElement("button",Yu($u({className:"lk-button lk-button-menu","aria-pressed":l},c),{onClick:()=>u(!l),ref:g}),c.children),!c.disabled&&e.createElement("div",{className:"lk-device-menu",ref:v,style:{visibility:l?"visible":"hidden"}},i?e.createElement(lh,{initialSelection:r,onActiveDeviceChange:e=>m(i,e),onDeviceListChange:h,kind:i,track:null==a?void 0:a[i],requestPermissions:s}):e.createElement(e.Fragment,null,e.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),e.createElement(lh,{kind:"audioinput",onActiveDeviceChange:e=>m("audioinput",e),onDeviceListChange:h,track:null==a?void 0:a.audioinput,requestPermissions:s}),e.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),e.createElement(lh,{kind:"videoinput",onActiveDeviceChange:e=>m("videoinput",e),onDeviceListChange:h,track:null==a?void 0:a.videoinput,requestPermissions:s}))))}function Uh(){e.useEffect((()=>{!function(e){var t,n;if(("dev"===(null==(t=null==process?void 0:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})?void 0:t.NODE_ENV)||"development"===(null==(n=null==process?void 0:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})?void 0:n.NODE_ENV))&&"undefined"!==typeof window){const t=null!=e?e:document.querySelector(".lk-room-container");t&&!getComputedStyle(t).getPropertyValue("--lk-has-imported-styles")&&Ul.warn("It looks like you're not using the `@livekit/components-styles package`. To render the UI with the default styling, please import it in your layout or page.")}}()}),[])}function Fh(t){var n=t,{label:i}=n,r=Xu(n,["label"]);const o=fd(),{mergedProps:a,canPlayAudio:s}=Ld({room:o,props:r}),{mergedProps:c,canPlayVideo:l}=function(t){let{room:n,props:i}=t;const r=gd(n),{className:o,roomVideoPlaybackAllowedObservable:a,handleStartVideoPlayback:s}=e.useMemo((()=>Tu()),[]),c=e.useMemo((()=>a(r)),[r,a]),{canPlayVideo:l}=nd(c,{canPlayVideo:r.canPlaybackVideo});return{mergedProps:e.useMemo((()=>bd(i,{className:o,onClick:()=>{s(r)},style:{display:l?"none":"block"}})),[i,o,l,s,r]),canPlayVideo:l}}({room:o,props:a}),u=c,{style:d}=u,h=Xu(u,["style"]);return d.display=s&&l?"none":"block",e.createElement("button",$u({style:d},h),null!=i?i:"Start "+(s?"Video":"Audio"))}function jh(t){var n,i=t,{variation:r,controls:o,saveUserChoices:a=!0}=i,s=Xu(i,["variation","controls","saveUserChoices"]);const[c,l]=e.useState(!1),u=sd();e.useEffect((()=>{var e,t;void 0!==(null==(e=null==u?void 0:u.widget.state)?void 0:e.showChat)&&l(null==(t=null==u?void 0:u.widget.state)?void 0:t.showChat)}),[null==(n=null==u?void 0:u.widget.state)?void 0:n.showChat]);const d=function(t){const n=e=>"undefined"!==typeof window&&window.matchMedia(e).matches,[i,r]=e.useState(n(t));function o(){r(n(t))}return e.useEffect((()=>{const e=window.matchMedia(t);return o(),e.addListener?e.addListener(o):e.addEventListener("change",o),()=>{e.removeListener?e.removeListener(o):e.removeEventListener("change",o)}}),[t]),i}(`(max-width: ${c?1e3:760}px)`);null!=r||(r=d?"minimal":"verbose");const h=$u({leave:!0},o),p=xd();p?(null!=h.camera||(h.camera=p.canPublish),null!=h.microphone||(h.microphone=p.canPublish),null!=h.screenShare||(h.screenShare=p.canPublish),null!=h.chat||(h.chat=p.canPublishData&&(null==o?void 0:o.chat))):(h.camera=!1,h.chat=!1,h.microphone=!1,h.screenShare=!1);const f=e.useMemo((()=>"minimal"===r||"verbose"===r),[r]),m=e.useMemo((()=>"textOnly"===r||"verbose"===r),[r]),g="undefined"!==typeof navigator&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia,[v,y]=e.useState(!1),b=e.useCallback((e=>{y(e)}),[y]),k=Nd({className:"lk-control-bar"},s),{saveAudioInputEnabled:S,saveVideoInputEnabled:w,saveAudioInputDeviceId:C,saveVideoInputDeviceId:T}=Bd({preventSave:!a}),E=e.useCallback(((e,t)=>t?S(e):null),[S]),P=e.useCallback(((e,t)=>t?w(e):null),[w]);return e.createElement("div",$u({},k),h.microphone&&e.createElement("div",{className:"lk-button-group"},e.createElement(dh,{source:vr.Source.Microphone,showIcon:f,onChange:E},m&&"Microphone"),e.createElement("div",{className:"lk-button-group-menu"},e.createElement(Ah,{kind:"audioinput",onActiveDeviceChange:(e,t)=>C(null!=t?t:"")}))),h.camera&&e.createElement("div",{className:"lk-button-group"},e.createElement(dh,{source:vr.Source.Camera,showIcon:f,onChange:P},m&&"Camera"),e.createElement("div",{className:"lk-button-group-menu"},e.createElement(Ah,{kind:"videoinput",onActiveDeviceChange:(e,t)=>T(null!=t?t:"")}))),h.screenShare&&g&&e.createElement(dh,{source:vr.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:f,onChange:b},m&&(v?"Stop screen share":"Share screen")),h.chat&&e.createElement(zd,null,f&&e.createElement(Kd,null),m&&"Chat"),h.leave&&e.createElement(Jd,null,f&&e.createElement($d,null),m&&"Leave"),e.createElement(Fh,null))}function Bh(t){var n,i,r=t,{chatMessageFormatter:o,chatMessageDecoder:a,chatMessageEncoder:s}=r,c=Xu(r,["chatMessageFormatter","chatMessageDecoder","chatMessageEncoder"]);const[l,u]=e.useState({showChat:!1,unreadMessages:0}),d=e.useRef(null),h=jd([{source:vr.Source.Camera,withPlaceholder:!0},{source:vr.Source.ScreenShare,withPlaceholder:!1}],{updateOnlyOn:[ui.ActiveSpeakersChanged],onlySubscribed:!1}),p=function(){const[t,n]=e.useReducer(rd,Bl),[i,r]=e.useReducer(id,Vl);return{pin:{dispatch:n,state:t},widget:{dispatch:r,state:i}}}(),f=h.filter(Nl).filter((e=>e.publication.source===vr.Source.ScreenShare)),m=null==(n=Md(p))?void 0:n[0],g=h.filter((e=>!Il(e,m)));return e.useEffect((()=>{var e,t,n,i;f.some((e=>e.publication.isSubscribed))&&null===d.current?(Ul.debug("Auto set screen share focus:",{newScreenShareTrack:f[0]}),null==(t=(e=p.pin).dispatch)||t.call(e,{msg:"set_pin",trackReference:f[0]}),d.current=f[0]):d.current&&!f.some((e=>{var t,n;return e.publication.trackSid===(null==(n=null==(t=d.current)?void 0:t.publication)?void 0:n.trackSid)}))&&(Ul.debug("Auto clearing screen share focus."),null==(i=(n=p.pin).dispatch)||i.call(n,{msg:"clear_pin"}),d.current=null)}),[f.map((e=>`${e.publication.trackSid}_${e.publication.isSubscribed}`)).join(),null==(i=null==m?void 0:m.publication)?void 0:i.trackSid]),Uh(),e.createElement("div",$u({className:"lk-video-conference"},c),Ll()&&e.createElement(Nh,{value:p,onWidgetChange:e=>{Ul.debug("updating widget state",e),u(e)}},e.createElement("div",{className:"lk-video-conference-inner"},m?e.createElement("div",{className:"lk-focus-layout-wrapper"},e.createElement(Sh,null,e.createElement(Rh,{tracks:g},e.createElement(kh,null)),m&&e.createElement(wh,{trackRef:m}))):e.createElement("div",{className:"lk-grid-layout-wrapper"},e.createElement(Ph,{tracks:h},e.createElement(kh,null))),e.createElement(jh,{controls:{chat:!0}})),e.createElement(Lh,{style:{display:l.showChat?"grid":"none"},messageFormatter:o,messageEncoder:s,messageDecoder:a})),e.createElement(_h,null),e.createElement(Dh,null))}const Vh=t=>{let{token:n,url:r,roomName:o,participantName:a,onLeaveRoom:s}=t;const[c,l]=(0,e.useState)("");return(0,i.jsxs)("div",{className:"video-room",children:[(0,i.jsx)("div",{className:"room-header",children:(0,i.jsx)("h2",{children:o})}),c&&(0,i.jsx)("div",{className:"error",children:c}),(0,i.jsxs)(Oh,{token:n,serverUrl:r,options:{adaptiveStream:!0,dynacast:!0},video:!0,audio:!0,onDisconnected:()=>{console.log("Disconnected from room"),s()},onError:e=>{console.error("Error connecting to LiveKit:",e),l(e.message||"Failed to connect to room")},className:"livekit-container",children:[(0,i.jsx)(Bh,{}),(0,i.jsx)(_h,{})]})]})};const zh=function(){const[t,n]=(0,e.useState)(null);return(0,i.jsx)("div",{className:"app",children:(0,i.jsxs)("div",{className:"container",children:[(0,i.jsx)("h1",{children:"LiveKit Video Chat"}),t?(0,i.jsx)(Vh,{token:t.token,url:t.url,roomName:t.roomName,participantName:t.participantName,onLeaveRoom:()=>{n(null)}}):(0,i.jsx)(r,{onJoinRoom:e=>{n(e)}})]})})},Jh=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:o,getTTFB:a}=t;n(e),i(e),r(e),o(e),a(e)}))};t.createRoot(document.getElementById("root")).render((0,i.jsx)(e.StrictMode,{children:(0,i.jsx)(zh,{})})),Jh()})()})();
//# sourceMappingURL=main.c467c69a.js.map